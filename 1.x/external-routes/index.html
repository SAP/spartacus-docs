<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>External Routes (DRAFT) - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="External Routes (DRAFT)">
<meta property="og:url" content="/spartacus-docs/1.x/external-routes/">












  

  


<link rel="canonical" href="/spartacus-docs/1.x/external-routes/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/1.x/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/1.x/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/1.x/"><img src="/spartacus-docs/1.x/assets/images/logo-blue_64x64.png" alt=""></a>
        
        <a class="site-title" href="/spartacus-docs/1.x/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/1.x/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/enQtNDM1OTI3OTMwNjU5LTg1NGVjZmFkZjQzODc1MzFhMjc3OTZmMzIzYzg0YjMwODJiY2YxYjA5MTE5NjVmN2E5NjMxNjEzMGNlMDRjMjU" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="https://stackoverflow.com/questions/tagged/spartacus-storefront" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/1.x/release-information/" >Version 1.5</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Home</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/spartacus-docs/1.x/" class="">About Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/release-information/" class="">Release Information ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-videos/" class="">Spartacus Videos</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-roadmap/" class="">Spartacus Roadmap</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-faq/" class="">Spartacus FAQ</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/docs-archive/" class="">Documentation Archive</a>
 
              

                
             </li>
           
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Getting Started with Spartacus Libraries</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/spartacus-docs/1.x/installing-sap-commerce-cloud/" class="">Installing SAP Commerce Cloud for use with Spartacus ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/cors/" class="">Cross-Origin Resource Sharing (CORS)</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/building-the-spartacus-storefront-from-libraries/" class="">Building the Spartacus Storefront from Libraries</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/recommended-development-environment/" class="">Recommended Development Environment</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/snapshot-builds/" class="">Snapshot Builds</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/configuring-feature-flags/" class="">Configuring Feature Flags</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/smartEdit-setup-instructions-for-spartacus/" class="">SmartEdit Setup Instructions for Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/personalization-setup-instructions-for-spartacus/" class="">Personalization Setup Instructions for Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacussampledataaddon/" class="">Spartacussampledataaddon AddOn</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/integrations/" class="">Integrations ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Storefront Development Guide</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/spartacus-docs/1.x/storefront-development-faq/" class="">Storefront Development FAQ</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-api/" class="">Spartacus API</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/global-configuration-in-spartacus/" class="">Global Configuration in Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-features/" class="">Spartacus Features ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/security-best-practices/" class="">Security Best Practices</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/performance/" class="">Performance Optimizations ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/outlets/" class="">Outlets</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/styling-and-page-layout/" class="">Styling and Page Layout ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/customizing-and-extending/" class="">Customizing and Extending Spartacus Features ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/extending-checkout/" class="">Extending Checkout</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/express-checkout/" class="">Express Checkout</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/guest-checkout/" class="">Guest Checkout</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/configurable-routing/" class="">Configurable Routing ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    
                      
                        

                          
                          

                          
                          
      
                          <li><a href="/spartacus-docs/1.x/adding-and-customizing-routes/" class="">Adding and Customizing Routes</a></li>
                    
                         

                          
                          

                          
                          
      
                          <li><a href="/spartacus-docs/1.x/route-configuration/" class="">Route Configuration</a></li>
                    
                         

                          
                          

                          
                          
      
                          <li><a href="/spartacus-docs/1.x/configurable-router-links/" class="">Configurable Router Links</a></li>
                    
                         

                          
                          

                          
                          
      
                          <li><a href="/spartacus-docs/1.x/disabling-standard-routes/" class="">Disabling Standard Routes</a></li>
                    
                         

                          
                          

                          
                          
      
                          <li><a href="/spartacus-docs/1.x/additional-route-parameters/" class="">Additional Route Parameters</a></li>
                    
                         

                          
                          

                          
                          
      
                          <li><a href="/spartacus-docs/1.x/route-aliases/" class="">Route Aliases</a></li>
                    
                         

                          
                          

                          
                          
      
                          <li><a href="/spartacus-docs/1.x/external-routes/" class="active">External Routes</a></li>
                    
                         

                          
                          

                          
                          
      
                          <li><a href="/spartacus-docs/1.x/early-login/" class="">Early Login</a></li>
                    
                         
                       
                     

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/configuring-base-url/" class="">Configuring the Base URL</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/context-configuration/" class="">Multi-Site Configuration ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/pwa-home/" class="">PWA ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/seo/" class="">SEO ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/i18n/" class="">Internationalization (i18n)</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/state-management/" class="">State Management ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/smartedit-contract/" class="">SmartEdit Contract in Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/customizing-backend-communication/" class="">Customizing Back End Communication ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/global-messages/" class="">Global Messages</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/http-error-handling/" class="">HTTP Error Handling</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/configurable-state-persistence-and-rehydration/" class="">Configurable State Persistence and Rehydration</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/server-side-rendering-in-spartacus/" class="">Server-Side Rendering ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/view-configuration/" class="">View Configuration ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/user-experience-guidelines/" class="">User Experience Guidelines ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Contributing to Spartacus</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/spartacus-docs/1.x/contributors-guide/" class="">Contributor's Guide ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">External Routes (DRAFT)</h1>
    
    
<p><b>Note: </b> 
This feature is introduced with version 1.2 of the Spartacus libraries.
 </p>

<p>As long as we are in the scope of SPA, Spartacus performs only ‘inside’ navigations due to usage of Angular’s <code class="language-plaintext highlighter-rouge">routerLink</code> directive, which  by design doesn’t load pages from backend.</p>

<p>However many Customers may want to migrate step-by-step (route-by-route) from the old storefront system (i.e. Hybris accelerator) to the modern Spartacus SPA (Single Page Application), which means temporarily using different systems to drive parts of the storefronts at the same time.</p>

<p>Thanks to <em>external routes</em> feature of Spartacus, some routes can be loaded from backend or even redirected to a different domain.</p>

<h2 id="how-to-use-spartacus-and-other-storefront-systems-at-the-same-domain">How to use Spartacus and other storefront systems at the same domain</h2>

<p>The URL patterns need to be defined to distinguish the storefront systems. Those patterns should be applied in 3 places: <em>backend server</em>, <em>Spartacus</em> configuration and <em>Angular service worker</em> (when PWA is enabled), because of the following reasons:</p>

<ol>
  <li>When accessing a deep link, the <em>backend server</em> should:
    <ul>
      <li>serve Spartacus; <strong>or</strong></li>
      <li>serve other storefront’s page</li>
    </ul>
  </li>
  <li>When navigating by the Angular’s <code class="language-plaintext highlighter-rouge">routerLink</code>, <em>Spartacus</em> should:
    <ul>
      <li>activate a SPA route; <strong>or</strong></li>
      <li>full (re)load a page</li>
    </ul>
  </li>
  <li>When full (re)loading page, <em>Angular service worker</em> should:
    <ul>
      <li>intercept navigation request and return cached <code class="language-plaintext highlighter-rouge">index.html</code> of SPA; <strong>or</strong></li>
      <li>bypass the cache - to let the backend serve the response</li>
    </ul>
  </li>
</ol>

<h3 id="configuration-of-backend-server">Configuration of backend server</h3>

<p>The configuration of URL patterns for backend server depends on the used backend technology. Please refer to its documentation.</p>

<h3 id="configuration-of-spartacus">Configuration of Spartacus</h3>

<p>Provide the configuration with URL patterns for internal routes, i.e. by importing <code class="language-plaintext highlighter-rouge">ConfigModule.withConfig()</code>.</p>

<blockquote>
  <p>The URL patterns use a limited glob format:</p>
  <ul>
    <li><code class="language-plaintext highlighter-rouge">**</code> matches 0 or more path segments</li>
    <li><code class="language-plaintext highlighter-rouge">*</code> matches 0 or more characters excluding <code class="language-plaintext highlighter-rouge">/</code></li>
    <li><code class="language-plaintext highlighter-rouge">?</code> matches exactly one character excluding <code class="language-plaintext highlighter-rouge">/</code></li>
    <li>The <code class="language-plaintext highlighter-rouge">!</code> prefix marks the pattern as being negative, meaning that only URLs that don’t match the pattern will be included</li>
  </ul>
</blockquote>

<p>Here are two examples:</p>

<ol>
  <li>
    <p>Let only the <em>homepage</em>, <em>cart</em> and <em>product details pages</em> be rendered in SPA, but all other URLs should be loaded from the backend:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nx">ConfigModule</span><span class="p">.</span><span class="nx">withConfig</span><span class="p">({</span>
   <span class="na">routing</span><span class="p">:</span> <span class="p">{</span>
     <span class="na">internal</span><span class="p">:</span> <span class="p">[</span>
       <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span>
       <span class="dl">'</span><span class="s1">/cart</span><span class="dl">'</span><span class="p">,</span>
       <span class="dl">'</span><span class="s1">/product/*/*</span><span class="dl">'</span><span class="p">,</span>
       <span class="dl">'</span><span class="s1">/**/p/**</span><span class="dl">'</span><span class="p">,</span>
     <span class="p">]</span>
   <span class="p">}</span>
 <span class="p">})</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Let any route render in SPA, but not the exceptions: <em>homepage</em>, <em>cart</em> and <em>product details pages</em>:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nx">ConfigModule</span><span class="p">.</span><span class="nx">withConfig</span><span class="p">({</span>
   <span class="na">routing</span><span class="p">:</span> <span class="p">{</span>
     <span class="na">internal</span><span class="p">:</span> <span class="p">[</span>
       <span class="dl">'</span><span class="s1">/**</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// wildcard</span>

       <span class="c1">// exceptions:</span>
       <span class="dl">'</span><span class="s1">!/</span><span class="dl">'</span>
       <span class="dl">'</span><span class="s1">!/cart</span><span class="dl">'</span><span class="p">,</span>
       <span class="dl">'</span><span class="s1">!/product/*/*</span><span class="dl">'</span><span class="p">,</span>
       <span class="dl">'</span><span class="s1">!/**/p/**</span><span class="dl">'</span><span class="p">,</span>
     <span class="p">]</span>
   <span class="p">}</span>
 <span class="p">})</span>
</code></pre></div>    </div>
  </li>
</ol>

<p><em>Note: The pattern must start with <code class="language-plaintext highlighter-rouge">/</code> or <code class="language-plaintext highlighter-rouge">!/</code></em>.</p>

<h2 id="configuration-of-angular-service-worker-when-pwa-is-enabled">Configuration of Angular service worker (when PWA is enabled)</h2>

<p>To bypass the cache of the service worker and let the backend serve the response after full page (re)load, you need to define property <code class="language-plaintext highlighter-rouge">navigationUrls</code> of your service worker’s config <code class="language-plaintext highlighter-rouge">ngsw-config.json</code> and specify the URL patterns for internal routes (similar to config of Spartacus). It uses the same glob-like syntax as Spartacus, so you can <strong>almost</strong> copy-paste it.</p>

<p><strong>Almost</strong>, because those patterns take into account also the URL part with the site context, like. <code class="language-plaintext highlighter-rouge">/electronics/en/USD/...</code> (see docs of the <a href="/spartacus-docs/1.x/context-configuration/">Context Configuration</a>.</p>

<p>Here are two examples (assuming that URL starts with configured three segments of the site context):</p>

<ol>
  <li>
    <p>Let only the <em>homepage</em>, <em>cart</em> and <em>product details pages</em> be rendered in SPA, but all other URLs should be loaded from the backend:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">// ngsw-config.json</span>

 <span class="dl">"</span><span class="s2">navigationUrls</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
   <span class="c1">// prefix `/*/*/*/` handles 3 URL segments of site-context</span>
   <span class="dl">'</span><span class="s1">/*/*/*/</span><span class="dl">'</span><span class="p">,</span>
   <span class="dl">'</span><span class="s1">/*/*/*/cart</span><span class="dl">'</span><span class="p">,</span>
   <span class="dl">'</span><span class="s1">/*/*/*/product/*/*</span><span class="dl">'</span><span class="p">,</span>
   <span class="dl">'</span><span class="s1">/*/*/*/**/p/**</span><span class="dl">'</span><span class="p">,</span>
 <span class="p">]</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Let any route render in SPA, but not the exceptions: <em>homepage</em>, <em>cart</em> and <em>product details pages</em>:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">// ngsw-config.json</span>

 <span class="dl">"</span><span class="s2">navigationUrls</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
   <span class="c1">// wildcard:</span>
   <span class="dl">"</span><span class="s2">/**</span><span class="dl">"</span><span class="p">,</span>

   <span class="c1">// your custom exceptions with the prefix `/*/*/*/`:</span>
   <span class="dl">'</span><span class="s1">!/*/*/*/</span><span class="dl">'</span><span class="p">,</span>
   <span class="dl">'</span><span class="s1">!/*/*/*/cart</span><span class="dl">'</span><span class="p">,</span>
   <span class="dl">'</span><span class="s1">!/*/*/*/product/*/*</span><span class="dl">'</span><span class="p">,</span>
   <span class="dl">'</span><span class="s1">!/*/*/*/**/p/**</span><span class="dl">'</span><span class="p">,</span>

   <span class="c1">// re-define the default Angular's exceptions: </span>
   <span class="dl">"</span><span class="s2">!/**/*.*</span><span class="dl">"</span><span class="p">,</span>       <span class="c1">// files with extensions</span>
   <span class="dl">"</span><span class="s2">!/**/*__*</span><span class="dl">"</span><span class="p">,</span>      <span class="c1">// paths containing `__`</span>
   <span class="dl">"</span><span class="s2">!/**/*__*/**</span><span class="dl">"</span><span class="p">,</span>
 <span class="p">]</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>For more, see the official documentation of the Angular <a href="https://angular.io/guide/service-worker-config#navigationurls">service worker configuration</a>.</p>

<h2 id="how-to-redirect-to-a-different-domain">How to redirect to a different domain</h2>

<p>It may happen that a part of the storefront is hosted on a different domain. Then we would like to redirect to a different domain instead of (re)loading the page, by extending the logic of <code class="language-plaintext highlighter-rouge">ExternalRoutesGuard</code>. Here is how to:</p>

<p>Please provide in your app.module the internal routes config and the custom guard implementation:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">imports</span><span class="p">:</span> <span class="p">[</span>
  <span class="nx">ConfigModule</span><span class="p">.</span><span class="nx">withConfig</span><span class="p">({</span>
    <span class="na">routing</span><span class="p">:</span> <span class="p">{</span> <span class="na">internal</span><span class="p">:</span> <span class="p">[</span> <span class="cm">/*...*/</span> <span class="p">]</span> <span class="p">}</span>
  <span class="p">})</span>
<span class="p">],</span>
<span class="na">providers</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span> <span class="na">provide</span><span class="p">:</span> <span class="nx">ExternalRoutesGuard</span><span class="p">,</span> <span class="na">useClass</span><span class="p">:</span> <span class="nx">CustomExternalRoutesGuard</span> <span class="p">}</span>
<span class="p">],</span>
</code></pre></div></div>

<p>… where the implementation is …</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomExternalRoutesGuard</span> <span class="kd">extends</span> <span class="nx">ExternalRoutesGuard</span> <span class="p">{</span>
  <span class="kr">protected</span> <span class="nx">redirect</span><span class="p">(</span><span class="nx">_</span><span class="p">:</span> <span class="nx">ActivatedRouteSnapshot</span><span class="p">,</span> <span class="nx">state</span><span class="p">:</span> <span class="nx">RouterStateSnapshot</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nb">window</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">winRef</span><span class="p">.</span><span class="nx">nativeWindow</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">window</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://external-domain.com/</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">state</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><em>Note: Similarly, for SEO, the backend server should perform http <strong>30x redirects</strong> to a different domain for specified URL patterns.</em></p>

<h2 id="advanced-cases">Advanced cases</h2>

<p>For advanced custom cases, like multiple external routes hosted on multiple domains, you can extend the logic of the method <code class="language-plaintext highlighter-rouge">ExternalRoutesService.getRoutes()</code> to prepend custom Angular <code class="language-plaintext highlighter-rouge">Routes</code> with custom <code class="language-plaintext highlighter-rouge">UrlMatcher</code>s and guards (i.e. each <code class="language-plaintext highlighter-rouge">Route</code> can redirect to a different domain).</p>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/1.x/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/1.x/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    apiKey: 'a80d5313e9ea5b00e5004f69b9c090e9', 
    indexName: 'sap-spartacus', 
    inputSelector: '#docsearch', 
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 

    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
