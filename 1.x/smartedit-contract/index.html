<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>SmartEdit Contract in Spartacus (DRAFT) - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="SmartEdit Contract in Spartacus (DRAFT)">
<meta property="og:url" content="/spartacus-docs/1.x/smartedit-contract/">












  

  


<link rel="canonical" href="/spartacus-docs/1.x/smartedit-contract/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/1.x/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/1.x/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/1.x/"><img src="/spartacus-docs/1.x/assets/images/logo-blue_64x64.png" alt=""></a>
        
        <a class="site-title" href="/spartacus-docs/1.x/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/1.x/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/enQtNDM1OTI3OTMwNjU5LTg1NGVjZmFkZjQzODc1MzFhMjc3OTZmMzIzYzg0YjMwODJiY2YxYjA5MTE5NjVmN2E5NjMxNjEzMGNlMDRjMjU" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="https://stackoverflow.com/questions/tagged/spartacus-storefront" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/1.x/release-information/" >Version 1.5</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Home</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/spartacus-docs/1.x/" class="">About Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/release-information/" class="">Release Information ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-videos/" class="">Spartacus Videos</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-roadmap/" class="">Spartacus Roadmap</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-faq/" class="">Spartacus FAQ</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/docs-archive/" class="">Documentation Archive</a>
 
              

                
             </li>
           
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Getting Started with Spartacus Libraries</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/spartacus-docs/1.x/installing-sap-commerce-cloud/" class="">Installing SAP Commerce Cloud for use with Spartacus ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/cors/" class="">Cross-Origin Resource Sharing (CORS)</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/building-the-spartacus-storefront-from-libraries/" class="">Building the Spartacus Storefront from Libraries</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/recommended-development-environment/" class="">Recommended Development Environment</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/snapshot-builds/" class="">Snapshot Builds</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/configuring-feature-flags/" class="">Configuring Feature Flags</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/smartEdit-setup-instructions-for-spartacus/" class="">SmartEdit Setup Instructions for Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/personalization-setup-instructions-for-spartacus/" class="">Personalization Setup Instructions for Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacussampledataaddon/" class="">Spartacussampledataaddon AddOn</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/integrations/" class="">Integrations ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Storefront Development Guide</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/spartacus-docs/1.x/storefront-development-faq/" class="">Storefront Development FAQ</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-api/" class="">Spartacus API</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/global-configuration-in-spartacus/" class="">Global Configuration in Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/spartacus-features/" class="">Spartacus Features ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/security-best-practices/" class="">Security Best Practices</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/performance/" class="">Performance Optimizations ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/outlets/" class="">Outlets</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/styling-and-page-layout/" class="">Styling and Page Layout ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/customizing-and-extending/" class="">Customizing and Extending Spartacus Features ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/extending-checkout/" class="">Extending Checkout</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/express-checkout/" class="">Express Checkout</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/guest-checkout/" class="">Guest Checkout</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/configurable-routing/" class="">Configurable Routing ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/configuring-base-url/" class="">Configuring the Base URL</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/context-configuration/" class="">Multi-Site Configuration ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/pwa-home/" class="">PWA ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/seo/" class="">SEO ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/i18n/" class="">Internationalization (i18n)</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/state-management/" class="">State Management ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/smartedit-contract/" class="active">SmartEdit Contract in Spartacus</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/customizing-backend-communication/" class="">Customizing Back End Communication ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/global-messages/" class="">Global Messages</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/http-error-handling/" class="">HTTP Error Handling</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/configurable-state-persistence-and-rehydration/" class="">Configurable State Persistence and Rehydration</a>
 
              

                
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/server-side-rendering-in-spartacus/" class="">Server-Side Rendering ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/view-configuration/" class="">View Configuration ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                 </ul>
                 
             </li>
           
            
            

            
            

            <li><a href="/spartacus-docs/1.x/user-experience-guidelines/" class="">User Experience Guidelines ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Contributing to Spartacus</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/spartacus-docs/1.x/contributors-guide/" class="">Contributor's Guide ➢</a>
 
              

              
                <ul>
                  
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                    

                     
                   
                 </ul>
                 
             </li>
           
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">SmartEdit Contract in Spartacus (DRAFT)</h1>
    
    <p>The following sections describe how the SmartEdit Contract is implemented in Spartacus.</p>

<p>For information on setting up SmartEdit in Spartacus, see <a href="/spartacus-docs/1.x/smartEdit-setup-instructions-for-spartacus/">SmartEdit Setup Instructions for Spartacus</a>.</p>

<p>For general information on SmartEdit Contracts, see <a href="https://help.sap.com/viewer/86dd1373053a4c2da8f9885cc9fbe55d/1808/en-US/622cebcb444b42e18de2147775430b9d.html#loio622cebcb444b42e18de2147775430b9d">SmartEdit Contract for Storefronts</a>.</p>

<h2 id="smartedit-contract-implementation">SmartEdit contract implementation</h2>

<p>To make Spartacus work with SmartEdit, we need implement the SmartEdit contract in Spartacus.</p>

<h3 id="the-smartedit-contract-consists-of-the-following">The SmartEdit Contract consists of the following</h3>

<h4 id="1-the-webapplicationinjectorjs-file-that-must-be-included-in-each-page">1. The webApplicationInjector.js file that must be included in each page</h4>

<p><a href="https://sap.github.io/cloud-commerce-spartacus-storefront-docs/smartEdit-setup-instructions-for-spartacus/">SmartEdit Setup Instructions for Spartacus</a> has the details of how to include this js file into your app.</p>

<h4 id="2-a-preview-ticket-api-mechanism">2. A preview ticket API mechanism</h4>

<h5 id="21-get-cmsticketid-also-called-previewtoken">2.1. Get <code class="language-plaintext highlighter-rouge">cmsTicketId</code> (also called <code class="language-plaintext highlighter-rouge">previewToken</code>)</h5>

<p>When Spartacus is launched in SmartEdit, SmartEdit sends a request to Spartacus with <code class="language-plaintext highlighter-rouge">cmsTicketId</code> as the parameter.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">e</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//localhost:4200/cx-preview?cmsTicketId=6477500489900224fda62f41-167a-40fe-9ecc-39019a64ebb9</span>
</code></pre></div></div>

<p>By default, SmartEdit appends <code class="language-plaintext highlighter-rouge">/cx-preview</code> to the storefront URI so that it can preview your storefront. But you can configure SmartEdit to route the request to the another endpoint in your app. Use the storefrontPreviewRoute property in an impex to specify your custom storefront route as shown in the following example:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">INSERT_UPDATE</span> <span class="nx">SmartEditConfiguration</span><span class="p">;</span><span class="nx">key</span><span class="p">[</span><span class="nx">unique</span><span class="o">=</span><span class="kc">true</span><span class="p">];</span><span class="nx">value</span>
<span class="p">;</span><span class="nx">storefrontPreviewRoute</span><span class="p">;</span><span class="dl">"""</span><span class="s2">my-custom-preview</span><span class="dl">"""</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">cmsTicketId</code> is generated in backend. It contains many information required by SmartEdit, such as <code class="language-plaintext highlighter-rouge">site-id</code> or <code class="language-plaintext highlighter-rouge">catalogVersion</code>. For the details, pleae read “Preview API” section in <a href="https://help.sap.com/viewer/86dd1373053a4c2da8f9885cc9fbe55d/1808/en-US/622cebcb444b42e18de2147775430b9d.html#loio622cebcb444b42e18de2147775430b9d">SmartEdit Contract for Storefronts</a>.</p>

<p>Spartacus gets <code class="language-plaintext highlighter-rouge">cmsTicketId</code> from the request sent from SmartEdit.</p>

<h5 id="22-smartedit-interceptor">2.2. Smartedit Interceptor</h5>

<p>To make SmartEdit be able to load pages in Spartacus, it needs to get all the required context data, which includes site, content catalog, and content catalog version, and can also be for a specified language, or date and time. Therefore, <code class="language-plaintext highlighter-rouge">cmsTicketId</code> needs to be appended to any CMS requests sent from Spartacus to backend.</p>

<p>In Spartacus, we have <code class="language-plaintext highlighter-rouge">CmsTicketInterceptor</code>. If <code class="language-plaintext highlighter-rouge">cmsTicketId</code> exists and requests are <code class="language-plaintext highlighter-rouge">cms</code> specified, it adds <code class="language-plaintext highlighter-rouge">cmsTicketId</code> as one of the request parameters.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">e</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//localhost:9002/rest/v2/electronics-spa/cms/pages?fields=DEFAULT&amp;lang=en&amp;curr=USD&amp;cmsTicketId=6477500489900224fda62f41-167a-40fe-9ecc-39019a64ebb9</span>
</code></pre></div></div>

<h4 id="3-html-markup-contract">3. HTML Markup Contract</h4>

<p>The HTML markup contract stipulates that every CMS component and every content slot must be wrapped in an HTML tag and include specific elements.</p>

<h5 id="31-properties-in-cms-items-received-from-backend">3.1 <code class="language-plaintext highlighter-rouge">properties</code> in CMS items received from backend</h5>

<p>Sending CMS requests with <code class="language-plaintext highlighter-rouge">cmsTicketId</code>, there will be <code class="language-plaintext highlighter-rouge">properties</code> field in the response JSON data. <code class="language-plaintext highlighter-rouge">properties</code> contains groups of dynamic attribute required for the containing CMS items. For example, <code class="language-plaintext highlighter-rouge">properties</code> in CMS page may have these data:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="dl">"</span><span class="s2">label</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">homepage</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">properties</span><span class="dl">"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">smartedit</span><span class="dl">"</span> <span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">classes</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">smartedit-page-uid-homepage smartedit-page-uuid-eyJpdGVtSWQiOiJob21lcGFnZSIsImNhdGFsb2dJZCI6ImVsZWN0cm9uaWNzLXNwYUNvbnRlbnRDYXRhbG9nIiwiY2F0YWxvZ1ZlcnNpb24iOiJTdGFnZWQifQ== smartedit-catalog-version-uuid-electronics-spaContentCatalog/Staged</span><span class="dl">"</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the group <code class="language-plaintext highlighter-rouge">smartedit</code>, there is <code class="language-plaintext highlighter-rouge">classes</code>. It is the required SmartEdit contract for this CMS page. So, we need add these “classes” into the class list of the html body tag. If you check the html page source, you will see the body tag has the “classes”.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">body</span> <span class="kd">class</span><span class="o">=</span><span class="dl">"</span><span class="s2">smartedit-page-uid-homepage smartedit-page-uuid-eyJpdGVtSWQiOiJob21lcGFnZSIsImNhdGFsb2dJZCI6ImVsZWN0cm9uaWNzLXNwYUNvbnRlbnRDYXRhbG9nIiwiY2F0YWxvZ1ZlcnNpb24iOiJTdGFnZWQifQ== smartedit-catalog-version-uuid-electronics-spaContentCatalog/Staged</span><span class="dl">"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">cx</span><span class="o">-</span><span class="nx">storefront</span> <span class="nx">ng</span><span class="o">-</span><span class="nx">version</span><span class="o">=</span><span class="dl">"</span><span class="s2">8.0.0</span><span class="dl">"</span> <span class="kd">class</span><span class="o">=</span><span class="dl">"</span><span class="s2">stop-navigating</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="nx">header</span><span class="o">&gt;&lt;</span><span class="nx">cx</span><span class="o">-</span><span class="nx">page</span><span class="o">-</span><span class="nx">layout</span> <span class="nx">section</span><span class="o">=</span><span class="dl">"</span><span class="s2">header</span><span class="dl">"</span> <span class="nx">ng</span><span class="o">-</span><span class="nx">reflect</span><span class="o">-</span><span class="nx">section</span><span class="o">=</span><span class="dl">"</span><span class="s2">header</span><span class="dl">"</span> <span class="kd">class</span><span class="o">=</span><span class="dl">"</span><span class="s2">header</span><span class="dl">"</span><span class="o">&gt;</span><span class="c">&lt;!--</span><span class="nx">bindings</span><span class="o">=</span><span class="p">{</span>
<span class="p">...</span>
</code></pre></div></div>

<p>CMS slots and components also contain the <code class="language-plaintext highlighter-rouge">properties</code>. We need add these attributes to component/slot tags. The following is an exmpple of “HelpLink” component.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="dl">"</span><span class="s2">uid</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">HelpLink</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">uuid</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">eyJpdGVtSWQiOiJIZWxwTGluayIsImNhdGFsb2dJZCI6ImVsZWN0cm9uaWNzLXNwYUNvbnRlbnRDYXRhbG9nIiwiY2F0YWxvZ1ZlcnNpb24iOiJTdGFnZWQifQ==</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">typeCode</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">CMSLinkComponent</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">modifiedTime</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">2019-07-02T13:44:27.77-04:00</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">Help Link</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">container</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">false</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">external</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">false</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">/faq</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">linkName</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">Help</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">properties</span><span class="dl">"</span> <span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">smartedit</span><span class="dl">"</span> <span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">catalogVersionUuid</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">electronics-spaContentCatalog/Staged</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">componentType</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">CMSLinkComponent</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">componentId</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">HelpLink</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">classes</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">smartEditComponent</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">componentUuid</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">eyJpdGVtSWQiOiJIZWxwTGluayIsImNhdGFsb2dJZCI6ImVsZWN0cm9uaWNzLXNwYUNvbnRlbnRDYXRhbG9nIiwiY2F0YWxvZ1ZlcnNpb24iOiJTdGFnZWQifQ==</span><span class="dl">"</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">target</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">false</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the page source, you will see this:</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">cx</span><span class="o">-</span><span class="nx">link</span> <span class="nx">data</span><span class="o">-</span><span class="nx">smartedit</span><span class="o">-</span><span class="nx">catalog</span><span class="o">-</span><span class="nx">version</span><span class="o">-</span><span class="nx">uuid</span><span class="o">=</span><span class="dl">"</span><span class="s2">electronics-spaContentCatalog/Staged</span><span class="dl">"</span> <span class="nx">data</span><span class="o">-</span><span class="nx">smartedit</span><span class="o">-</span><span class="nx">component</span><span class="o">-</span><span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">CMSLinkComponent</span><span class="dl">"</span> <span class="nx">data</span><span class="o">-</span><span class="nx">smartedit</span><span class="o">-</span><span class="nx">component</span><span class="o">-</span><span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">HelpLink</span><span class="dl">"</span> <span class="kd">class</span><span class="o">=</span><span class="dl">"</span><span class="s2">smartEditComponent</span><span class="dl">"</span> <span class="nx">data</span><span class="o">-</span><span class="nx">smartedit</span><span class="o">-</span><span class="nx">component</span><span class="o">-</span><span class="nx">uuid</span><span class="o">=</span><span class="dl">"</span><span class="s2">eyJpdGVtSWQiOiJIZWxwTGluayIsImNhdGFsb2dJZCI6ImVsZWN0cm9uaWNzLXNwYUNvbnRlbnRDYXRhbG9nIiwiY2F0YWxvZ1ZlcnNpb24iOiJTdGFnZWQifQ==</span><span class="dl">"</span> <span class="nx">data</span><span class="o">-</span><span class="nx">smart</span><span class="o">-</span><span class="nx">edit</span><span class="o">-</span><span class="nx">component</span><span class="o">-</span><span class="nx">process</span><span class="o">-</span><span class="nx">status</span><span class="o">=</span><span class="dl">"</span><span class="s2">removeComponent</span><span class="dl">"</span> <span class="nx">data</span><span class="o">-</span><span class="nx">smartedit</span><span class="o">-</span><span class="nx">element</span><span class="o">-</span><span class="nx">uuid</span><span class="o">=</span><span class="dl">"</span><span class="s2">8505cd4a-11b3-4fc8-b278-6f8ff74e50b3</span><span class="dl">"</span> <span class="nx">style</span><span class="o">=</span><span class="dl">"</span><span class="s2">position: relative;</span><span class="dl">"</span><span class="o">&gt;</span>
</code></pre></div></div>

<h5 id="32-dynamicattributeservice">3.2 <code class="language-plaintext highlighter-rouge">DynamicAttributeService</code></h5>

<p>In Spartacus, we have <code class="language-plaintext highlighter-rouge">DynamicAttributeService</code>. It can add dynamic attributes to DOM. These attributes are extracted from the <code class="language-plaintext highlighter-rouge">properties</code> of CMS items received from backend.</p>

<p><strong>Note:</strong> There can by many different groups of properties, one of them is <code class="language-plaintext highlighter-rouge">smaredit</code>. But EC allows addons to create different groups. For example, personalization may add <code class="language-plaintext highlighter-rouge">script</code> group etc.</p>

<p>To add SmartEdit HTML Markup contract to Slot, we have this function:</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">private</span> <span class="nx">addSmartEditContract</span><span class="p">(</span><span class="nx">slot</span><span class="p">:</span> <span class="nx">ContentSlotData</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dynamicAttributeService</span><span class="p">.</span><span class="nx">addDynamicAttributes</span><span class="p">(</span>
      <span class="nx">slot</span><span class="p">.</span><span class="nx">properties</span><span class="p">,</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">hostElement</span><span class="p">.</span><span class="nx">nativeElement</span><span class="p">,</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">renderer</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="4-rerendering-components-and-content-slots-after-editing">4. Rerendering Components and Content Slots After Editing</h4>

<p>After the user makes changes to components or content slots, the user will want to see the changes reflected on the page. SmartEdit optimizes this by rerendering only the changed content.</p>

<p>For frontend-rendered pages, the storefront rerenders the pages and not SmartEdit. In this case, Spartacus implements the renderComponent function in the <code class="language-plaintext highlighter-rouge">window.smartedit namespace</code> as shown in the following code excerpt:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">.</span><span class="nx">smartedit</span><span class="p">.</span><span class="nx">renderComponent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">componentId</span><span class="p">,</span> <span class="nx">componentType</span><span class="p">,</span> <span class="nx">parentId</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span>
</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">parentId</code> does not exist, the CMS item is a slot, then <code class="language-plaintext highlighter-rouge">renderComponent</code> actually refresh the whole CMS page. If <code class="language-plaintext highlighter-rouge">parentId</code> exists, the CMS item is component. Only this CMS component is refreshed.</p>

<h3 id="default-preview-categoryproduct">Default Preview Category/Product</h3>

<p>Each site has <code class="language-plaintext highlighter-rouge">defaultPreviewCategory</code>, <code class="language-plaintext highlighter-rouge">defaultPreviewProduct</code> and <code class="language-plaintext highlighter-rouge">defaultPreviewCatalog</code>. For example:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">UPDATE</span> <span class="nx">CMSSite</span><span class="p">;</span><span class="nx">uid</span><span class="p">[</span><span class="nx">unique</span><span class="o">=</span><span class="kc">true</span><span class="p">];</span><span class="nx">defaultPreviewCategory</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="nx">$productCV</span><span class="p">);</span><span class="nx">defaultPreviewProduct</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="nx">$productCV</span><span class="p">);</span><span class="nx">defaultPreviewCatalog</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
<span class="p">;</span><span class="nx">$spaSiteUid</span><span class="p">;</span><span class="mi">575</span><span class="p">;</span><span class="mi">2053367</span><span class="p">;</span><span class="nx">$productCatalog</span>
</code></pre></div></div>

<p>When open category or product pages in SmartEdit, you will find that not only the CMS pages are loaded, the default preview product/category is also loaded.</p>

<p>In SmartEdit, product with code 2053367 is opened in the product details page:
<img src="https://user-images.githubusercontent.com/44440575/60668058-0d998480-9e39-11e9-98a7-b75422a44c77.png" alt="Screen Shot 2019-07-04 at 8 51 30 AM" /></p>

<p>Same for the category page, category 575 is opened in the product list page:
<img src="https://user-images.githubusercontent.com/44440575/60668153-46d1f480-9e39-11e9-885c-d12cc6a62020.png" alt="Screen Shot 2019-07-04 at 8 52 02 AM" /></p>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/1.x/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/1.x/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    apiKey: 'a80d5313e9ea5b00e5004f69b9c090e9', 
    indexName: 'sap-spartacus', 
    inputSelector: '#docsearch', 
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 

    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
