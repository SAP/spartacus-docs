<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Server-Side Rendering - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="Server-Side Rendering">
<meta property="og:url" content="/spartacus-docs/3.x/server-side-rendering-in-spartacus/">












  

  


<link rel="canonical" href="/spartacus-docs/3.x/server-side-rendering-in-spartacus/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/3.x/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/3.x/assets/css/main.css">
<link rel="stylesheet" href="/spartacus-docs/3.x/assets/css/keys.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/3.x/"><img src="/spartacus-docs/3.x/assets/images/logo-blue_64x64.png" alt="Spartacus logo"></a>
        
        <a class="site-title" href="/spartacus-docs/3.x/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/zt-jekftqo0-HP6xt6IF~ffVB2cGG66fcQ" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/#how-to-obtain-support" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/release-information/" >Version 3.4</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/"><span class="nav__sub-title">Home</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/getting-started/"><span class="nav__sub-title">Getting Started with Spartacus Libraries</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/dev-guide/"><span class="nav__sub-title">Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/a11y/" class="">Accessibility ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/spartacus-api/" class="">API</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/architecture/" class="">Architecture ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/customizing-and-extending/" class="">Customizing and Extending Spartacus ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/customizing-backend-communication/" class="">Customizing Back End Communication ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/performance/" class="">Performance Optimizations ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/security-best-practices/" class="">Security Best Practices ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/server-side-rendering-in-spartacus/" class="active">Server-Side Rendering ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                            
                                                <li><a href="/spartacus-docs/3.x/server-side-rendering-coding-guidelines/">Server–Side Rendering Coding Guidelines</a></li>
                                              
                                        

                                          
                                          

                                            
                                                <li><a href="/spartacus-docs/3.x/server-side-rendering-optimization/">Server-Side Rendering Optimization</a></li>
                                              
                                        

                                          
                                          

                                            
                                                <li><a href="/spartacus-docs/3.x/how-to-debug-server-side-rendered-storefront/">How to Debug a Server–Side Rendered Storefront</a></li>
                                              
                                        

                                          
                                          

                                            
                                                <li><a href="/spartacus-docs/3.x/ssr-ccv2-issue-spartacus-version-2/">Solution for Issue with SSR in Spartacus 2.0 or later and SAP Commerce Cloud for Public Cloud</a></li>
                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/spartacus-features/" class="">Storefront Features ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/3.x/styling-and-page-layout/" class="">Styling and Page Layout ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/using-spartacus/"><span class="nav__sub-title">Using the Spartacus Storefront</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/about-tua-spartacus/"><span class="nav__sub-title">Telco & Utilities Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/about-fsa-spartacus/"><span class="nav__sub-title">Financial Services Accelerator Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/contributors-guide/"><span class="nav__sub-title">Contributing to Spartacus</span></a>
         
        
            <ul>
                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
  </ul>
</nav>      

    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">Server-Side Rendering</h1>
    
    <p><strong>Note: Spartacus 3.x is no longer maintained. Please upgrade to the latest version.</strong></p>

<p>In Spartacus, server-side rendering allows you to render static versions of pages on the server side. This speeds up response times, assists with SEO, and allows the application to render more quickly. After Angular has bootstrapped, users of your site will have the full experience.</p>

<hr />

<p><strong>Table of Contents</strong></p>

<ul id="markdown-toc">
  <li><a href="#adding-ssr-support-using-schematics-recommended" id="markdown-toc-adding-ssr-support-using-schematics-recommended">Adding SSR Support Using Schematics (Recommended)</a></li>
  <li><a href="#adding-ssr-support-manually" id="markdown-toc-adding-ssr-support-manually">Adding SSR Support Manually</a></li>
  <li><a href="#installation-steps-for-internal-spartacus-development" id="markdown-toc-installation-steps-for-internal-spartacus-development">Installation Steps for Internal Spartacus Development</a></li>
</ul>

<hr />

<h2 id="adding-ssr-support-using-schematics-recommended">Adding SSR Support Using Schematics (Recommended)</h2>

<p>The recommended way to add SSR support to your Spartacus application is to use schematics. With a single command, all required files are added automatically, and all modifications for SSR support are done automatically as well. To add SSR support to your Spartacus application, run the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ng add @spartacus/schematics <span class="nt">--ssr</span>
</code></pre></div></div>

<p>You have now added SSR support to your Spartacus application. No further steps are required.</p>

<h2 id="adding-ssr-support-manually">Adding SSR Support Manually</h2>

<p>For most situations and setups, is is best to add SSR support to your Spartacus application using schematics, as described in the previous section. However, if you are unable to add SSR support using schematics, the following steps describe how to manually add SSR support so that your Spartacus shell app includes the Spartacus libraries running in SSR mode.</p>

<ol>
  <li>
    <p>Add the following dependencies to <code class="language-plaintext highlighter-rouge">package.json</code>:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="nl">"@angular/platform-server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~10.1.0"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"@nguniversal/express-engine"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^10.1.0"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"@spartacus/setup"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.0.0-rc.2"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"express"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.15.2"</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Add the following developer dependencies to <code class="language-plaintext highlighter-rouge">package.json</code>:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="nl">"ts-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^6.0.4"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"@nguniversal/builders"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^10.1.0"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"@types/express"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.17.0"</span><span class="err">,</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>For convenience, add the following scripts to <code class="language-plaintext highlighter-rouge">package.json</code>:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="nl">"e2e"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ng e2e"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"dev:ssr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ng run &lt;your-project-name&gt;:serve-ssr"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"serve:ssr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node dist/&lt;your-project-name&gt;/server/main.js"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"build:ssr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ng build --prod &amp;&amp; ng run &lt;your-project-name&gt;:server:production"</span><span class="err">,</span><span class="w">
 </span><span class="nl">"prerender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ng run &lt;your-project-name&gt;:prerender"</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Update the <code class="language-plaintext highlighter-rouge">src/main.ts</code> file, as follows:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">//from</span>
 <span class="nx">platformBrowserDynamic</span><span class="p">().</span><span class="nx">bootstrapModule</span><span class="p">(</span><span class="nx">AppModule</span><span class="p">);</span>
 <span class="c1">//to</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">DOMContentLoaded</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
   <span class="nx">platformBrowserDynamic</span><span class="p">().</span><span class="nx">bootstrapModule</span><span class="p">(</span><span class="nx">AppModule</span><span class="p">);</span>
 <span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Replace the following lines in <code class="language-plaintext highlighter-rouge">app.module.ts</code>:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">//from:</span>
 <span class="nx">BrowserModule</span><span class="p">,</span>
 <span class="c1">//to</span>
 <span class="nx">BrowserModule</span><span class="p">.</span><span class="nx">withServerTransition</span><span class="p">({</span> <span class="na">appId</span><span class="p">:</span> <span class="dl">'</span><span class="s1">spartacus-app</span><span class="dl">'</span> <span class="p">}),</span>
</code></pre></div>    </div>
    <p>and</p>
    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">//from</span>
 <span class="k">import</span> <span class="p">{</span> <span class="nx">BrowserModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/platform-browser</span><span class="dl">'</span><span class="p">;</span>
 <span class="c1">//to</span>
 <span class="k">import</span> <span class="p">{</span> <span class="nx">BrowserModule</span><span class="p">,</span> <span class="nx">BrowserTransferStateModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/platform-browser</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div>    </div>
    <p>and add <code class="language-plaintext highlighter-rouge">BrowserTransferStateModule</code> to <code class="language-plaintext highlighter-rouge">imports</code>.</p>
  </li>
  <li>
    <p>In the <code class="language-plaintext highlighter-rouge">src/index.html</code> file, add the following meta attribute, and replace <code class="language-plaintext highlighter-rouge">OCC_BACKEND_BASE_URL_VALUE</code> with the URL of your back end instance, as follows:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"occ-backend-base-url"</span> <span class="na">content=</span><span class="s">"OCC_BACKEND_BASE_URL_VALUE"</span> <span class="nt">/&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>In <code class="language-plaintext highlighter-rouge">projects.&lt;your-project-name&gt;.architect.build.options</code> change following line:
    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="err">//from</span><span class="w">
 </span><span class="nl">"outputPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dist/&lt;your-project-name&gt;"</span><span class="err">,</span><span class="w">
 </span><span class="err">//to</span><span class="w">
 </span><span class="nl">"outputPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dist/&lt;your-project-name&gt;/browser"</span><span class="err">,</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>In <code class="language-plaintext highlighter-rouge">projects.&lt;your-project-name&gt;.architect.lint.options.tsConfig</code> add:
    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="s2">"tsconfig.server.json"</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>In <code class="language-plaintext highlighter-rouge">projects.&lt;your-project-name&gt;.architect</code>, add the following configuration to your existing <code class="language-plaintext highlighter-rouge">angular.json</code> file:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="nl">"server"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"builder"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@angular-devkit/build-angular:server"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nl">"outputPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dist/&lt;your-project-name&gt;/server"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"server.ts"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"tsConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tsconfig.server.json"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="nl">"configurations"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nl">"production"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"outputHashing"</span><span class="p">:</span><span class="w"> </span><span class="s2">"media"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"fileReplacements"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
           </span><span class="p">{</span><span class="w">
             </span><span class="nl">"replace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/environments/environment.ts"</span><span class="p">,</span><span class="w">
             </span><span class="nl">"with"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/environments/environment.prod.ts"</span><span class="w">
           </span><span class="p">}</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="nl">"sourceMap"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
         </span><span class="nl">"optimization"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
       </span><span class="p">}</span><span class="w">
     </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="err">,</span><span class="w">
 </span><span class="nl">"serve-ssr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="nl">"builder"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@nguniversal/builders:ssr-dev-server"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"browserTarget"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;your-project-name&gt;:build"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"serverTarget"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;your-project-name&gt;:server"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"configurations"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"production"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nl">"browserTarget"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;your-project-name&gt;:build:production"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"serverTarget"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;your-project-name&gt;:server:production"</span><span class="w">
     </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="err">,</span><span class="w">
 </span><span class="nl">"prerender"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="nl">"builder"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@nguniversal/builders:prerender"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"browserTarget"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;your-project-name&gt;:build:production"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"serverTarget"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;your-project-name&gt;:server:production"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"routes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
       </span><span class="s2">"/"</span><span class="w">
     </span><span class="p">]</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"configurations"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"production"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
   </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

    <p><strong>Note:</strong> In the above example, remember to replace the string <code class="language-plaintext highlighter-rouge">"&lt;your-project-name&gt;"</code> with your project name (such as <code class="language-plaintext highlighter-rouge">mystore</code>, for example).</p>
  </li>
  <li>
    <p>Add the <code class="language-plaintext highlighter-rouge">tsconfig.server.json</code> file to your existing shell app. The following is an example:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./tsconfig.app.json"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"compilerOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"outDir"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./out-tsc/server"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"es2016"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"types"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
       </span><span class="s2">"node"</span><span class="w">
     </span><span class="p">]</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
     </span><span class="s2">"src/main.server.ts"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"server.ts"</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nl">"angularCompilerOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"entryModule"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./src/app/app.server.module#AppServerModule"</span><span class="w">
   </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Add the <code class="language-plaintext highlighter-rouge">src/main.server.ts</code> file to your existing shell app. The following is an example:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="cm">/***************************************************************************************************
 * Load `$localize` onto the global scope - used if i18n tags appear in Angular templates.
 */</span>
 <span class="k">import</span> <span class="dl">'</span><span class="s1">@angular/localize/init</span><span class="dl">'</span><span class="p">;</span>

 <span class="k">import</span> <span class="p">{</span> <span class="nx">enableProdMode</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@angular/core</span><span class="dl">"</span><span class="p">;</span>

 <span class="k">import</span> <span class="p">{</span> <span class="nx">environment</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./environments/environment</span><span class="dl">"</span><span class="p">;</span>

 <span class="k">if</span> <span class="p">(</span><span class="nx">environment</span><span class="p">.</span><span class="nx">production</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">enableProdMode</span><span class="p">();</span>
 <span class="p">}</span>

 <span class="k">export</span> <span class="p">{</span> <span class="nx">AppServerModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./app/app.server.module</span><span class="dl">'</span><span class="p">;</span>
 <span class="k">export</span> <span class="p">{</span> <span class="nx">renderModule</span><span class="p">,</span> <span class="nx">renderModuleFactory</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/platform-server</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add the <code class="language-plaintext highlighter-rouge">src/app/app.server.module</code> file to your existing shell app. The following is an example:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">import</span> <span class="p">{</span> <span class="nx">NgModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@angular/core</span><span class="dl">"</span><span class="p">;</span>
 <span class="k">import</span> <span class="p">{</span>
   <span class="nx">ServerModule</span><span class="p">,</span>
   <span class="nx">ServerTransferStateModule</span><span class="p">,</span>
 <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@angular/platform-server</span><span class="dl">"</span><span class="p">;</span>

 <span class="k">import</span> <span class="p">{</span> <span class="nx">AppModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./app.module</span><span class="dl">"</span><span class="p">;</span>
 <span class="k">import</span> <span class="p">{</span> <span class="nx">AppComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./app.component</span><span class="dl">"</span><span class="p">;</span>

 <span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
   <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
     <span class="c1">// The AppServerModule should import your AppModule followed</span>
     <span class="c1">// by the ServerModule from @angular/platform-server.</span>
     <span class="nx">AppModule</span><span class="p">,</span>
     <span class="nx">ServerModule</span><span class="p">,</span>
     <span class="nx">ServerTransferStateModule</span><span class="p">,</span>
   <span class="p">],</span>
   <span class="na">bootstrap</span><span class="p">:</span> <span class="p">[</span><span class="nx">AppComponent</span><span class="p">],</span>
 <span class="p">})</span>
 <span class="k">export</span> <span class="kd">class</span> <span class="nx">AppServerModule</span> <span class="p">{}</span>
</code></pre></div>    </div>

    <p>For more information about caching and transfer state, see <a href="/spartacus-docs/3.x/automatic-context-configuration/#caching-the-site-context-with-server-side-rendering">Caching the Site Context with Server-Side Rendering</a></p>
  </li>
  <li>
    <p>Add the <code class="language-plaintext highlighter-rouge">server.ts</code> file to your existing shell app. The following is an example:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="cm">/***************************************************************************************************
  * Load `$localize` onto the global scope - used if i18n tags appear in Angular templates.
 */</span>
 <span class="k">import</span> <span class="dl">'</span><span class="s1">@angular/localize/init</span><span class="dl">'</span><span class="p">;</span>
 <span class="k">import</span> <span class="dl">'</span><span class="s1">zone.js/dist/zone-node</span><span class="dl">'</span><span class="p">;</span>

 <span class="k">import</span> <span class="p">{</span> <span class="nx">ngExpressEngine</span> <span class="k">as</span> <span class="nx">engine</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nguniversal/express-engine</span><span class="dl">'</span><span class="p">;</span>
 <span class="k">import</span> <span class="p">{</span> <span class="nx">NgExpressEngineDecorator</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@spartacus/setup/ssr</span><span class="dl">'</span><span class="p">;</span>
 <span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">express</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">;</span>
 <span class="k">import</span> <span class="p">{</span> <span class="nx">join</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">;</span>

 <span class="k">import</span> <span class="p">{</span> <span class="nx">AppServerModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./src/main.server</span><span class="dl">'</span><span class="p">;</span>
 <span class="k">import</span> <span class="p">{</span> <span class="nx">APP_BASE_HREF</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/common</span><span class="dl">'</span><span class="p">;</span>
 <span class="k">import</span> <span class="p">{</span> <span class="nx">existsSync</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">;</span>

 <span class="kd">const</span> <span class="nx">ngExpressEngine</span> <span class="o">=</span> <span class="nx">NgExpressEngineDecorator</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">engine</span><span class="p">);</span>

 <span class="c1">// The Express app is exported so that it can be used by serverless Functions.</span>
 <span class="k">export</span> <span class="kd">function</span> <span class="nx">app</span><span class="p">()</span> <span class="p">{</span>
   <span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
   <span class="kd">const</span> <span class="nx">distFolder</span> <span class="o">=</span> <span class="nx">join</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">dist/&lt;your-project-name&gt;/browser</span><span class="dl">'</span><span class="p">);</span>
   <span class="kd">const</span> <span class="nx">indexHtml</span> <span class="o">=</span> <span class="nx">existsSync</span><span class="p">(</span><span class="nx">join</span><span class="p">(</span><span class="nx">distFolder</span><span class="p">,</span> <span class="dl">'</span><span class="s1">index.original.html</span><span class="dl">'</span><span class="p">))</span>
     <span class="p">?</span> <span class="dl">'</span><span class="s1">index.original.html</span><span class="dl">'</span>
     <span class="p">:</span> <span class="dl">'</span><span class="s1">index</span><span class="dl">'</span><span class="p">;</span>

   <span class="nx">server</span><span class="p">.</span><span class="nx">engine</span><span class="p">(</span>
     <span class="dl">'</span><span class="s1">html</span><span class="dl">'</span><span class="p">,</span>
     <span class="nx">ngExpressEngine</span><span class="p">({</span>
       <span class="na">bootstrap</span><span class="p">:</span> <span class="nx">AppServerModule</span><span class="p">,</span>
     <span class="p">})</span>
   <span class="p">);</span>

   <span class="nx">server</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">view engine</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">html</span><span class="dl">'</span><span class="p">);</span>
   <span class="nx">server</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">views</span><span class="dl">'</span><span class="p">,</span> <span class="nx">distFolder</span><span class="p">);</span>

   <span class="c1">// Serve static files from /browser</span>
   <span class="nx">server</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
     <span class="dl">'</span><span class="s1">*.*</span><span class="dl">'</span><span class="p">,</span>
     <span class="nx">express</span><span class="p">.</span><span class="k">static</span><span class="p">(</span><span class="nx">distFolder</span><span class="p">,</span> <span class="p">{</span>
       <span class="na">maxAge</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1y</span><span class="dl">'</span><span class="p">,</span>
     <span class="p">})</span>
   <span class="p">);</span>

   <span class="c1">// All regular routes use the Universal engine</span>
   <span class="nx">server</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
     <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">indexHtml</span><span class="p">,</span> <span class="p">{</span>
       <span class="nx">req</span><span class="p">,</span>
       <span class="na">providers</span><span class="p">:</span> <span class="p">[{</span> <span class="na">provide</span><span class="p">:</span> <span class="nx">APP_BASE_HREF</span><span class="p">,</span> <span class="na">useValue</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">baseUrl</span> <span class="p">}],</span>
     <span class="p">});</span>
   <span class="p">});</span>

   <span class="k">return</span> <span class="nx">server</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
   <span class="kd">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">4000</span><span class="p">;</span>

   <span class="c1">// Start up the Node server</span>
   <span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">app</span><span class="p">();</span>
   <span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Node Express server listening on http://localhost:</span><span class="p">${</span><span class="nx">port</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
   <span class="p">});</span>
 <span class="p">}</span>

 <span class="c1">// Webpack will replace 'require' with '__webpack_require__'</span>
 <span class="c1">// '__non_webpack_require__' is a proxy to Node 'require'</span>
 <span class="c1">// The below code is to ensure that the server is run only when not requiring the bundle.</span>
 <span class="kr">declare</span> <span class="kd">const</span> <span class="nx">__non_webpack_require__</span><span class="p">:</span> <span class="nx">NodeRequire</span><span class="p">;</span>
 <span class="kd">const</span> <span class="nx">mainModule</span> <span class="o">=</span> <span class="nx">__non_webpack_require__</span><span class="p">.</span><span class="nx">main</span><span class="p">;</span>
 <span class="kd">const</span> <span class="nx">moduleFilename</span> <span class="o">=</span> <span class="p">(</span><span class="nx">mainModule</span> <span class="o">&amp;&amp;</span> <span class="nx">mainModule</span><span class="p">.</span><span class="nx">filename</span><span class="p">)</span> <span class="o">||</span> <span class="dl">''</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">moduleFilename</span> <span class="o">===</span> <span class="nx">__filename</span> <span class="o">||</span> <span class="nx">moduleFilename</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">iisnode</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
   <span class="nx">run</span><span class="p">();</span>
 <span class="p">}</span>

 <span class="k">export</span> <span class="o">*</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./src/main.server</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div>    </div>

    <p><strong>Note:</strong> In the above example, remember to replace the string <code class="language-plaintext highlighter-rouge">"&lt;your-project-name&gt;"</code> with your project name (such as <code class="language-plaintext highlighter-rouge">mystore</code>, for example).</p>
  </li>
  <li>
    <p>Build the SSR version of your Spartacus shell app by running the following command:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> yarn run build:ssr <span class="o">&amp;&amp;</span> yarn run serve:ssr
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="installation-steps-for-internal-spartacus-development">Installation Steps for Internal Spartacus Development</h2>

<p>If you are involved in Spartacus internal development (for example, if you are contributing to the Spartacus core libraries), or if you wish to submit a pull request, you can perform the following steps, which describe how to run Spartacus in SSR mode using the Spartacus storefront app.</p>

<p><strong>Note:</strong> You do not need to follow the steps in this section if your intention is to add SSR support to your Spartacus application. You can do that simply by running the schematics command, as described in <a href="#adding-ssr-support-using-schematics-recommended">Adding SSR Support Using Schematics (Recommended)</a>.</p>

<ol>
  <li>
    <p>Set the production server endpoint in your <code class="language-plaintext highlighter-rouge">environment.prod.ts</code> (dev mode) or <code class="language-plaintext highlighter-rouge">app.module.ts</code> (shell app mode), as follows:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="err">environment</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="err">occBaseUrl:</span><span class="w"> </span><span class="err">'https://</span><span class="p">[</span><span class="err">your_occ_endpoint</span><span class="p">]</span><span class="err">'</span><span class="p">,</span><span class="w">
 </span><span class="p">}</span><span class="err">;</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Turn PWA off.</p>

    <p>As soon as Spartacus is installed in PWA mode, a service worker is installed, and it serves a cached version of <code class="language-plaintext highlighter-rouge">index.html</code>, along with the <code class="language-plaintext highlighter-rouge">js</code> files. This results in SSR being completely skipped. The following steps describe how to turn off PWA:</p>

    <ol>
      <li>
        <p>Check that there are no service workers registered in your app. If you do find any service workers, remove them.</p>
      </li>
      <li>
        <p>Turn PWA off in your app module configuration, as follows:</p>

        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="err">StorefrontModule.withConfig(</span><span class="p">{</span><span class="w">
       </span><span class="err">backend:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="err">occ:</span><span class="w"> </span><span class="p">{</span><span class="w">
           </span><span class="err">baseUrl:</span><span class="w"> </span><span class="err">'https://</span><span class="p">[</span><span class="err">your_enpdoint</span><span class="p">],</span><span class="w">
         </span><span class="p">},</span><span class="w">
       </span><span class="p">},</span><span class="w">
       </span><span class="err">pwa:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="err">enabled:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
       </span><span class="p">},</span><span class="w">
 </span><span class="p">}</span><span class="err">;</span><span class="w">
</span></code></pre></div>        </div>
      </li>
    </ol>
  </li>
  <li>
    <p>Rebuild your local Spartacus libraries by running the following command:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> yarn build:core:lib
</code></pre></div>    </div>
  </li>
  <li>
    <p>Build your local Spartacus shell app by running the following command:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> yarn build <span class="nt">--prod</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Build the SSR version of your shell app by running the following command:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> yarn build:ssr
</code></pre></div>    </div>
  </li>
  <li>
    <p>Start Spartacus with the SSR server by running the following command:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> yarn serve:ssr
</code></pre></div>    </div>
  </li>
</ol>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/3.x/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/3.x/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    appId: 'BNZEXRISC6',
    apiKey: '54a795a072ff713045038ee4ad33c990', 
    indexName: 'sap_spartacus', 
    inputSelector: '#docsearch', 
    algoliaOptions: {
      'facetFilters': ["tags:3.x"]
      },
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 


    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
