<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Assisted Service Module - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="Assisted Service Module">
<meta property="og:url" content="/spartacus-docs/3.x/asm/">












  

  


<link rel="canonical" href="/spartacus-docs/3.x/asm/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/3.x/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/3.x/assets/css/main.css">
<link rel="stylesheet" href="/spartacus-docs/3.x/assets/css/keys.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/3.x/"><img src="/spartacus-docs/3.x/assets/images/logo-blue_64x64.png" alt="Spartacus logo"></a>
        
        <a class="site-title" href="/spartacus-docs/3.x/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/zt-jekftqo0-HP6xt6IF~ffVB2cGG66fcQ" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/#how-to-obtain-support" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/release-information/" >Version 3.4</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/"><span class="nav__sub-title">Home</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/getting-started/"><span class="nav__sub-title">Getting Started with Spartacus Libraries</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/dev-guide/"><span class="nav__sub-title">Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/a11y/">Accessibility ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/spartacus-api/">API</a>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/architecture/">Architecture ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/customizing-and-extending/">Customizing and Extending Spartacus ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/customizing-backend-communication/">Customizing Back End Communication ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/performance/">Performance Optimizations ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/security-best-practices/">Security Best Practices ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/server-side-rendering-in-spartacus/">Server-Side Rendering ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/spartacus-features/">Storefront Features ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                        
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/anonymous-consent/" class="">Anonymous Consent</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/applied-promotions/" class="">Applied Promotions</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/asm/" class="active">Assisted Service Module</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/b2b-commerce-organization/" class="">B2B Commerce Organization</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/bulk-pricing/" class="">Bulk Pricing</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/cancellations-and-returns/" class="">Cancellations and Returns</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/consignment-tracking/" class="">Consignment Tracking</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/coupons/" class="">Coupons</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/customer-coupons/" class="">Customer Coupons</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/customer-interests/" class="">Customer Interests</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/event-service/" class="">Event Service</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/express-checkout/" class="">Express Checkout</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/guest-checkout/" class="">Guest Checkout</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/infinite-scroll/" class="">Infinite Scroll</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/notification-preferences/" class="">Notification Preferences</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/saved-cart/" class="">Saved Cart</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/scheduled-replenishment/" class="">Scheduled Replenishment</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/selective-cart/" class="">Selective Cart</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/skip-links/" class="">Skip Links</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/stock-notification/" class="">Stock Notification</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/store-locator/" class="">Store Locator</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/tag-management-system/" class="">Tag Management System ➢</a>


                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/text-field-configurator-template/" class="">Text Field Configurator Template</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/variants/" class="">Variants</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/wish-list/" class="">Wish List</a>


                                                                        
                                                                </li>
                                                            
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/styling-and-page-layout/">Styling and Page Layout ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                      
                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/using-spartacus/"><span class="nav__sub-title">Using the Spartacus Storefront</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/about-tua-spartacus/"><span class="nav__sub-title">Telco & Utilities Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/about-fsa-spartacus/"><span class="nav__sub-title">Financial Services Accelerator Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/contributors-guide/"><span class="nav__sub-title">Contributing to Spartacus</span></a>
         
        
            <ul>
                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
  </ul>
</nav>      

    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">Assisted Service Module</h1>
    
    
<p><b>Note: </b> 
This feature is introduced with version 1.3 of the Spartacus libraries.
 </p>

<p>Assisted Service Module (ASM) enables customer service personnel to provide real-time customer sales and service support using the storefront. For more information, refer to the <a href="https://help.sap.com/viewer/9d346683b0084da2938be8a285c0c27a/latest/en-US/8b571515866910148fc18b9e59d3e084.html">ASM section on SAP Help Portal</a></p>

<p>Spartacus now supports the ASM functionality that allows customer emulation by sales support agents through the Spartacus storefront.</p>

<hr />

<p><strong>Table of Contents</strong></p>

<ul id="markdown-toc">
  <li><a href="#requirements" id="markdown-toc-requirements">Requirements</a>    <ul>
      <li><a href="#asm-back-end-requirements" id="markdown-toc-asm-back-end-requirements">ASM Back End Requirements</a></li>
      <li><a href="#granting-asagentgroup-cms-permissions" id="markdown-toc-granting-asagentgroup-cms-permissions">Granting asagentgroup CMS Permissions</a>        <ul>
          <li><a href="#option-1-initialize-from-scratch-with-19055" id="markdown-toc-option-1-initialize-from-scratch-with-19055">Option 1: Initialize from scratch with 1905.5</a></li>
          <li><a href="#option-2-manual-import-in-impex-console" id="markdown-toc-option-2-manual-import-in-impex-console">Option 2: Manual import in impex console</a></li>
        </ul>
      </li>
      <li><a href="#cors-configuration" id="markdown-toc-cors-configuration">CORS Configuration</a>        <ul>
          <li><a href="#customizing-cors-configuration" id="markdown-toc-customizing-cors-configuration">Customizing CORS Configuration</a></li>
          <li><a href="#allowedorigins" id="markdown-toc-allowedorigins">allowedOrigins</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#invoke-the-asm-ui-in-the-storefront" id="markdown-toc-invoke-the-asm-ui-in-the-storefront">Invoke the ASM UI in the storefront</a></li>
  <li><a href="#update-custom-services-to-support-asm" id="markdown-toc-update-custom-services-to-support-asm">Update custom services to support ASM.</a>    <ul>
      <li><a href="#update-userservice-subclasses" id="markdown-toc-update-userservice-subclasses">Update UserService Subclasses</a>        <ul>
          <li><a href="#custom-service" id="markdown-toc-custom-service">Custom service</a></li>
          <li><a href="#custom-service-updated-to-support-asm" id="markdown-toc-custom-service-updated-to-support-asm">Custom service updated to support ASM.</a></li>
        </ul>
      </li>
      <li><a href="#update-useraddressservice-subclasses" id="markdown-toc-update-useraddressservice-subclasses">Update UserAddressService Subclasses</a>        <ul>
          <li><a href="#custom-service-1" id="markdown-toc-custom-service-1">Custom service</a></li>
          <li><a href="#custom-service-updated-to-support-asm-1" id="markdown-toc-custom-service-updated-to-support-asm-1">Custom service updated to support ASM.</a></li>
        </ul>
      </li>
      <li><a href="#update-userconsentservice-subclasses" id="markdown-toc-update-userconsentservice-subclasses">Update UserConsentService Subclasses</a>        <ul>
          <li><a href="#custom-service-2" id="markdown-toc-custom-service-2">Custom service</a></li>
          <li><a href="#custom-service-updated-to-support-asm-2" id="markdown-toc-custom-service-updated-to-support-asm-2">Custom service updated to support ASM.</a></li>
        </ul>
      </li>
      <li><a href="#update-userorderservice-subclasses" id="markdown-toc-update-userorderservice-subclasses">Update UserOrderService Subclasses</a>        <ul>
          <li><a href="#custom-service-3" id="markdown-toc-custom-service-3">Custom service</a></li>
          <li><a href="#custom-service-updated-to-support-asm-3" id="markdown-toc-custom-service-updated-to-support-asm-3">Custom service updated to support ASM.</a></li>
        </ul>
      </li>
      <li><a href="#update-userpaymentservice-subclasses" id="markdown-toc-update-userpaymentservice-subclasses">Update UserPaymentService Subclasses</a>        <ul>
          <li><a href="#custom-service-4" id="markdown-toc-custom-service-4">Custom service</a></li>
          <li><a href="#custom-service-updated-to-support-asm-4" id="markdown-toc-custom-service-updated-to-support-asm-4">Custom service updated to support ASM.</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#how-to-write-asm-compatible-code" id="markdown-toc-how-to-write-asm-compatible-code">How to write ASM compatible code.</a></li>
  <li><a href="#configuring" id="markdown-toc-configuring">Configuring</a>    <ul>
      <li><a href="#asmagentsessiontimerstartingdelayinseconds" id="markdown-toc-asmagentsessiontimerstartingdelayinseconds">asm.agentSessionTimer.startingDelayInSeconds</a></li>
      <li><a href="#asmcustomesearchmaxresults" id="markdown-toc-asmcustomesearchmaxresults">asm.customeSearch.maxResults</a></li>
    </ul>
  </li>
  <li><a href="#extending" id="markdown-toc-extending">Extending</a></li>
  <li><a href="#limitations" id="markdown-toc-limitations">Limitations</a>    <ul>
      <li><a href="#cms" id="markdown-toc-cms">CMS</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="requirements">Requirements</h2>

<p>For more information on to setup and configure ASM on your SAP Commerce Cloud, refer to the <a href="https://help.sap.com/viewer/9d346683b0084da2938be8a285c0c27a/latest/en-US/8b571515866910148fc18b9e59d3e084.html">ASM section on SAP Help Portal</a>.</p>

<p>Here are a few setup steps that are important and/or specific to get ASM working with Spartacus:</p>

<h3 id="asm-back-end-requirements">ASM Back End Requirements</h3>

<p>ASM in Spartacus requires SAP Commerce Cloud version 1905.5 or newer. The minimum version of 1905.5 is required to enable CORS in the <code class="language-plaintext highlighter-rouge">assistedservicewebservices</code> endpoints.</p>

<p>The ASM feature in Spartacus requires the following extensions:</p>

<ul>
  <li>assistedservicewebservices Extension</li>
  <li>assistedservicestorefront AddOn</li>
</ul>

<h3 id="granting-asagentgroup-cms-permissions">Granting asagentgroup CMS Permissions</h3>

<p>The user group <code class="language-plaintext highlighter-rouge">asagentgroup</code> needs specific rights to read CMS data from OCC.</p>

<h4 id="option-1-initialize-from-scratch-with-19055">Option 1: Initialize from scratch with 1905.5</h4>

<p>If you start from scratch and initialize your SAP Commerce Cloud system with version 1905.5 or newer, <code class="language-plaintext highlighter-rouge">asagentgroup</code> will get the required permissions to use cms data via Spartacus and OCC. There is no additional step to do.</p>

<h4 id="option-2-manual-import-in-impex-console">Option 2: Manual import in impex console</h4>

<p>If you upgrade from an earlier version than 1905.5, you need to grant the <code class="language-plaintext highlighter-rouge">asagentgroup</code> permissions by importing this impex data via the impex console:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Access rights for asagentgroup
# - These are needed for rendering (cmsoccaddon).

$START_USERRIGHTS;;;;;;;;;
Type;UID;MemberOfGroups;Password;Target;read;change;create;remove;change_perm
UserGroup;asagentgroup;;;;;;;;

# general
;;;;Item;+;;;;;
;;;;Type;+;;;;;

# access rights for Products, Store, Site and Catalogs
;;;;Product;+;;;;;
;;;;Category;+;;;;;
;;;;VariantType;+;;;;;
;;;;BaseSite;+;;;;;
;;;;BaseStore;+;;;;;
;;;;Catalog;+;;;;;
;;;;CatalogVersion;+;;;;;
;;;;ContentCatalog;+;;;;;
;;;;MediaContainer;+;-;-;-;-;
;;;;MediaContext;+;-;-;-;-;
;;;;MediaFormat;+;-;-;-;-;
;;;;MediaFormatMapping;+;-;-;-;-;

# cms2 items
;;;;CMSItem;+;-;-;-;-;

$END_USERRIGHTS;;;;;
</code></pre></div></div>

<h3 id="cors-configuration">CORS Configuration</h3>

<p>The <code class="language-plaintext highlighter-rouge">assistedservicewebservices</code> extension requires CORS configuration, which is possible since SAP Commerce Cloud version 1905.5.<br />
The cors configurations for <code class="language-plaintext highlighter-rouge">assistedservicewebservices</code> have default values specified in the <code class="language-plaintext highlighter-rouge">project.properties</code> file of the <code class="language-plaintext highlighter-rouge">assistedservicewebservices</code>. At the time of writing these lines, the default values are:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>corsfilter.assistedservicewebservices.allowedOrigins=http://localhost:4200 https://localhost:4200
corsfilter.assistedservicewebservices.allowedMethods=GET HEAD OPTIONS PATCH PUT POST DELETE
corsfilter.assistedservicewebservices.allowedHeaders=origin content-type accept authorization
</code></pre></div></div>

<h4 id="customizing-cors-configuration">Customizing CORS Configuration</h4>

<p>CORS configurations are customized by overriding the default configuration via your <code class="language-plaintext highlighter-rouge">local.properties</code> file.</p>

<p>Since configurations are <em>overridden</em> in local.properties, if you want to add a configuration element without losing the default value, you need to add all the defaults in addition to the new element. For example, to add ‘my-new-header’ in the allowed header list in addition to the default ones, you need to add this in local.properties:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>corsfilter.assistedservicewebservices.allowedHeaders=origin content-type accept authorization my-new-header.
</code></pre></div></div>

<p>To customize <code class="language-plaintext highlighter-rouge">allowedMethods</code> and <code class="language-plaintext highlighter-rouge">allowedHeaders</code> you should add to the default values.
To customize <code class="language-plaintext highlighter-rouge">allowedOrigins</code>, you will need to override the value with one that is relevant for your environment.</p>

<h4 id="allowedorigins">allowedOrigins</h4>

<p>You need to customize the <code class="language-plaintext highlighter-rouge">allowedOrigins</code> property for <code class="language-plaintext highlighter-rouge">assistedservicewebservices</code> with host names that are relevant to your environment. As mentioned above, this is done by adding the propery yout <code class="language-plaintext highlighter-rouge">local.properties</code> with a new value:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>corsfilter.assistedservicewebservices.allowedOrigins=https://my-new-host:4200
</code></pre></div></div>

<p>For development purposes only, the value can be a wildcard:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>corsfilter.assistedservicewebservices.allowedOrigins=*
</code></pre></div></div>

<p>Bear in mind this wildcard configuration is flexible for development environments but it is unsecured. A more restrictive configuration is required for production use.</p>

<h2 id="invoke-the-asm-ui-in-the-storefront">Invoke the ASM UI in the storefront</h2>

<p>To invoke the ASM UI in the storefront, add the <code class="language-plaintext highlighter-rouge">?asm=true</code> suffix to the url.
For example, with the sample store, you can invoke the ASM UI on the home page with this url.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://{hostname}/electronics-spa/en/USD/?asm=true
</code></pre></div></div>

<h2 id="update-custom-services-to-support-asm">Update custom services to support ASM.</h2>

<p>If you use a custom service that extends one of these classes:</p>

<ul>
  <li>UserService</li>
  <li>UserAddressService</li>
  <li>UserConsentService</li>
  <li>UserOrderService</li>
  <li>UserPaymentService</li>
</ul>

<p>You need to update their constructor in order to support ASM in your storefront.</p>

<p>If during customer emulation the storefront displays the error message: <code class="language-plaintext highlighter-rouge">Cannot find user with propertyValue 'current'</code>, it is very likely that you use custom services that need to be updated to support ASM.</p>

<p>The update consists of adding a dependency to AuthService in the constructor and pass it down to super(). The constructors that don’t have AuthService are now deprecated.</p>

<p>Beyond the constructor update, you may need to update your custom functions to support ASM as well. See the section called <code class="language-plaintext highlighter-rouge">How to write ASM compatible code</code> for details.</p>

<h3 id="update-userservice-subclasses">Update UserService Subclasses</h3>

<h4 id="custom-service">Custom service</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserService</span> <span class="kd">extends</span> <span class="nx">UserService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="custom-service-updated-to-support-asm">Custom service updated to support ASM.</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserService</span> <span class="kd">extends</span> <span class="nx">UserService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">,</span>
    <span class="nx">authService</span><span class="p">:</span> <span class="nx">AuthService</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">,</span> <span class="nx">authService</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="update-useraddressservice-subclasses">Update UserAddressService Subclasses</h3>

<h4 id="custom-service-1">Custom service</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserAddressService</span> <span class="kd">extends</span> <span class="nx">UserAddressService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">protected</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="custom-service-updated-to-support-asm-1">Custom service updated to support ASM.</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserAddressService</span> <span class="kd">extends</span> <span class="nx">UserAddressService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">,</span>
    <span class="k">protected</span> <span class="nx">authService</span><span class="p">:</span> <span class="nx">AuthService</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">,</span> <span class="nx">authService</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="update-userconsentservice-subclasses">Update UserConsentService Subclasses</h3>

<h4 id="custom-service-2">Custom service</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserConsentService</span> <span class="kd">extends</span> <span class="nx">UserConsentService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">protected</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="custom-service-updated-to-support-asm-2">Custom service updated to support ASM.</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserConsentService</span> <span class="kd">extends</span> <span class="nx">UserConsentService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">,</span>
    <span class="k">protected</span> <span class="nx">authService</span><span class="p">:</span> <span class="nx">AuthService</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">,</span> <span class="nx">authService</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="update-userorderservice-subclasses">Update UserOrderService Subclasses</h3>

<h4 id="custom-service-3">Custom service</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserOrderService</span> <span class="kd">extends</span> <span class="nx">UserOrderService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">protected</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="custom-service-updated-to-support-asm-3">Custom service updated to support ASM.</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserOrderService</span> <span class="kd">extends</span> <span class="nx">UserOrderService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">,</span>
    <span class="k">protected</span> <span class="nx">authService</span><span class="p">:</span> <span class="nx">AuthService</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">,</span> <span class="nx">authService</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="update-userpaymentservice-subclasses">Update UserPaymentService Subclasses</h3>

<h4 id="custom-service-4">Custom service</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserPaymentService</span> <span class="kd">extends</span> <span class="nx">UserPaymentService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">protected</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="custom-service-updated-to-support-asm-4">Custom service updated to support ASM.</h4>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomUserPaymentService</span> <span class="kd">extends</span> <span class="nx">UserPaymentService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">StateWithUser</span> <span class="o">|</span> <span class="nx">StateWithProcess</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;&gt;</span><span class="p">,</span>
    <span class="k">protected</span> <span class="nx">authService</span><span class="p">:</span> <span class="nx">AuthService</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">store</span><span class="p">,</span> <span class="nx">authService</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="how-to-write-asm-compatible-code">How to write ASM compatible code.</h2>

<p>Writing ASM compatible code is all about using the function <code class="language-plaintext highlighter-rouge">getOccUserId()</code> from the <code class="language-plaintext highlighter-rouge">AuthService</code> to determine the userId used in occ calls. This is typically done in a service that dispatches and action containing the userId in the payload.</p>

<p>Before ASM was released, the occ userId in requests on the behalf of an authenticated user was the special occ user “current”, represented by the constant <code class="language-plaintext highlighter-rouge">OCC_USER_ID_CURRENT</code>, like in this example:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">load</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="k">new</span> <span class="nx">UserActions</span><span class="p">.</span><span class="nx">LoadUserDetails</span><span class="p">(</span><span class="nx">OCC_USER_ID_CURRENT</span><span class="p">));</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>Now that Spartacus supports ASM, the correct way to determine the occ userId is to call AuthService.getOccUserId(). When we update the previous example, we get:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="nx">load</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">authService</span>
      <span class="p">.</span><span class="nx">getOccUserId</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">take</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">occUserId</span> <span class="o">=&gt;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="k">new</span> <span class="nx">UserActions</span><span class="p">.</span><span class="nx">LoadUserDetails</span><span class="p">(</span><span class="nx">occUserId</span><span class="p">))</span>
      <span class="p">);</span>
  <span class="p">}</span>

</code></pre></div></div>

<p>The rule of thumb is, if <code class="language-plaintext highlighter-rouge">OCC_USER_ID_CURRENT</code> is used directly in a service, it should likely be replaced by a call to <code class="language-plaintext highlighter-rouge">getOccUserId()</code>.</p>

<p>In order to support ASM, and potentially other features in the future, the facade services can’t simply use the “current” special userId when calling various actions. There needs to be some logic applied to determine the correct OCC userId to pass down to actions that will trigger a backend call.</p>

<p>Therefore, the logic to determine the correct OCC userId given the context is centralized in the <code class="language-plaintext highlighter-rouge">AuthService</code> function <code class="language-plaintext highlighter-rouge">getOccUserId()</code>.</p>

<h2 id="configuring">Configuring</h2>

<p>Some ASM behaviors can be configures through Spartacus.</p>

<h3 id="asmagentsessiontimerstartingdelayinseconds">asm.agentSessionTimer.startingDelayInSeconds</h3>

<p>The start time for the customer support agent session timer has a default value of 600 seconds (10 minutes). This can be configured. Specify the number of seconds for the timer starting delay via the property <code class="language-plaintext highlighter-rouge">asm.agentSessionTimer.startingDelayInSeconds</code>, as shown in the following example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">provideConfig</span><span class="p">({</span>
  <span class="na">asm</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">agentSessionTimer</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">startingDelayInSeconds</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="asmcustomesearchmaxresults">asm.customeSearch.maxResults</h3>

<p>The number of results in the asm customer search can be customized in spartacus via the property <code class="language-plaintext highlighter-rouge">asm.customeSearch.maxResults</code>. You define it as follows:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">provideConfig</span><span class="p">({</span>
  <span class="na">asm</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">customeSearch</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">maxResults</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="extending">Extending</h2>

<p>No special extensibility is available for this feature.</p>

<h2 id="limitations">Limitations</h2>

<h3 id="cms">CMS</h3>

<p>ASM customer emulation does not work with CMS content rules and restrictions in Spartacus. If there are content rules or restrictions that are normally applied based on a customer’s ID, or the customer’s group ID, these rules and restrictions will not be applied during an ASM customer emulation. The CMS endpoints instead provide content based on what the customer support agent is permitted to see.</p>

<p>To display CMS content, Spartacus relies on the CMS endpoints from OCC. When requests are sent, the CMS endpoints do not accept a <code class="language-plaintext highlighter-rouge">userId</code> parameter that could define the emulated user (that is, the customer). The CMS endpoints only recognize the authenticated user as the sender of requests, and in ASM customer emulation sessions, the authenticated user is the customer support agent.</p>

<p>The following OCC CMS endpoints work only for the authenticated user:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">/{baseSiteId}/cms/components</code></li>
  <li><code class="language-plaintext highlighter-rouge">/{baseSiteId}/cms/components/{componentId}</code></li>
  <li><code class="language-plaintext highlighter-rouge">/{baseSiteId}/cms/pages</code></li>
  <li><code class="language-plaintext highlighter-rouge">/{baseSiteId}/cms/pages/{pageId}</code></li>
  <li><code class="language-plaintext highlighter-rouge">/{baseSiteId}/cms/sitepages</code></li>
</ul>

<p>OCC CMS endpoints do not accept a <code class="language-plaintext highlighter-rouge">userId</code> parameter, so it is not possible for an emulated customer to trigger CMS rules and restrictions during an ASM emulation session.</p>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/3.x/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/3.x/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    apiKey: 'b6583768751462c6ee53d5a5720cda44', 
    indexName: 'sap_spartacus', 
    inputSelector: '#docsearch', 
    algoliaOptions: {
      'facetFilters': ["tags:latest"]
      },
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 


    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
