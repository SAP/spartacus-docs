<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Session Management - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="Session Management">
<meta property="og:url" content="/spartacus-docs/3.x/session-management/">












  

  


<link rel="canonical" href="/spartacus-docs/3.x/session-management/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/3.x/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/3.x/assets/css/main.css">
<link rel="stylesheet" href="/spartacus-docs/3.x/assets/css/keys.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/3.x/"><img src="/spartacus-docs/3.x/assets/images/logo-blue_64x64.png" alt="Spartacus logo"></a>
        
        <a class="site-title" href="/spartacus-docs/3.x/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/zt-jekftqo0-HP6xt6IF~ffVB2cGG66fcQ" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/#how-to-obtain-support" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/release-information/" >Version 3.4</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/"><span class="nav__sub-title">Home</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/getting-started/"><span class="nav__sub-title">Getting Started with Spartacus Libraries</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/dev-guide/"><span class="nav__sub-title">Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/a11y/">Accessibility ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/spartacus-api/">API</a>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/architecture/">Architecture ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                        
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/configurable-routing/" class="">Configurable Routing ➢</a>


                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/configurable-state-persistence-and-rehydration/" class="">Configurable State Persistence and Rehydration</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/configuring-base-url/" class="">Configuring the Base URL</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/type-augmentation/" class="">Extending Built-In Models</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/global-configuration-in-spartacus/" class="">Global Configuration in Spartacus</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/global-messages/" class="">Global Messages</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/http-error-handling/" class="">HTTP Error Handling</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/lazy-loading-guide/" class="">Lazy Loading</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/context-configuration/" class="">Multi-Site Configuration ➢</a>


                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/pwa-home/" class="">PWA ➢</a>


                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/seo/" class="">SEO ➢</a>


                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/session-management/" class="active">Session Management</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/3.x/state-management/" class="">State Management ➢</a>


                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                    

                                                                      
                                                                      

                                                                        
                                                                            <ul>
                                                                                  
                                                                            </ul>
                                                                        
                                                                        
                                                                </li>
                                                            
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/customizing-and-extending/">Customizing and Extending Spartacus ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/customizing-backend-communication/">Customizing Back End Communication ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/performance/">Performance Optimizations ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/security-best-practices/">Security Best Practices ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/server-side-rendering-in-spartacus/">Server-Side Rendering ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/spartacus-features/">Storefront Features ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/3.x/styling-and-page-layout/">Styling and Page Layout ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                      
                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/using-spartacus/"><span class="nav__sub-title">Using the Spartacus Storefront</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/about-tua-spartacus/"><span class="nav__sub-title">Telco & Utilities Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/about-fsa-spartacus/"><span class="nav__sub-title">Financial Services Accelerator Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/contributors-guide/"><span class="nav__sub-title">Contributing to Spartacus</span></a>
         
        
            <ul>
                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
  </ul>
</nav>      

    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">Session Management</h1>
    
    <p><strong>Note: Spartacus 3.x is no longer maintained. Please upgrade to the latest version.</strong></p>


<p><b>Note: </b> 
This feature is introduced with version 3.0 of the Spartacus libraries.
 </p>

<p>Spartacus 3.0 introduces a new way to manage user sessions, handle tokens, and perform authorizations. The following sections are intended to help you understand how session management works under the hood, how can you extend the underlying mechanism, and how you can interact with the auth module from outside of Spartacus.</p>

<hr />

<p><strong>Table of Contents</strong></p>

<ul id="markdown-toc">
  <li><a href="#client-authentication-and-user-authentication" id="markdown-toc-client-authentication-and-user-authentication">Client Authentication and User Authentication</a></li>
  <li><a href="#user-authentication" id="markdown-toc-user-authentication">User Authentication</a>    <ul>
      <li><a href="#authentication-flow" id="markdown-toc-authentication-flow">Authentication Flow</a></li>
      <li><a href="#storing-tokens-and-user-identifiers" id="markdown-toc-storing-tokens-and-user-identifiers">Storing Tokens and User Identifiers</a></li>
      <li><a href="#access-tokens-in-api-calls-and-error-recovery" id="markdown-toc-access-tokens-in-api-calls-and-error-recovery">Access Tokens in API Calls and Error Recovery</a></li>
      <li><a href="#persisting-authentication-data-in-the-browser-storage" id="markdown-toc-persisting-authentication-data-in-the-browser-storage">Persisting Authentication Data in the Browser Storage</a></li>
    </ul>
  </li>
  <li><a href="#assisted-service-module" id="markdown-toc-assisted-service-module">Assisted Service Module</a></li>
  <li><a href="#complementary-components-to-the-authmodule" id="markdown-toc-complementary-components-to-the-authmodule">Complementary Components to the AuthModule</a></li>
  <li><a href="#configuring-openid" id="markdown-toc-configuring-openid">Configuring OpenId</a></li>
  <li><a href="#configuring-authorization-code-flow-or-implicit-flow" id="markdown-toc-configuring-authorization-code-flow-or-implicit-flow">Configuring Authorization Code Flow or Implicit Flow</a></li>
</ul>

<hr />

<h2 id="client-authentication-and-user-authentication">Client Authentication and User Authentication</h2>

<p>From the beginning, Spartacus has included both client authentication and user authentication. Although this is not typical for web applications, it is necessary for Spartacus to work with the OCC API.</p>

<p>Client authentication relates to the endpoints that work on behalf of logged-out users, such as registering, resetting a password, placing an order as a guest, and verifying an address. These endpoints require an access token to be sent with the request, and this access token needs to be retrieved by following the Client Credentials Flow that is defined by the OAuth specification. In other words, the Client Credentials Flow is needed for certain OCC requests, so you need to enable this flow in your OAuth client.</p>

<p><strong>Caution:</strong> When you enable the Client Credentials Flow in your OAuth client, you should always use <code class="language-plaintext highlighter-rouge">ROLE_CLIENT</code> with the Spartacus OAuth client. You should never use <code class="language-plaintext highlighter-rouge">ROLE_TRUSTED_CLIENT</code> with Spartacus because it will significantly compromise the security of your application.</p>

<p>Meanwhile, user authentication is used for requests that are sent on behalf of specific user resources. For example, if you want to update your profile, you need to be logged in. When you log in, the server confirms your credentials and returns an access token to the application. This token is then used for all requests on your account, such as updating your profile, making cart modifications, and checking out.</p>

<p>Prior to Spartacus 3.0, the code for both client authentication and user authentication was in the <code class="language-plaintext highlighter-rouge">AuthModule</code>, which included interceptors, services, and facade methods all mixed together. In Spartacus 3.0, the <code class="language-plaintext highlighter-rouge">AuthModule</code> still contains client and user authentication, but this is now the result of importing two modules, the <code class="language-plaintext highlighter-rouge">UserAuthModule</code> and the <code class="language-plaintext highlighter-rouge">ClientAuthModule</code>. Each module is responsible for one type of authentication.</p>

<p>This change is important because Spartacus is built to support OCC by default, but Spartacus is not limited to using OCC. The OCC API requires client credentials for some of the requests it receives, but this is not common for other APIs, and accordingly, the client and user authentication has been separated to make it easier to work with other APIs. For example, if you are using a different API that does not need client authentication, instead of using the <code class="language-plaintext highlighter-rouge">AuthModule</code>, you can import only the <code class="language-plaintext highlighter-rouge">UserAuthModule</code> and reduce the size of your final bundle by not including the <code class="language-plaintext highlighter-rouge">ClientAuthModule</code>.</p>

<h2 id="user-authentication">User Authentication</h2>

<p>This section takes a detailed look at the <code class="language-plaintext highlighter-rouge">UserAuthModule</code>, where most of the changes to session management were made.</p>

<p>The following diagram shows how the <code class="language-plaintext highlighter-rouge">UserAuthModule</code> works under the hood:</p>

<p><img src="/spartacus-docs/3.x/assets/images/session-management/all.svg" alt="UserAuthModule" /></p>

<p>The <code class="language-plaintext highlighter-rouge">UserAuthModule</code> module is responsible for the following:</p>

<ul>
  <li>performing authentication flow</li>
  <li>storing tokens and user identifiers</li>
  <li>adding access tokens for user calls</li>
  <li>recovering from API auth errors (for example, refreshing tokens when access tokens expire)</li>
  <li>persisting the tokens in browser storage</li>
</ul>

<p>Each of these steps is described in more detail in the following sections.</p>

<h3 id="authentication-flow">Authentication Flow</h3>

<p>Authenticating users is the main responsibility of this module. Previous versions of Spartacus used custom code to provide support for the Resource Owner Password Flow, but OAuth specifies additional flows that can be used in web applications. To support these additional flows, Spartacus 3.0 no longer uses its custom code for the Resource Owner Password Flow, and instead relies on the third party <code class="language-plaintext highlighter-rouge">angular-oauth2-oidc</code> library that is built for this purpose, and is also well-tested and certified.</p>

<p>The services that are involved in authenticating users are highlighted in the following diagram:</p>

<p><img src="/spartacus-docs/3.x/assets/images/session-management/auth.svg" alt="Authentication flow" /></p>

<p>Authentication starts from the <code class="language-plaintext highlighter-rouge">AuthService</code> facade, where you initialize the process by calling one of the following login methods:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">loginWithCredentials</code> for the Resource Owner Password Flow</li>
  <li><code class="language-plaintext highlighter-rouge">loginWithRedirect</code> for the Implicit Flow or the Authorization Code Flow</li>
</ul>

<p>The login method then interacts with the <code class="language-plaintext highlighter-rouge">angular-oauth2-oidc</code> library. However, this interaction always goes through the <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService</code>, which is a layer for isolating external libraries from Spartacus code.</p>

<p><strong>Note:</strong> If you want to access methods from a library that Spartacus does not expose, you should extend the <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService</code> class.</p>

<p>The <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService</code> class is also responsible for configuring the library. It uses the <code class="language-plaintext highlighter-rouge">AuthConfigService</code> to access the <code class="language-plaintext highlighter-rouge">AuthConfig</code> configuration provided in the application.</p>

<p>It is recommended that you always use the <code class="language-plaintext highlighter-rouge">AuthConfigService</code> if you need to read anything from the <code class="language-plaintext highlighter-rouge">AuthConfig</code>. This service is able to provide sensible defaults when some parts of the configuration are missing, and it gives you a few utilities out of the box, including one that detects OAuth flow based on your configuration.</p>

<p>The <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService</code> is a relatively thin layer that provides a lot of flexibility with the library. Spartacus also provides the <code class="language-plaintext highlighter-rouge">authentication.OAuthLibConfig</code> configuration option, which allows you to pass any configuration option to the library. Client and endpoint configurations are available in the top-level <code class="language-plaintext highlighter-rouge">authentication</code> configuration.</p>

<p>You can learn more about advanced configuration of the authentication flow by looking at the <code class="language-plaintext highlighter-rouge">angular-oauth2-oidc</code> library source code, as well as the <a href="https://github.com/manfredsteyer/angular-oauth2-oidc">angular-oauth2-oidc documentation</a>.</p>

<h3 id="storing-tokens-and-user-identifiers">Storing Tokens and User Identifiers</h3>

<p>After authentication, the tokens received from the library methods need to be stored somewhere. Previously, these tokens were kept in NgRx Store, but in Spartacus 3.0, there are dedicated services to keep the data. The library requires a storage mechanism with an API similar to <code class="language-plaintext highlighter-rouge">localStorage</code> or <code class="language-plaintext highlighter-rouge">sessionStorage</code>, and that was the main reason to switch from NgRx to services with a stream for keeping the data.</p>

<p><img src="/spartacus-docs/3.x/assets/images/session-management/store.svg" alt="Storing auth data" /></p>

<p>For authentication, it is normally sufficient to store only tokens and their metadata (such as expiration time and scope). However, with OCC, there is also the tightly-coupled user ID that needs to be set after login or logout, as well as being required for user emulation when working with the Assisted Service Module (ASM). Prior to Spartacus 3.0, the user ID was kept in the same place as the tokens in NgRx, and because of that previous association, the user ID remains in the <code class="language-plaintext highlighter-rouge">UserAuthModule</code>. However, the tokens have now been separated from the user identifier in this module. Tokens and their metadata are now stored with the <code class="language-plaintext highlighter-rouge">AuthStorageService</code>, while user IDs have their own, dedicated <code class="language-plaintext highlighter-rouge">UserIdService</code>.</p>

<p>The usual sequence for the authentication data flow is the following:</p>

<ul>
  <li>a user invokes login</li>
  <li>the authentication library perform the OAuth flow and receives tokens</li>
  <li>the authentication library directly sets the tokens in the <code class="language-plaintext highlighter-rouge">AuthStorageService</code> through the <code class="language-plaintext highlighter-rouge">setItem</code> and <code class="language-plaintext highlighter-rouge">removeItem</code> methods</li>
  <li>the <code class="language-plaintext highlighter-rouge">AuthService</code> is informed about the successful login</li>
  <li>the <code class="language-plaintext highlighter-rouge">AuthService</code> sets the user ID in the <code class="language-plaintext highlighter-rouge">UserIdService</code> for the logged-in user</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">UserIdService</code> is part of a facade, because almost all services that interact with the OCC API require it. Previously, the user ID was exposed in the <code class="language-plaintext highlighter-rouge">AuthService.getOccUserId</code>. As a result, in Spartacus 3.0 it has been kept in the same facade, but in a different service and in a different method.</p>

<h3 id="access-tokens-in-api-calls-and-error-recovery">Access Tokens in API Calls and Error Recovery</h3>

<p>After logging in a user, and storing their access token and user ID, it is then possible to request some of the user’s resources. To do so, it is necessary to pass an access token as a header in the request. In Spartacus, this is achieved with HTTP interceptors, as shown in the following diagram:</p>

<p><img src="/spartacus-docs/3.x/assets/images/session-management/interceptors.svg" alt="Auth interceptors" /></p>

<p>To enrich a request with an access token, you do not need to mark the request in any way. The <code class="language-plaintext highlighter-rouge">AuthInterceptor</code> recognizes the request to the API based on the URL. If the request does not have the <code class="language-plaintext highlighter-rouge">Authorization</code> header, and does match the API path, the interceptor adds the header to the request. To make it easier to extend the interceptor, Spartacus has its own <code class="language-plaintext highlighter-rouge">AuthHttpHeaderService</code> helper service. In most cases, extending this one service should be enough.</p>

<p>Apart from injecting the token, this interceptor is also responsible for handling errors that are related to authorization. In such cases, it tries to recover first and retry the request, and if that is not possible, it completes the logout process and redirects the user to the login page. When a request fails because the access token has expired, the interceptor uses the refresh token (if it exists) to request a new access token, and then retries the failed request with the new token.</p>

<p>A second <code class="language-plaintext highlighter-rouge">TokenRevocationInterceptor</code> interceptor has a very specific role. For calls to revoke tokens on user logout, this interceptor adds an <code class="language-plaintext highlighter-rouge">Authorization</code> header. With a different OAuth server, you might not need to provide this header, and you can drop this interceptor from your own <code class="language-plaintext highlighter-rouge">UserAuthModule</code>.</p>

<h3 id="persisting-authentication-data-in-the-browser-storage">Persisting Authentication Data in the Browser Storage</h3>

<p>After you log in, and your token has been stored and used for API calls, you refresh the page and suddenly you are no longer logged in. To avoid this problem, the <code class="language-plaintext highlighter-rouge">AuthStatePersistenceService</code> synchronizes the authentication data (such as tokens and user ID) in the browser storage, as shown in the following diagram.</p>

<p><img src="/spartacus-docs/3.x/assets/images/session-management/storage.svg" alt="Storing auth data in browser" /></p>

<p>The <code class="language-plaintext highlighter-rouge">AuthStatePersistenceService</code> uses the <code class="language-plaintext highlighter-rouge">StatePersistenceService</code> to synchronize data to and from the browser storage. The user ID from the <code class="language-plaintext highlighter-rouge">UserIdService</code>, the tokens from the <code class="language-plaintext highlighter-rouge">AuthStorageService</code>, and the redirect URL from the <code class="language-plaintext highlighter-rouge">AuthRedirectStorageService</code> are all synchronized to the <code class="language-plaintext highlighter-rouge">localStorage</code>. Every time data changes, it is saved in the browser storage, and when the application starts, it is read from the storage into services.</p>

<h2 id="assisted-service-module">Assisted Service Module</h2>

<p>Since version 1.3, Spartacus supports the Assisted Service Module (ASM), which allows customer support agents to emulate users and help them accomplish their goals. This feature is tightly coupled with the <code class="language-plaintext highlighter-rouge">AuthModule</code> because agents need to log in with OAuth flow and make updates using the customer’s user ID. In previous versions of Spartacus, some parts of the implementation of this feature were placed in the <code class="language-plaintext highlighter-rouge">AuthModule</code> logic.</p>

<p>One of the goals of the Session Management refactor was to make the <code class="language-plaintext highlighter-rouge">AuthModule</code> not aware of ASM at all. As a result, removing ASM from your application should be as simple as not including the <code class="language-plaintext highlighter-rouge">AsmModule</code>. No code should be left in different modules. With the new <code class="language-plaintext highlighter-rouge">AuthModule</code> structure, the ASM feature is now isolated.</p>

<p><img src="/spartacus-docs/3.x/assets/images/session-management/asm.svg" alt="Asm integration with UserAuthModule" /></p>

<p>To integrate ASM with the <code class="language-plaintext highlighter-rouge">UserAuthModule</code>, the mechanism for providing your own services was used, along with inheritance.</p>

<p>The <code class="language-plaintext highlighter-rouge">AuthService</code>, <code class="language-plaintext highlighter-rouge">AuthHttpHeaderService</code>, and <code class="language-plaintext highlighter-rouge">AuthStorageService</code> were extended, and then provided in the <code class="language-plaintext highlighter-rouge">AsmModule</code>, as shown in the following example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">provide</span><span class="p">:</span> <span class="nx">AuthStorageService</span><span class="p">,</span>
  <span class="nx">useExisting</span><span class="p">:</span> <span class="nx">AsmAuthStorageService</span><span class="p">,</span>
<span class="p">},</span>
<span class="p">{</span>
  <span class="na">provide</span><span class="p">:</span> <span class="nx">AuthService</span><span class="p">,</span>
  <span class="na">useExisting</span><span class="p">:</span> <span class="nx">AsmAuthService</span><span class="p">,</span>
<span class="p">},</span>
<span class="p">{</span>
  <span class="na">provide</span><span class="p">:</span> <span class="nx">AuthHttpHeaderService</span><span class="p">,</span>
  <span class="na">useExisting</span><span class="p">:</span> <span class="nx">AsmAuthHttpHeaderService</span><span class="p">,</span>
<span class="p">},</span>
</code></pre></div></div>

<p>Along with these services, Spartacus now has a <code class="language-plaintext highlighter-rouge">CSAgentAuthService</code> that is responsible for the CS agent login and logout process. The <code class="language-plaintext highlighter-rouge">AsmAuthStorageService</code> stores a bit more information than the original <code class="language-plaintext highlighter-rouge">AuthStorageService</code>, and this information must be persisted in browser as well, so the <code class="language-plaintext highlighter-rouge">AsmStatePersistenceService</code> was created to work alongside the <code class="language-plaintext highlighter-rouge">AuthStatePersistenceService</code>. Part of the data in <code class="language-plaintext highlighter-rouge">AsmAuthStorageService</code> is initialized by the <code class="language-plaintext highlighter-rouge">AuthStatePersistenceService</code>, and the rest is resolved by the <code class="language-plaintext highlighter-rouge">AsmStatePersistenceService</code>.</p>

<p>The <code class="language-plaintext highlighter-rouge">AuthHttpHeaderService</code> also had to be overridden because Spartacus needs to not only add the token to OCC calls, but also to ASM calls (for example, listing users that are available for emulation). The error handling for authentication errors also needed to be improved because Spartacus needs to handle agent requests differently than normal user requests (for example, logging out an agent instead of a regular user).</p>

<p>The <code class="language-plaintext highlighter-rouge">AsmModule</code> from <code class="language-plaintext highlighter-rouge">@spartacus/core</code> is a good example of how the new <code class="language-plaintext highlighter-rouge">UserAuthModule</code> can be modified and extended from the outside. Most of the patterns that are used in the <code class="language-plaintext highlighter-rouge">AsmModule</code> are the same patterns you would use if you wish to extend the <code class="language-plaintext highlighter-rouge">UserAuthModule</code> (for example, to provide services and inheritance, to build new services, or to assemble a few existing services).</p>

<h2 id="complementary-components-to-the-authmodule">Complementary Components to the AuthModule</h2>

<p>There are a few complementary components across the codebase to make authentication work as you would expect in a web application.</p>

<p>Spartacus still relies on <code class="language-plaintext highlighter-rouge">AuthGuard</code> to protect pages that should only be available to logged in users, and <code class="language-plaintext highlighter-rouge">NotAuthGuard</code> for pages that are only for anonymous users. Using these guards consistently for all pages ensures correct redirects after successful login. The <code class="language-plaintext highlighter-rouge">AuthRedirectService</code> is called from these guards with information about the accessed page. As a result, when you log in, you are redirected to the page you were on (or tried to access) before logging in.</p>

<p>Another established pattern in Spartacus is the use of the <code class="language-plaintext highlighter-rouge">logout</code> route as the main mechanism for initializing the logout process for the user. The <code class="language-plaintext highlighter-rouge">AuthService</code> exposes the method to log out the user (<code class="language-plaintext highlighter-rouge">coreLogout</code>), but you need to be careful with the logout process, especially if you use protected routes. Instead, it is recommended that you redirect to the <code class="language-plaintext highlighter-rouge">logout</code> page every time you want to log out. This flow allows you to avoid typical logout problems, including redirect issues, as well as having users log out but still remain on a page that is only for authenticated users.</p>

<h2 id="configuring-openid">Configuring OpenId</h2>

<p>The <code class="language-plaintext highlighter-rouge">KymaModule</code> has been removed, but the functionality can be replicated by providing an appropriate <code class="language-plaintext highlighter-rouge">authentication</code> configuration. The <code class="language-plaintext highlighter-rouge">KymaModule</code> was responsible only for fetching a JWT token alongside the other tokens that are fetched during user login. This was accomplished by using a separate OAuth client and by calling the login endpoint two times with different clients.</p>

<p>This can be done in one login call by using an OpenID-capable client and setting the proper response type and scope. The following is an example configuration to get both the access token and the <code class="language-plaintext highlighter-rouge">id_token</code> with the Resource Owner Password Flow:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">authentication</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">client_id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">client4kyma</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">client_secret</span><span class="p">:</span> <span class="dl">'</span><span class="s1">secret</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">OAuthLibConfig</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">responseType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">id_token</span><span class="dl">'</span><span class="p">,</span>
    <span class="nx">scope</span><span class="p">:</span> <span class="dl">'</span><span class="s1">openid</span><span class="dl">'</span><span class="p">,</span>
    <span class="nx">customTokenParameters</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">id_token</span><span class="dl">'</span><span class="p">],</span>
  <span class="p">},</span>
<span class="p">},</span>
</code></pre></div></div>

<p>When you complete the login, you can then access the <code class="language-plaintext highlighter-rouge">id_token</code> with the <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService.getIdToken</code> method.</p>

<h2 id="configuring-authorization-code-flow-or-implicit-flow">Configuring Authorization Code Flow or Implicit Flow</h2>

<p>Now the Spartacus uses the <code class="language-plaintext highlighter-rouge">angular-oauth2-oidc</code> library, it is possible to support the Authorization Code Flow and the Implicit Flow. These flows are very different from the Resource Owner Password Flow because the authentication part happens on the OAuth server login page rather than in Spartacus. When Spartacus redirects you to this page, you provide login and password information there, and if the credentials match, you are redirected back to the Spartacus application with the token (Implicit Flow) or code (Authorization Code Flow) as part of the URL. Then Spartacus obtains the data from the URL and continues the login process (requests a token in the case of Authorization Code Flow, sets the user ID, dispatches the <code class="language-plaintext highlighter-rouge">Login</code> action, and redirects to the previously visited page).</p>

<p>You can configure this as follows:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">authentication</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">OAuthLibConfig</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">responseType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// 'code` for Authorization Code Flow</span>
  <span class="p">},</span>
<span class="p">},</span>
</code></pre></div></div>

<p>Apart from this configuration, you may need to update a few details for your OAuth client in Backoffice (such as allowing Implicit Flow or Authorization Code Flow, and setting the redirect URL of the application).</p>

<p>Once these settings are in place, Spartacus will use the defined flow out of the box. The login route is configured in a way that detects the OAuth flow based on the configuration (<code class="language-plaintext highlighter-rouge">LoginGuard</code> and <code class="language-plaintext highlighter-rouge">LoginRouteModule</code>). When it detects a flow other than the Resource Owner Password Flow, Spartacus saves the previous URL (to redirect to after login), and redirects you to the OAuth server login page.</p>

<p>Spartacus runs <code class="language-plaintext highlighter-rouge">AuthService.checkOAuthParamsInUrl</code> with <code class="language-plaintext highlighter-rouge">APP_INITIALIZER</code> on any route, so you can redirect to any Spartacus page from the OAuth server. It does not have to be a callback page, as it is usually done.</p>

<p><strong>Note:</strong> The default OAuth server that is provided with SAP Commerce Cloud does not have great support for the Authorization Code Flow and the Implicit Flow (there is no way to log out a user from an external application, and no way to customize the login page), so for now it is expected that everyone using this OAuth server will continue to work with the Resource Owner Password Flow. However, if you use a different OAuth server (such as <code class="language-plaintext highlighter-rouge">Auth0</code>), you can switch to either of these flows.</p>

<p><strong>Note:</strong> ASM login only works with the Resource Owner Password Flow for customer support agents.</p>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/3.x/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/3.x/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    appId: 'BNZEXRISC6',
    apiKey: '54a795a072ff713045038ee4ad33c990', 
    indexName: 'sap_spartacus', 
    inputSelector: '#docsearch', 
    algoliaOptions: {
      'facetFilters': ["tags:3.x"]
      },
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 


    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
