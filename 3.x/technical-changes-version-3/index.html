<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Technical Changes in Spartacus 3.0 - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="Technical Changes in Spartacus 3.0">
<meta property="og:url" content="/spartacus-docs/3.x/technical-changes-version-3/">












  

  


<link rel="canonical" href="/spartacus-docs/3.x/technical-changes-version-3/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/3.x/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/3.x/assets/css/main.css">
<link rel="stylesheet" href="/spartacus-docs/3.x/assets/css/keys.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/3.x/"><img src="/spartacus-docs/3.x/assets/images/logo-blue_64x64.png" alt="Spartacus logo"></a>
        
        <a class="site-title" href="/spartacus-docs/3.x/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/zt-jekftqo0-HP6xt6IF~ffVB2cGG66fcQ" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/#how-to-obtain-support" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/3.x/release-information/" >Version 3.4</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/"><span class="nav__sub-title">Home</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                                

                                                
                                                

                                                  

                                                    <li><a href="/spartacus-docs/3.x/release-information/">Release Information ➢</a>
                                                  
                                                            <ul>
                                                                
                                                                  
                                                                
                                                                  
                                                                
                                                                  
                                                                    
                                                                      

                                                                        
                                                                        
                                                                        
                                                                        <li><a href="/spartacus-docs/3.x/pre-release-information/">Pre-Release Information</a>

                                                                          
                                                                            <ul>
                                                                              
                                                                            </ul>                
                                                                             
                                                                          </li>
                                                                      

                                                                        
                                                                        
                                                                        
                                                                        <li><a href="/spartacus-docs/3.x/feature-release-versions/">Feature Compatibility</a>

                                                                          
                                                                            <ul>
                                                                              
                                                                            </ul>                
                                                                             
                                                                          </li>
                                                                      

                                                                        
                                                                        
                                                                        
                                                                        <li><a href="/spartacus-docs/3.x/updating-to-version-3/">Updating to Version 3.0 ➢</a>

                                                                          
                                                                            <ul>
                                                                              
                                                                                
                                                                                  

                                                                                    
                                                                                    
                                                                                  
                                                                                    
                                                                                    
                                                                                         
                                                                                       <li><a href="/spartacus-docs/3.x/technical-changes-version-3/" class="active">Technical Changes in Spartacus 3.0</a></li>

                                                                                  

                                                                                    
                                                                                    
                                                                                  
                                                                                    
                                                                                    
                                                                                         
                                                                                       <li><a href="/spartacus-docs/3.x/css-changes-in-version-3/" class="">Changes to Styles in 3.0</a></li>

                                                                                       
                                                                                        
                                                                              
                                                                                        
                                                                              
                                                                            </ul>                
                                                                             
                                                                          </li>
                                                                      

                                                                        
                                                                        
                                                                        
                                                                        <li><a href="/spartacus-docs/3.x/updating-to-version-2/">Updating to Version 2.0 ➢</a>

                                                                          
                                                                            <ul>
                                                                              
                                                                                        
                                                                              
                                                                                        
                                                                              
                                                                            </ul>                
                                                                             
                                                                          </li>
                                                                      
                                                                      
                                                                  
                                                                      
                                                                  
                                                                
                                                                  
                                                                      
                                                                  
                                                                      
                                                                  
                                                                
                                                            </ul>
                                                    </li>
                                                    
                                                

                                                
                                                

                                                  

                                                    <li><a href="/spartacus-docs/3.x/spartacus-videos/">Spartacus Videos</a>
                                                  
                                                            <ul>
                                                                
                                                            </ul>
                                                    </li>
                                                    
                                                

                                                
                                                

                                                  

                                                    <li><a href="/spartacus-docs/3.x/spartacus-roadmap/">Spartacus Roadmap</a>
                                                  
                                                            <ul>
                                                                
                                                            </ul>
                                                    </li>
                                                    
                                                

                                                
                                                

                                                  

                                                    <li><a href="/spartacus-docs/3.x/spartacus-faq/">Spartacus FAQ</a>
                                                  
                                                            <ul>
                                                                
                                                            </ul>
                                                    </li>
                                                    
                                                

                                                
                                                

                                                  

                                                    <li><a href="/spartacus-docs/3.x/docs-archive/">Documentation Archive</a>
                                                  
                                                            <ul>
                                                                
                                                            </ul>
                                                    </li>
                                                    
                                                
                                        
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/getting-started/"><span class="nav__sub-title">Getting Started with Spartacus Libraries</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/dev-guide/"><span class="nav__sub-title">Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/using-spartacus/"><span class="nav__sub-title">Using the Spartacus Storefront</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/about-tua-spartacus/"><span class="nav__sub-title">Telco & Utilities Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/about-fsa-spartacus/"><span class="nav__sub-title">Financial Services Accelerator Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/3.x/contributors-guide/"><span class="nav__sub-title">Contributing to Spartacus</span></a>
         
        
            <ul>
                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
  </ul>
</nav>      

    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">Technical Changes in Spartacus 3.0</h1>
    
    <p><strong>Note: Spartacus 3.x is no longer maintained. Please upgrade to the latest version.</strong></p>

<hr />

<p><strong>Table of Contents</strong></p>

<ul id="markdown-toc">
  <li><a href="#breaking-changes-introduced-in-30" id="markdown-toc-breaking-changes-introduced-in-30">Breaking Changes Introduced in 3.0</a>    <ul>
      <li><a href="#translations-i18n-changed" id="markdown-toc-translations-i18n-changed">Translations (i18n) changed</a></li>
      <li><a href="#default-router-options-changed" id="markdown-toc-default-router-options-changed">Default router options changed</a></li>
      <li><a href="#page-layout" id="markdown-toc-page-layout">Page Layout</a></li>
      <li><a href="#static-cms-structure-config-changes" id="markdown-toc-static-cms-structure-config-changes">Static CMS structure config changes</a></li>
      <li><a href="#occ-prefix" id="markdown-toc-occ-prefix">OCC prefix</a></li>
      <li><a href="#storefront-config" id="markdown-toc-storefront-config">Storefront config</a></li>
      <li><a href="#json-ld-schemas" id="markdown-toc-json-ld-schemas">JSON-LD schemas</a></li>
      <li><a href="#contentpagemetaresolver" id="markdown-toc-contentpagemetaresolver">ContentPageMetaResolver</a></li>
      <li><a href="#loginformcomponent" id="markdown-toc-loginformcomponent">LoginFormComponent</a></li>
      <li><a href="#httpclientmodule-is-not-imported-in-feature-libraries" id="markdown-toc-httpclientmodule-is-not-imported-in-feature-libraries">HttpClientModule is not imported in feature libraries</a></li>
      <li><a href="#ssr-engine-optimizations" id="markdown-toc-ssr-engine-optimizations">SSR engine optimizations</a></li>
      <li><a href="#store-finder-functionality-was-moved-to-a-new-library" id="markdown-toc-store-finder-functionality-was-moved-to-a-new-library">Store finder functionality was moved to a new library</a></li>
      <li><a href="#stocknotificationcomponent" id="markdown-toc-stocknotificationcomponent">StockNotificationComponent</a></li>
      <li><a href="#cmscomponentsservice" id="markdown-toc-cmscomponentsservice">CmsComponentsService</a></li>
      <li><a href="#config-cmscomponents" id="markdown-toc-config-cmscomponents">Config cmsComponents</a></li>
      <li><a href="#pagemetaservice-lazy-loading-related-changes" id="markdown-toc-pagemetaservice-lazy-loading-related-changes">PageMetaService lazy-loading related changes</a></li>
      <li><a href="#converterservice-lazy-loading-related-changes" id="markdown-toc-converterservice-lazy-loading-related-changes">ConverterService lazy-loading related changes</a></li>
      <li><a href="#payload-for-constructor-of-placeorder-class-from-checkout-actions-requires-an-additional-property" id="markdown-toc-payload-for-constructor-of-placeorder-class-from-checkout-actions-requires-an-additional-property">Payload for constructor of PlaceOrder class from Checkout actions requires an additional property</a></li>
      <li><a href="#placeordercomponent" id="markdown-toc-placeordercomponent">PlaceOrderComponent</a></li>
      <li><a href="#property-renamed-in-searchconfig-interface" id="markdown-toc-property-renamed-in-searchconfig-interface">Property renamed in SearchConfig interface</a></li>
      <li><a href="#changes-in-checkoutstepsstate-interface" id="markdown-toc-changes-in-checkoutstepsstate-interface">Changes in CheckoutStepsState interface</a></li>
      <li><a href="#changes-in-checkoutstate-interface" id="markdown-toc-changes-in-checkoutstate-interface">Changes in CheckoutState interface</a></li>
      <li><a href="#outletrefdirective-unregisters-template-on-destroy" id="markdown-toc-outletrefdirective-unregisters-template-on-destroy">OutletRefDirective unregisters template on destroy</a></li>
      <li><a href="#cartitemcomponent-lost-members" id="markdown-toc-cartitemcomponent-lost-members">CartItemComponent lost members</a></li>
      <li><a href="#cartitemlistcomponent" id="markdown-toc-cartitemlistcomponent">CartItemListComponent</a></li>
      <li><a href="#addtocartcomponent" id="markdown-toc-addtocartcomponent">AddToCartComponent</a></li>
      <li><a href="#auth-module-refactor" id="markdown-toc-auth-module-refactor">Auth module refactor</a>        <ul>
          <li><a href="#store" id="markdown-toc-store">Store</a></li>
          <li><a href="#models" id="markdown-toc-models">Models</a></li>
          <li><a href="#guards" id="markdown-toc-guards">Guards</a></li>
          <li><a href="#services" id="markdown-toc-services">Services</a></li>
          <li><a href="#config" id="markdown-toc-config">Config</a></li>
        </ul>
      </li>
      <li><a href="#kymamodule" id="markdown-toc-kymamodule">KymaModule</a></li>
      <li><a href="#asm-module-refactor" id="markdown-toc-asm-module-refactor">ASM module refactor</a>        <ul>
          <li><a href="#asmauthservice" id="markdown-toc-asmauthservice">AsmAuthService</a></li>
        </ul>
      </li>
      <li><a href="#cdc-library" id="markdown-toc-cdc-library">CDC library</a></li>
      <li><a href="#orderdetailheadlinecomponent" id="markdown-toc-orderdetailheadlinecomponent">OrderDetailHeadlineComponent</a></li>
      <li><a href="#orderdetailshippingcomponent" id="markdown-toc-orderdetailshippingcomponent">OrderDetailShippingComponent</a></li>
      <li><a href="#orderconfirmationoverviewcomponent" id="markdown-toc-orderconfirmationoverviewcomponent">OrderConfirmationOverviewComponent</a></li>
      <li><a href="#basesiteservice" id="markdown-toc-basesiteservice">BaseSiteService</a></li>
      <li><a href="#configinitializerservice-constructor" id="markdown-toc-configinitializerservice-constructor">ConfigInitializerService constructor</a></li>
      <li><a href="#cmscomponentsservice-constructor" id="markdown-toc-cmscomponentsservice-constructor">CmsComponentsService constructor</a>        <ul>
          <li><a href="#the-configurationfactory-was-removed" id="markdown-toc-the-configurationfactory-was-removed">The configurationFactory was removed</a></li>
        </ul>
      </li>
      <li><a href="#checkoutprogressmobilebottomcomponent" id="markdown-toc-checkoutprogressmobilebottomcomponent">CheckoutProgressMobileBottomComponent</a></li>
      <li><a href="#checkoutprogressmobiletopcomponent" id="markdown-toc-checkoutprogressmobiletopcomponent">CheckoutProgressMobileTopComponent</a></li>
      <li><a href="#checkoutprogresscomponent" id="markdown-toc-checkoutprogresscomponent">CheckoutProgressComponent</a></li>
      <li><a href="#deliverymodecomponent" id="markdown-toc-deliverymodecomponent">DeliveryModeComponent</a></li>
      <li><a href="#paymentmethodcomponent" id="markdown-toc-paymentmethodcomponent">PaymentMethodComponent</a></li>
      <li><a href="#shippingaddresscomponent" id="markdown-toc-shippingaddresscomponent">ShippingAddressComponent</a></li>
      <li><a href="#checkoutauthguard" id="markdown-toc-checkoutauthguard">CheckoutAuthGuard</a></li>
      <li><a href="#checkoutconfigservice" id="markdown-toc-checkoutconfigservice">CheckoutConfigService</a></li>
      <li><a href="#the-placeorder-method-for-checkoutadapter-occcheckoutadapter-and-checkoutconnector" id="markdown-toc-the-placeorder-method-for-checkoutadapter-occcheckoutadapter-and-checkoutconnector">The placeOrder method for CheckoutAdapter, OccCheckoutAdapter and CheckoutConnector</a></li>
      <li><a href="#breakpointservice" id="markdown-toc-breakpointservice">BreakpointService</a></li>
      <li><a href="#protectedroutesguard" id="markdown-toc-protectedroutesguard">ProtectedRoutesGuard</a></li>
      <li><a href="#itemcountercomponent" id="markdown-toc-itemcountercomponent">ItemCounterComponent</a></li>
      <li><a href="#viewcomponent" id="markdown-toc-viewcomponent">ViewComponent</a></li>
      <li><a href="#updateemailcomponent" id="markdown-toc-updateemailcomponent">UpdateEmailComponent</a></li>
      <li><a href="#storefrontcomponent" id="markdown-toc-storefrontcomponent">StorefrontComponent</a></li>
      <li><a href="#starratingcomponent" id="markdown-toc-starratingcomponent">StarRatingComponent</a></li>
      <li><a href="#cartnotemptyguard" id="markdown-toc-cartnotemptyguard">CartNotEmptyGuard</a></li>
      <li><a href="#notcheckoutauthguard" id="markdown-toc-notcheckoutauthguard">NotCheckoutAuthGuard</a></li>
      <li><a href="#productvariantguard" id="markdown-toc-productvariantguard">ProductVariantGuard</a></li>
      <li><a href="#logoutguard" id="markdown-toc-logoutguard">LogoutGuard</a></li>
      <li><a href="#currentproductservice" id="markdown-toc-currentproductservice">CurrentProductService</a></li>
      <li><a href="#multicartstatepersistenceservice" id="markdown-toc-multicartstatepersistenceservice">MultiCartStatePersistenceService</a></li>
      <li><a href="#productreferenceservice" id="markdown-toc-productreferenceservice">ProductReferenceService</a></li>
      <li><a href="#languageservice" id="markdown-toc-languageservice">LanguageService</a></li>
      <li><a href="#currencyservice" id="markdown-toc-currencyservice">CurrencyService</a></li>
      <li><a href="#occcmscomponentadapter" id="markdown-toc-occcmscomponentadapter">OccCmsComponentAdapter</a></li>
      <li><a href="#userstate" id="markdown-toc-userstate">UserState</a></li>
      <li><a href="#closeaccountmodalcomponent" id="markdown-toc-closeaccountmodalcomponent">CloseAccountModalComponent</a></li>
      <li><a href="#basesitestate" id="markdown-toc-basesitestate">BaseSiteState</a></li>
      <li><a href="#userservice" id="markdown-toc-userservice">UserService</a></li>
      <li><a href="#userorderservice" id="markdown-toc-userorderservice">UserOrderService</a></li>
      <li><a href="#checkout-selectors" id="markdown-toc-checkout-selectors">Checkout selectors</a></li>
      <li><a href="#productlistcomponentservice" id="markdown-toc-productlistcomponentservice">ProductListComponentService</a></li>
      <li><a href="#productcarouselservice" id="markdown-toc-productcarouselservice">ProductCarouselService</a></li>
      <li><a href="#checkoutservice" id="markdown-toc-checkoutservice">CheckoutService</a></li>
      <li><a href="#anonymousconsenttemplatesadapter" id="markdown-toc-anonymousconsenttemplatesadapter">AnonymousConsentTemplatesAdapter</a></li>
      <li><a href="#anonymousconsenttemplatesconnector" id="markdown-toc-anonymousconsenttemplatesconnector">AnonymousConsentTemplatesConnector</a></li>
      <li><a href="#splitviewcomponent" id="markdown-toc-splitviewcomponent">SplitViewComponent</a></li>
      <li><a href="#error-payload-of-load-fail-actions-has-changed-in-spartacuscore" id="markdown-toc-error-payload-of-load-fail-actions-has-changed-in-spartacuscore">Error payload of LOAD FAIL actions has changed in <code class="language-plaintext highlighter-rouge">@spartacus/core</code></a></li>
    </ul>
  </li>
  <li><a href="#automated-migrations-for-version-30" id="markdown-toc-automated-migrations-for-version-30">Automated Migrations for Version 3.0</a></li>
</ul>

<hr />

<h2 id="breaking-changes-introduced-in-30">Breaking Changes Introduced in 3.0</h2>

<h3 id="translations-i18n-changed">Translations (i18n) changed</h3>

<ul>
  <li>fixed the typo in the key <code class="language-plaintext highlighter-rouge">user.register.managementInMyAccount</code> (previously …<code class="language-plaintext highlighter-rouge">managmentInMyAccount</code>)</li>
  <li>key <code class="language-plaintext highlighter-rouge">checkout.checkoutReview.editShippingMethod</code> was removed</li>
  <li>key <code class="language-plaintext highlighter-rouge">checkout.checkoutReview.editPaymentMethod</code> was removed</li>
</ul>

<h3 id="default-router-options-changed">Default router options changed</h3>

<p>The Angular router can be initialized with so-called <code class="language-plaintext highlighter-rouge">ExtraOptions</code> in the <code class="language-plaintext highlighter-rouge">forRoot</code> method of the <code class="language-plaintext highlighter-rouge">RouterModule</code>. For more information, see <a href="https://angular.io/api/router/ExtraOptions">https://angular.io/api/router/ExtraOptions</a>.</p>

<p>The default <code class="language-plaintext highlighter-rouge">ExtraOptions</code> have changed with 3.0. Before 3.0, Spartacus set the <code class="language-plaintext highlighter-rouge">anchorScrolling</code> and <code class="language-plaintext highlighter-rouge">scrollPositionRestoration</code> options. In Spartacus 3.0, the <code class="language-plaintext highlighter-rouge">scrollPositionRestoration</code> was removed, and the <code class="language-plaintext highlighter-rouge">relativeLinkResolution</code> and <code class="language-plaintext highlighter-rouge">initialNavigation</code> have been added. See the following table for the actual values and reasoning:</p>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>&lt; 3.0</th>
      <th>≥ 3.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">anchorScrolling</code></td>
      <td><code class="language-plaintext highlighter-rouge">'enabled'</code></td>
      <td><code class="language-plaintext highlighter-rouge">'enabled'</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">scrollPositionRestoration</code></td>
      <td><code class="language-plaintext highlighter-rouge">'enabled'</code></td>
      <td>(removed)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">relativeLinkResolution</code></td>
      <td>n/a</td>
      <td><code class="language-plaintext highlighter-rouge">'corrected'</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">initialNavigation</code></td>
      <td>n/a</td>
      <td><code class="language-plaintext highlighter-rouge">'enabled'</code></td>
    </tr>
  </tbody>
</table>

<p>The enabled <code class="language-plaintext highlighter-rouge">scrollPositionRestoration</code> was causing a bad experience in most cases, as it would scroll the page to the top on each route change. This is unexpected in a single page experience.</p>

<p>The corrected <code class="language-plaintext highlighter-rouge">relativeLinkResolution</code> is used to opt-in to <a href="https://github.com/angular/angular/issues/37355">a fix</a> that was added in Angular. This will become the default from Angular 11 onwards.</p>

<p>The enabled <code class="language-plaintext highlighter-rouge">initialNavigation</code> provides a better experience with server-side rendering, which starts initial navigation before the root component is created and blocks bootstrap until the initial navigation is complete. For more information, see the <a href="https://angular.io/api/router/InitialNavigation">Angular documentation</a>.</p>

<p>The <code class="language-plaintext highlighter-rouge">RouterModule.forRoot()</code> method can actually be called only <em>once</em> in an Angular application. This makes the default options rather opinionated, which is why the default configurations are carefully selected in Spartacus. The options that have been added or removed can be provided in your custom application with the Angular <code class="language-plaintext highlighter-rouge">ROUTER_CONFIGURATION</code> injection token. The following is an example:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">providers</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">provide</span><span class="p">:</span> <span class="nx">ROUTER_CONFIGURATION</span><span class="p">,</span>
    <span class="na">useValue</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">scrollPositionRestoration</span><span class="p">:</span> <span class="dl">'</span><span class="s1">enabled</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">];</span>
</code></pre></div></div>

<p>There is no automation (schematics) planned for this change.</p>

<h3 id="page-layout">Page Layout</h3>

<p>With version 2.1, we started to add the page layout-based style class to the root element of the application (<code class="language-plaintext highlighter-rouge">cx-storefront</code>). This was done in addition to the style class being added by the <code class="language-plaintext highlighter-rouge">PageLayoutComponent</code>. The style class on the <code class="language-plaintext highlighter-rouge">PageLayoutComponent</code> was considered to be too limited, as it would not affect selectors outside the page template component.</p>

<p>The implementation of the page layout-based style class has moved from the <code class="language-plaintext highlighter-rouge">PageLayoutComponent</code> to the <code class="language-plaintext highlighter-rouge">PageTemplateDirective</code>. This results in a cleaner <code class="language-plaintext highlighter-rouge">PageLayoutComponent</code> with a constructor that no longer requires the lower level <code class="language-plaintext highlighter-rouge">Renderer2</code> service and <code class="language-plaintext highlighter-rouge">ElementRef</code>. The constructor reduces to the following signature:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">constructor</span><span class="p">(</span><span class="k">protected</span> <span class="nx">pageLayoutService</span><span class="p">:</span> <span class="nx">PageLayoutService</span><span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>

<p>We’ve also made the <code class="language-plaintext highlighter-rouge">PageLayoutService</code> a <em>protected</em> argument, so that it is extensible.</p>

<p>There is no automation (schematics) planned to migrate constructors automatically.</p>

<h3 id="static-cms-structure-config-changes">Static CMS structure config changes</h3>

<p>The <code class="language-plaintext highlighter-rouge">default-header-config</code> and <code class="language-plaintext highlighter-rouge">default-cms-content-config</code> have been removed. To create CMS content, use the <code class="language-plaintext highlighter-rouge">defaultCmsContentProviders</code> instead.</p>

<h3 id="occ-prefix">OCC prefix</h3>

<p>The default value for the <code class="language-plaintext highlighter-rouge">backend.occ.prefix</code> configuration option was changed from <code class="language-plaintext highlighter-rouge">/rest/v2/</code> to <code class="language-plaintext highlighter-rouge">/occ/v2/</code>.</p>

<h3 id="storefront-config">Storefront config</h3>

<p>The new config <code class="language-plaintext highlighter-rouge">SeoConfig</code> is imported.</p>

<h3 id="json-ld-schemas">JSON-LD schemas</h3>

<p>To continue using JSON-LD schemas in Spartacus, or to start using JSON-LD schemas in Spartacus, you need to import the <code class="language-plaintext highlighter-rouge">JsonLdBuilderModule</code> to your application.</p>

<h3 id="contentpagemetaresolver">ContentPageMetaResolver</h3>

<p>The <code class="language-plaintext highlighter-rouge">ContentPageMetaResolver</code> has a new required constructor dependency <code class="language-plaintext highlighter-rouge">RoutingPageMetaResolver</code>.</p>

<h3 id="loginformcomponent">LoginFormComponent</h3>

<p>It is no longer the responsibility of the <code class="language-plaintext highlighter-rouge">LoginFormComponent</code> to redirect to the anticipated page (it no longer calls the method <code class="language-plaintext highlighter-rouge">AuthRedirectService.redirect</code>). Now the redirecting logic is placed inside the core <code class="language-plaintext highlighter-rouge">AuthService</code> to support more OAuth flows.</p>

<p>The <code class="language-plaintext highlighter-rouge">LoginFormComponent</code> no longer has the <code class="language-plaintext highlighter-rouge">loginAsGuest</code> and <code class="language-plaintext highlighter-rouge">sub</code> properties, and the <code class="language-plaintext highlighter-rouge">ngOnDestroy</code> method was removed as well.</p>

<h3 id="httpclientmodule-is-not-imported-in-feature-libraries">HttpClientModule is not imported in feature libraries</h3>

<p>In most cases, the <code class="language-plaintext highlighter-rouge">HttpClientModule</code> should only be imported in the root app module, because importing it in lazy-loaded modules can
cause unexpected side effects regarding the visibility of <code class="language-plaintext highlighter-rouge">HTTP_INTERCEPTORS</code>, and so on. To fix this, we removed all <code class="language-plaintext highlighter-rouge">HttpClientModule</code> imports from all of our feature libraries and moved them to recipes.</p>

<p>There is no automation (schematics) planned for this change.</p>

<h3 id="ssr-engine-optimizations">SSR engine optimizations</h3>

<p>The <code class="language-plaintext highlighter-rouge">NgExpressEngineDecorator</code> now adds SSR optimization logic on top of the universal engine by default.</p>

<p>The <code class="language-plaintext highlighter-rouge">NgExpressEngineDecorator</code> was moved from <code class="language-plaintext highlighter-rouge">@spartacus/core</code> to <code class="language-plaintext highlighter-rouge">@spartacus/setup/ssr</code>. Also, the <code class="language-plaintext highlighter-rouge">NgExpressEngineDecorator.get()</code> method now accepts an additional second parameter to fine-tune SSR optimizations. Passing <code class="language-plaintext highlighter-rouge">null</code> there will turn off optimizations by removing the optimization layer completely (which brings back default 2.x behavior).</p>

<h3 id="store-finder-functionality-was-moved-to-a-new-library">Store finder functionality was moved to a new library</h3>

<p>The store finder logic from <code class="language-plaintext highlighter-rouge">@spartacus/core</code> and the store finder components from <code class="language-plaintext highlighter-rouge">@spartacus/storefront</code> were moved to respective entry points in the <code class="language-plaintext highlighter-rouge">@spartacus/storefinder</code> library. Store finder translations (<code class="language-plaintext highlighter-rouge">storeFinderTranslations</code>) and translation chunks (<code class="language-plaintext highlighter-rouge">storeFinderTranslationChunksConfig</code>) were moved to <code class="language-plaintext highlighter-rouge">@spartacus/storefinder/assets</code>.</p>

<p>Store finder functionality is now also lazy-loadable out of the box.</p>

<h3 id="stocknotificationcomponent">StockNotificationComponent</h3>

<p>The <code class="language-plaintext highlighter-rouge">StockNotificationComponent</code> has a new required <code class="language-plaintext highlighter-rouge">UserIdService</code> dependency, but no longer depends on <code class="language-plaintext highlighter-rouge">AuthService</code>.</p>

<h3 id="cmscomponentsservice">CmsComponentsService</h3>

<p>The return type for the <code class="language-plaintext highlighter-rouge">CmsComponentsService.getChildRoutes</code> method has changed from <code class="language-plaintext highlighter-rouge">Route[]</code> to <code class="language-plaintext highlighter-rouge">CmsComponentChildRoutesConfig</code>.</p>

<h3 id="config-cmscomponents">Config cmsComponents</h3>

<p>The <code class="language-plaintext highlighter-rouge">childRoutes</code> property of the <code class="language-plaintext highlighter-rouge">cmsComponents</code> config changed type from <code class="language-plaintext highlighter-rouge">Route[]</code> to <code class="language-plaintext highlighter-rouge">Route[] | CmsComponentChildRoutesConfig</code>.</p>

<h3 id="pagemetaservice-lazy-loading-related-changes">PageMetaService lazy-loading related changes</h3>

<ul>
  <li>The return type for the <code class="language-plaintext highlighter-rouge">PageMetaService.getMeta</code> method changed from <code class="language-plaintext highlighter-rouge">Observable&lt;PageMeta&gt;</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;PageMeta | null&gt;</code> so it can take into account page meta resolvers from lazy-loaded features.</li>
  <li>The return type for the <code class="language-plaintext highlighter-rouge">PageMetaService.getMetaResolver</code> protected method changed from <code class="language-plaintext highlighter-rouge">PageMateResolver</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;PageMetaResolver&gt;</code> so it can take into account page meta resolvers from lazy-loaded features.</li>
  <li>The constructor for <code class="language-plaintext highlighter-rouge">PageMetaService</code> now uses the <code class="language-plaintext highlighter-rouge">UnifiedInjector</code> instead of injecting the <code class="language-plaintext highlighter-rouge">PageMetaResolver</code> token directly.</li>
</ul>

<h3 id="converterservice-lazy-loading-related-changes">ConverterService lazy-loading related changes</h3>

<p>The constructor for <code class="language-plaintext highlighter-rouge">ConverterService</code> now uses the <code class="language-plaintext highlighter-rouge">UnifiedInjector</code> instead of the standard <code class="language-plaintext highlighter-rouge">Injector</code>.</p>

<h3 id="payload-for-constructor-of-placeorder-class-from-checkout-actions-requires-an-additional-property">Payload for constructor of PlaceOrder class from Checkout actions requires an additional property</h3>

<p>The <code class="language-plaintext highlighter-rouge">Checkout.action</code> constructor payload now needs an additional <code class="language-plaintext highlighter-rouge">termsChecked</code> property.</p>

<h3 id="placeordercomponent">PlaceOrderComponent</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">placeOrderSubscription</code> property was removed. There is no replacement.</li>
  <li>The component has the following new, required constructor dependencies: <code class="language-plaintext highlighter-rouge">CheckoutReplenishmentFormService</code>, <code class="language-plaintext highlighter-rouge">LaunchDialogService</code> and <code class="language-plaintext highlighter-rouge">ViewContainerRef</code>.</li>
</ul>

<h3 id="property-renamed-in-searchconfig-interface">Property renamed in SearchConfig interface</h3>

<p>The <code class="language-plaintext highlighter-rouge">sortCode</code> property in the <code class="language-plaintext highlighter-rouge">SearchConfig</code> interface was renamed to <code class="language-plaintext highlighter-rouge">sort</code>.</p>

<h3 id="changes-in-checkoutstepsstate-interface">Changes in CheckoutStepsState interface</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">CheckoutStepsState</code> interface has a new, required property: <code class="language-plaintext highlighter-rouge">poNumber: { po: string; costCenter: string; };</code></li>
  <li>The type for the <code class="language-plaintext highlighter-rouge">orderDetails</code> property was changed from <code class="language-plaintext highlighter-rouge">Order</code> to <code class="language-plaintext highlighter-rouge">Order | ReplenishmentOrder</code></li>
</ul>

<h3 id="changes-in-checkoutstate-interface">Changes in CheckoutState interface</h3>

<p>The <code class="language-plaintext highlighter-rouge">CheckoutState</code> interface has the following new, required properties:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">paymentTypes: PaymentTypesState;</code></li>
  <li><code class="language-plaintext highlighter-rouge">orderType: OrderTypesState;</code></li>
</ul>

<h3 id="outletrefdirective-unregisters-template-on-destroy">OutletRefDirective unregisters template on destroy</h3>

<p>The directive’s template in unregistered from the outlet on directive destroy.</p>

<p>Before v3.0, when an instance of <code class="language-plaintext highlighter-rouge">OutletRefDirective</code> was destroyed (removed from the DOM), its template remained registered for the outlet, which could cause the same template to be rendered multiple times if the same <code class="language-plaintext highlighter-rouge">[cxOutletRef]</code> was created again later on. This has now been fixed.</p>

<h3 id="cartitemcomponent-lost-members">CartItemComponent lost members</h3>

<p>The <code class="language-plaintext highlighter-rouge">@Output()</code> <code class="language-plaintext highlighter-rouge">view</code> and <code class="language-plaintext highlighter-rouge">viewItem()</code> members of the <code class="language-plaintext highlighter-rouge">CartItemComponent</code> have been removed. Use the <code class="language-plaintext highlighter-rouge">[cxModal]</code> directive instead to close modals on link click.</p>

<h3 id="cartitemlistcomponent">CartItemListComponent</h3>

<p>There can be more than one cart entry with the same product code. So now they are referenced by the <code class="language-plaintext highlighter-rouge">entryNumber</code> property instead of the product code in the <code class="language-plaintext highlighter-rouge">CartItemListComponent</code>.</p>

<h3 id="addtocartcomponent">AddToCartComponent</h3>

<p>The <code class="language-plaintext highlighter-rouge">AddToCartComponent</code> lost the following members:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">increment</code> - use the new <code class="language-plaintext highlighter-rouge">numberOfEntriesBeforeAdd</code> instead</li>
  <li><code class="language-plaintext highlighter-rouge">cartEntry$</code> - use <code class="language-plaintext highlighter-rouge">activeCartService.getLastEntry(productCode)</code> instead</li>
</ul>

<h3 id="auth-module-refactor">Auth module refactor</h3>

<p>The <code class="language-plaintext highlighter-rouge">@spartacus/core</code> library has a new dependency on the <code class="language-plaintext highlighter-rouge">angular-oauth2-oidc</code> library. It is used to handle OAuth login and logout flows in Spartacus.</p>

<h4 id="store">Store</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">AuthSelectors</code> were removed. Selectors related to the client token were moved under <code class="language-plaintext highlighter-rouge">ClientAuthSelectors</code>. The user token is no longer stored in NgRx Store. To get the token, use the <code class="language-plaintext highlighter-rouge">AuthStorageService.getToken</code> method.</li>
  <li><code class="language-plaintext highlighter-rouge">StateWithAuth</code> was removed. The state related to the client token was moved to <code class="language-plaintext highlighter-rouge">StateWithClientAuth</code>. Data related to the user token are stored in <code class="language-plaintext highlighter-rouge">AuthStorageService</code> and <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthState</code> was removed. The state related to the client token was moved to <code class="language-plaintext highlighter-rouge">ClientAuthState</code>. Data related to the user token are stored in <code class="language-plaintext highlighter-rouge">AuthStorageService</code> and <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UserTokenState</code> was removed. Data related to the user token are no longer stored in NgRx Store. The user token is stored in <code class="language-plaintext highlighter-rouge">AuthStorageService</code> and the user id is stored in <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">AUTH_FEATURE</code> was removed. The client token state is under the key from the <code class="language-plaintext highlighter-rouge">CLIENT_AUTH_FEATURE</code> variable.</li>
  <li>The value of the <code class="language-plaintext highlighter-rouge">CLIENT_TOKEN_DATA</code> variable changed to <code class="language-plaintext highlighter-rouge">[Client auth] Client Token Data</code>. Previously, it was <code class="language-plaintext highlighter-rouge">[Auth] Client Token Data</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthActions</code> now only contains <code class="language-plaintext highlighter-rouge">Login</code> and <code class="language-plaintext highlighter-rouge">Logout</code> action classes and <code class="language-plaintext highlighter-rouge">LOGIN</code> and <code class="language-plaintext highlighter-rouge">LOGOUT</code> variables with action type. Actions related to the client token (<code class="language-plaintext highlighter-rouge">LoadClientToken...</code>) are now available under <code class="language-plaintext highlighter-rouge">ClientAuthActions</code> export. The <code class="language-plaintext highlighter-rouge">LOGOUT_CUSTOMER_SUPPORT_AGENT</code> constant is available in <code class="language-plaintext highlighter-rouge">AsmActions</code> export. Actions related to the user token were removed (<code class="language-plaintext highlighter-rouge">LOAD_USER_TOKEN</code>, <code class="language-plaintext highlighter-rouge">LOAD_USER_TOKEN_FAIL</code>, <code class="language-plaintext highlighter-rouge">LOAD_USER_TOKEN_SUCCESS</code>, <code class="language-plaintext highlighter-rouge">REFRESH_USER_TOKEN</code>, <code class="language-plaintext highlighter-rouge">REFRESH_USER_TOKEN_FAIL</code>, <code class="language-plaintext highlighter-rouge">REFRESH_USER_TOKEN_SUCCESS</code>, <code class="language-plaintext highlighter-rouge">REVOKE_USER_TOKEN</code>, <code class="language-plaintext highlighter-rouge">REVOKE_USER_TOKEN_FAIL</code>, <code class="language-plaintext highlighter-rouge">REVOKE_USER_TOKEN_SUCCESS</code>, <code class="language-plaintext highlighter-rouge">LoadUserToken</code>, <code class="language-plaintext highlighter-rouge">LoadUserTokenFail</code>, <code class="language-plaintext highlighter-rouge">LoadUserTokenSuccess</code>, <code class="language-plaintext highlighter-rouge">RefreshUserToken</code>, <code class="language-plaintext highlighter-rouge">RefreshUserTokenSuccess</code>, <code class="language-plaintext highlighter-rouge">RefreshUserTokenFail</code>, <code class="language-plaintext highlighter-rouge">RevokeUserToken</code>, <code class="language-plaintext highlighter-rouge">RevokeUserTokenSuccess</code> and <code class="language-plaintext highlighter-rouge">RevokeUserTokenFail</code>). Instead, initialize the user token load, and refresh or revoke with methods exposed in <code class="language-plaintext highlighter-rouge">AuthService</code> and <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService</code>.</li>
</ul>

<h4 id="models">Models</h4>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">UserToken</code> interface was replaced with the <code class="language-plaintext highlighter-rouge">AuthToken</code> interface. The new interface contains different properties from the previous interface in order to match the requirements of the <code class="language-plaintext highlighter-rouge">angular-oauth2-oidc</code> library.</li>
  <li>The <code class="language-plaintext highlighter-rouge">AuthenticationToken</code> interface was removed. Use <code class="language-plaintext highlighter-rouge">AuthToken</code> or <code class="language-plaintext highlighter-rouge">ClientToken</code> directly.</li>
  <li>The <code class="language-plaintext highlighter-rouge">Occ.UserGroupList</code> interface was removed.</li>
  <li>The <code class="language-plaintext highlighter-rouge">Occ.UserSignUp</code> interface was removed.</li>
</ul>

<h4 id="guards">Guards</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">NotAuthGuard</code> now returns <code class="language-plaintext highlighter-rouge">Observable&lt;UrlTree&gt;</code> as the homepage for logged-in users, instead of invoking a redirect. The constructor also changed for this guard. The <code class="language-plaintext highlighter-rouge">RoutingService</code> is no longer needed, but <code class="language-plaintext highlighter-rouge">SemanticPathService</code> and <code class="language-plaintext highlighter-rouge">Router</code> are now required.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthGuard</code> now returns <code class="language-plaintext highlighter-rouge">Observable&lt;UrlTree&gt;</code> as the login page for anonymous users, instead of invoking a redirect. The constructor also changed for this guard. The <code class="language-plaintext highlighter-rouge">RoutingService</code> is no longer needed, but <code class="language-plaintext highlighter-rouge">SemanticPathService</code> is now required.</li>
</ul>

<h4 id="services">Services</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">AuthRedirectService</code> now requires <code class="language-plaintext highlighter-rouge">AuthRedirectStorageService</code>. Please ensure to provide it. It is a replacement for the <code class="language-plaintext highlighter-rouge">redirectUrl</code> private variable.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthService</code> now requires <code class="language-plaintext highlighter-rouge">UserIdService</code>, <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService</code>, <code class="language-plaintext highlighter-rouge">AuthStorageService</code>, <code class="language-plaintext highlighter-rouge">AuthRedirectService</code> and <code class="language-plaintext highlighter-rouge">RoutingService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthService.authorize</code> was renamed to <code class="language-plaintext highlighter-rouge">loginWithCredentials</code>. It returns a Promise that resolves after the login procedure completes. Instead of dispatching an action, the method now invokes the login method from the OAuth library and sets the correct userId, dispatches the <code class="language-plaintext highlighter-rouge">Login</code> action, and redirects to the previously-visited page.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthService.getOccUserId</code> was removed from <code class="language-plaintext highlighter-rouge">AuthService</code>. Use the <code class="language-plaintext highlighter-rouge">UserIdService.getUserId</code> method instead. It is the direct replacement.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthService.invokeWithUserId</code> was moved to <code class="language-plaintext highlighter-rouge">UserIdService</code>. It is available under the same name.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthService.getUserToken</code> was removed. To check if a user is logged in, use <code class="language-plaintext highlighter-rouge">isUserLoggedIn</code>, and to get the user id, use <code class="language-plaintext highlighter-rouge">UserIdService.getUserId</code>. If you need access to tokens, use <code class="language-plaintext highlighter-rouge">AuthStorageService.getToken</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthService.refreshUserToken</code> was moved and renamed to <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService.refreshToken</code>. The behavior changed as well. It not only dispatches actions, but performs a complete token refresh procedure from the OAuth library.</li>
  <li><code class="language-plaintext highlighter-rouge">AuthService.authorizeWithToken</code> was removed. Instead, you can create an object of the shape <code class="language-plaintext highlighter-rouge">AuthToken</code> and pass it to <code class="language-plaintext highlighter-rouge">AuthStorageService.setToken</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">AuthService.logout</code> method changed behavior to redirect to the <code class="language-plaintext highlighter-rouge">logout</code> page. Then the method <code class="language-plaintext highlighter-rouge">AuthService.coreLogout</code> is dispatched and performs operations previously done by the <code class="language-plaintext highlighter-rouge">logout</code> method (Logout action dispatch, clearing local state, revoking tokens).</li>
  <li><code class="language-plaintext highlighter-rouge">AuthService.getClientToken</code>, <code class="language-plaintext highlighter-rouge">AuthService.refreshClientToken</code> and <code class="language-plaintext highlighter-rouge">AuthService.isClientTokenLoaded</code> were moved to <code class="language-plaintext highlighter-rouge">ClientTokenService</code>.</li>
</ul>

<h4 id="config">Config</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">AuthConfig</code> no longer extends <code class="language-plaintext highlighter-rouge">OccConfig</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">login</code> and <code class="language-plaintext highlighter-rouge">revoke</code> endpoints were removed from <code class="language-plaintext highlighter-rouge">OccConfig</code>. The <code class="language-plaintext highlighter-rouge">login</code> endpoint is now available under the <code class="language-plaintext highlighter-rouge">tokenEndpoint</code> property in <code class="language-plaintext highlighter-rouge">AuthConfig</code>. The <code class="language-plaintext highlighter-rouge">revoke</code> endpoint is available under the <code class="language-plaintext highlighter-rouge">revokeEndpoint</code> property in <code class="language-plaintext highlighter-rouge">AuthConfig</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">storageSync</code> configuration for the <code class="language-plaintext highlighter-rouge">auth</code> branch in NgRx Store was removed. The state of the token and userId is now synchronized with <code class="language-plaintext highlighter-rouge">AuthStatePersistenceService</code>. Override this service if you want to sync more properties to <code class="language-plaintext highlighter-rouge">localStorage</code> (for example, <code class="language-plaintext highlighter-rouge">refresh_token</code>).</li>
  <li>The <code class="language-plaintext highlighter-rouge">storageSync</code> configuration for the <code class="language-plaintext highlighter-rouge">anonymous-consents</code> branch in NgRx Store was removed. The state is now synchronized with <code class="language-plaintext highlighter-rouge">AnonymousConsentsStatePersistenceService</code>. Override this service if you want to sync more or less properties to <code class="language-plaintext highlighter-rouge">localStorage</code>.</li>
</ul>

<h3 id="kymamodule">KymaModule</h3>

<p>The <code class="language-plaintext highlighter-rouge">KymaModule</code> was removed with all its code. We expose the same functionality through configuration of auth.</p>

<p>To fetch the <code class="language-plaintext highlighter-rouge">OpenId</code> token along with the access token in Resource Owner Password Flow, you have to use following configuration:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">authentication</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">client_id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">client4kyma</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">client_secret</span><span class="p">:</span> <span class="dl">'</span><span class="s1">secret</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">OAuthLibConfig</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">responseType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">id_token</span><span class="dl">'</span><span class="p">,</span>
    <span class="nx">scope</span><span class="p">:</span> <span class="dl">'</span><span class="s1">openid</span><span class="dl">'</span><span class="p">,</span>
    <span class="nx">customTokenParameters</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">token_type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">id_token</span><span class="dl">'</span><span class="p">],</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Then you can access the <code class="language-plaintext highlighter-rouge">OpenId</code> token with the <code class="language-plaintext highlighter-rouge">OAuthLibWrapperService.getIdToken</code> method. For more options related to the <code class="language-plaintext highlighter-rouge">OpenId</code> token, look into the <code class="language-plaintext highlighter-rouge">angular-oauth2-oidc</code> <a href="https://github.com/manfredsteyer/angular-oauth2-oidc">library documentation</a>.</p>

<h3 id="asm-module-refactor">ASM module refactor</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">getCustomerSupportAgentTokenState</code>, <code class="language-plaintext highlighter-rouge">getCustomerSupportAgentToken</code> and <code class="language-plaintext highlighter-rouge">getCustomerSupportAgentTokenLoading</code> were removed from <code class="language-plaintext highlighter-rouge">AsmSelectors</code>. To get a token, use <code class="language-plaintext highlighter-rouge">AuthStorageService.getToken</code> and <code class="language-plaintext highlighter-rouge">AsmAuthStorageService.getTokenTarget</code> to check if it belongs to the CS agent.</li>
  <li>Effects in <code class="language-plaintext highlighter-rouge">AsmModule</code> now use <code class="language-plaintext highlighter-rouge">normalizeHttpError</code> instead of <code class="language-plaintext highlighter-rouge">makeErrorSerializable</code> for error transformation.</li>
  <li>The <code class="language-plaintext highlighter-rouge">storageSync</code> configuration for the <code class="language-plaintext highlighter-rouge">asm</code> branch in NgRx Store was removed. The state of the ASM UI and tokens is now synchronized with <code class="language-plaintext highlighter-rouge">AsmStatePersistenceService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">CSAGENT_TOKEN_DATA</code> variable was removed.</li>
  <li>The <code class="language-plaintext highlighter-rouge">AsmState.csagentToken</code> was removed. The token is now stored in <code class="language-plaintext highlighter-rouge">AuthStorageService</code>. Check <code class="language-plaintext highlighter-rouge">AsmAuthStorageService.getTokenTarget</code> to validate if the token belongs to the CS agent.</li>
  <li><code class="language-plaintext highlighter-rouge">AsmActions</code> no longer contains actions related to the customer agent token (<code class="language-plaintext highlighter-rouge">LoadCustomerSupportAgentToken</code>, <code class="language-plaintext highlighter-rouge">LoadCustomerSupportAgentTokenFail</code>, <code class="language-plaintext highlighter-rouge">LoadCustomerSupportAgentTokenSuccess</code>). Instead, interact directly with <code class="language-plaintext highlighter-rouge">CsAgentAuthService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">CustomerSupportAgentTokenInterceptor</code> interceptor was removed. Token and error handling for CS agent requests are now handled by <code class="language-plaintext highlighter-rouge">AuthInterceptor</code> and <code class="language-plaintext highlighter-rouge">AsmAuthHttpHeaderService</code>.</li>
</ul>

<h4 id="asmauthservice">AsmAuthService</h4>

<p>The <code class="language-plaintext highlighter-rouge">AsmAuthService</code> was renamed to <code class="language-plaintext highlighter-rouge">CsAgentAuthService</code>. This service is now responsible for making the <code class="language-plaintext highlighter-rouge">AuthService</code> aware of ASM, and adjusts it for CS agent support.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">AsmAuthService.authorizeCustomerSupportAgent</code> was moved to <code class="language-plaintext highlighter-rouge">CsAgentAuthService</code>. It now performs full login flow for the CS agent and resolves when it completes.</li>
  <li><code class="language-plaintext highlighter-rouge">AsmAuthService.startCustomerEmulationSession</code> was moved to <code class="language-plaintext highlighter-rouge">CsAgentAuthService</code>. Behavior has not changed.</li>
  <li><code class="language-plaintext highlighter-rouge">AsmAuthService.isCustomerEmulationToken</code> was removed. To check the token, use <code class="language-plaintext highlighter-rouge">AuthStorageService.getToken</code>, and to check if it belongs to the CS agent, use <code class="language-plaintext highlighter-rouge">AsmAuthStorageService.getTokenTarget</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">AsmAuthService.getCustomerSupportAgentToken</code> was removed. To check the token, use <code class="language-plaintext highlighter-rouge">AuthStorageService.getToken</code> and to check if it belongs to the CS agent, use <code class="language-plaintext highlighter-rouge">AsmAuthStorageService.getTokenTarget</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">AsmAuthService.getCustomerSupportAgentTokenLoading</code> was moved to <code class="language-plaintext highlighter-rouge">CsAgentAuthService</code>. <strong>Note:</strong> It is not implemented there yet.</li>
  <li><code class="language-plaintext highlighter-rouge">AsmAuthService.logoutCustomerSupportAgent</code> was moved to <code class="language-plaintext highlighter-rouge">CsAgentAuthService</code>. It performs the logout procedure for the CS agent and resolves when it completes.</li>
</ul>

<h3 id="cdc-library">CDC library</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">CdcUserTokenEffects</code> now uses <code class="language-plaintext highlighter-rouge">normalizeHttpError</code> for error serialization.</li>
  <li>The <code class="language-plaintext highlighter-rouge">CdcUserTokenEffects.loadCdcUserToken$</code> effect now calls <code class="language-plaintext highlighter-rouge">CdcAuthService.loginWithToken</code> instead of dispatching <code class="language-plaintext highlighter-rouge">AuthActions.LoadUserTokenSuccess</code> action.</li>
  <li><code class="language-plaintext highlighter-rouge">CdcAuthService</code> no longer extends <code class="language-plaintext highlighter-rouge">AuthService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CdcAuthService</code> has the following new, required dependencies: <code class="language-plaintext highlighter-rouge">AuthStorageService</code>, <code class="language-plaintext highlighter-rouge">UserIdService</code>, <code class="language-plaintext highlighter-rouge">GlobalMessageService</code> and <code class="language-plaintext highlighter-rouge">AuthRedirectService</code> need to provided.</li>
  <li>The <code class="language-plaintext highlighter-rouge">CdcAuthService.authorizeWithCustomCdcFlow</code> method was renamed to <code class="language-plaintext highlighter-rouge">loginWithCustomCdcFlow</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">CdcAuthService.logout</code> method was removed. Now CDC hooks into the logout process by providing <code class="language-plaintext highlighter-rouge">CdcLogoutGuard</code> as <code class="language-plaintext highlighter-rouge">LogoutGuard</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CdcJsService</code> now requires <code class="language-plaintext highlighter-rouge">AuthService</code> because <code class="language-plaintext highlighter-rouge">CdcAuthService</code> no longer extends it. <code class="language-plaintext highlighter-rouge">AuthService</code> should be passed after <code class="language-plaintext highlighter-rouge">CdcAuthService</code>. <code class="language-plaintext highlighter-rouge">CdcAuthService</code> is available in the service under <code class="language-plaintext highlighter-rouge">cdcAuth</code> and <code class="language-plaintext highlighter-rouge">AuthService</code> is available under the <code class="language-plaintext highlighter-rouge">auth</code> property. Additionally, <code class="language-plaintext highlighter-rouge">GlobalMessageService</code> and <code class="language-plaintext highlighter-rouge">AuthRedirectService</code> are not longer required. Note that we do not provide automatic migration for that constructor change.</li>
</ul>

<h3 id="orderdetailheadlinecomponent">OrderDetailHeadlineComponent</h3>

<p>The <code class="language-plaintext highlighter-rouge">OrderDetailHeadlineComponent</code> was removed.</p>

<h3 id="orderdetailshippingcomponent">OrderDetailShippingComponent</h3>

<p>The following functions have been removed from the <code class="language-plaintext highlighter-rouge">OrderDetailShippingComponent</code> component:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">getAddressCardContent()</code></li>
  <li><code class="language-plaintext highlighter-rouge">getBillingAddressCardContent()</code></li>
  <li><code class="language-plaintext highlighter-rouge">getPaymentCardContent()</code></li>
  <li><code class="language-plaintext highlighter-rouge">getShippingMethodCardContent()</code></li>
</ul>

<p>You can use the <code class="language-plaintext highlighter-rouge">OrderOverviewComponent</code> instead.</p>

<h3 id="orderconfirmationoverviewcomponent">OrderConfirmationOverviewComponent</h3>

<p>The following functions have been removed from the <code class="language-plaintext highlighter-rouge">OrderConfirmationOverviewComponent</code> component:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">getAddressCardContent()</code></li>
  <li><code class="language-plaintext highlighter-rouge">getDeliveryModeCardContent()</code></li>
  <li><code class="language-plaintext highlighter-rouge">getPaymentInfoCardContent()</code></li>
  <li><code class="language-plaintext highlighter-rouge">getBillingAddressCardContent()</code></li>
</ul>

<p>The return type for <code class="language-plaintext highlighter-rouge">order$</code> was changed from <code class="language-plaintext highlighter-rouge">Observable&lt;Order&gt;</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;any&gt;</code>.</p>

<h3 id="basesiteservice">BaseSiteService</h3>

<p>The <code class="language-plaintext highlighter-rouge">BaseSiteService</code> type is changed from <code class="language-plaintext highlighter-rouge">BaseSiteService implements SiteContext&lt;string&gt;</code> to <code class="language-plaintext highlighter-rouge">BaseSiteService implements SiteContext&lt;BaseSite&gt;</code>.</p>

<p>The return type of the <code class="language-plaintext highlighter-rouge">getAll()</code> function is changed from <code class="language-plaintext highlighter-rouge">getAll(): Observable&lt;string[]&gt;</code> to <code class="language-plaintext highlighter-rouge">getAll(): Observable&lt;BaseSite[]&gt;</code>.</p>

<p>The return type of the <code class="language-plaintext highlighter-rouge">setActive(baseSite: string)</code> function is changed from <code class="language-plaintext highlighter-rouge">setActive(baseSite: string): Subscription</code> to <code class="language-plaintext highlighter-rouge">setActive(baseSite: string): void</code>.</p>

<h3 id="configinitializerservice-constructor">ConfigInitializerService constructor</h3>

<p>An additional parameter was added to the <code class="language-plaintext highlighter-rouge">ConfigInitializerService</code> constructor. Before 3.0, it was the following:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">Config</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">config</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">Optional</span><span class="p">()</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">CONFIG_INITIALIZER_FORROOT_GUARD</span><span class="p">)</span>
    <span class="k">protected</span> <span class="nx">initializerGuard</span>
  <span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>

<p>In Spartacus 3.0, it is the following:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">Config</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">config</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">Optional</span><span class="p">()</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">CONFIG_INITIALIZER_FORROOT_GUARD</span><span class="p">)</span>
    <span class="k">protected</span> <span class="nx">initializerGuard</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">RootConfig</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">rootConfig</span><span class="p">:</span> <span class="kr">any</span>
</code></pre></div></div>

<h3 id="cmscomponentsservice-constructor">CmsComponentsService constructor</h3>

<p>An additional parameter was added to the <code class="language-plaintext highlighter-rouge">CmsComponentsService</code> constructor. Before 3.0, it was the following:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">config</span><span class="p">:</span> <span class="nx">CmsConfig</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">PLATFORM_ID</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">platformId</span><span class="p">:</span> <span class="nb">Object</span>
  <span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>

<p>In Spartacus 3.0, it is the following:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">config</span><span class="p">:</span> <span class="nx">CmsConfig</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">PLATFORM_ID</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">platformId</span><span class="p">:</span> <span class="nb">Object</span><span class="p">,</span>
    <span class="k">protected</span> <span class="nx">featureModules</span><span class="p">?:</span> <span class="nx">FeatureModulesService</span>
  <span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>

<h4 id="the-configurationfactory-was-removed">The configurationFactory was removed</h4>

<p>The configuration merging logic now uses separate tokens for the default configuration and the user configuration.</p>

<h3 id="checkoutprogressmobilebottomcomponent">CheckoutProgressMobileBottomComponent</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">routerState$</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">activeStepUrl</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">steps</code> property was removed. Use <code class="language-plaintext highlighter-rouge">steps$</code> instead.</li>
</ul>

<h3 id="checkoutprogressmobiletopcomponent">CheckoutProgressMobileTopComponent</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">routerState$</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">activeStepUrl</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">steps</code> property was removed. Use <code class="language-plaintext highlighter-rouge">steps$</code> instead.</li>
</ul>

<h3 id="checkoutprogresscomponent">CheckoutProgressComponent</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">routerState$</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">activeStepUrl</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">steps</code> property was removed. Use <code class="language-plaintext highlighter-rouge">steps$</code> instead.</li>
</ul>

<h3 id="deliverymodecomponent">DeliveryModeComponent</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">checkoutStepUrlNext</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">checkoutStepUrlPrevious</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">currentDeliveryModeId</code> property was removed. The current delivery mode selection is stored in a form called “mode” in the “deliveryModeId” input field. Also, you can use <code class="language-plaintext highlighter-rouge">CheckoutDeliveryService.getSelectedDeliveryMode()</code> to access the selected delivery mode in the checkout state.</li>
  <li>The <code class="language-plaintext highlighter-rouge">supportedDeliveryModes$</code> property was modified. This observable will now only emit when the data in the list of supported delivery modes changes.</li>
  <li>The <code class="language-plaintext highlighter-rouge">next()</code> function does not update the delivery mode on the cart because the delivery mode is already updated on the cart when the component initializes, and when a choice is made in the delivery mode form.</li>
</ul>

<h3 id="paymentmethodcomponent">PaymentMethodComponent</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">checkoutStepUrlNext</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">checkoutStepUrlPrevious</code> property was removed. This logic is now handled by <code class="language-plaintext highlighter-rouge">checkoutStepService</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">goNext</code> method was renamed to <code class="language-plaintext highlighter-rouge">next</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">goPrevious</code> method was renamed to <code class="language-plaintext highlighter-rouge">back</code>.</li>
</ul>

<h3 id="shippingaddresscomponent">ShippingAddressComponent</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">existingAddresses$</code> property was removed.</li>
  <li>The <code class="language-plaintext highlighter-rouge">newAddressFormManuallyOpened</code> property was renamed to <code class="language-plaintext highlighter-rouge">addressFormOpened</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">goNext</code> method was renamed to <code class="language-plaintext highlighter-rouge">next</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">goPrevious</code> method was renamed to <code class="language-plaintext highlighter-rouge">back</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">ShippingAddressComponent</code> now implements <code class="language-plaintext highlighter-rouge">OnDestroy</code>.</li>
</ul>

<h3 id="checkoutauthguard">CheckoutAuthGuard</h3>

<p>The <code class="language-plaintext highlighter-rouge">canActivate</code> method now returns the type <code class="language-plaintext highlighter-rouge">Observable&lt;boolean | UrlTree</code>.</p>

<h3 id="checkoutconfigservice">CheckoutConfigService</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">steps</code> property was removed. Use <code class="language-plaintext highlighter-rouge">checkoutStepService</code> instead.</li>
  <li>The <code class="language-plaintext highlighter-rouge">checkoutStepService</code> method was removed. Use the <code class="language-plaintext highlighter-rouge">checkoutStepRoute</code> method in <code class="language-plaintext highlighter-rouge">checkoutStepService</code> instead.</li>
  <li>The <code class="language-plaintext highlighter-rouge">getFirstCheckoutStepRoute</code> method was removed. Use the <code class="language-plaintext highlighter-rouge">getFirstCheckoutStepRoute</code> method in <code class="language-plaintext highlighter-rouge">checkoutStepService</code> instead.</li>
  <li>The <code class="language-plaintext highlighter-rouge">getFirstCheckoutStepRoute</code> method was removed. Use the <code class="language-plaintext highlighter-rouge">getFirstCheckoutStepRoute</code> method in <code class="language-plaintext highlighter-rouge">checkoutStepService</code> instead.</li>
  <li>The <code class="language-plaintext highlighter-rouge">getNextCheckoutStepUrl</code> method was removed. Use the <code class="language-plaintext highlighter-rouge">getNextCheckoutStepUrl</code> method in <code class="language-plaintext highlighter-rouge">checkoutStepService</code> instead.</li>
  <li>The <code class="language-plaintext highlighter-rouge">getPreviousCheckoutStepUrl</code> method was removed. Use the <code class="language-plaintext highlighter-rouge">getPreviousCheckoutStepUrl</code> method in <code class="language-plaintext highlighter-rouge">checkoutStepService</code> instead.</li>
  <li>The <code class="language-plaintext highlighter-rouge">getCurrentStepIndex</code> method was removed. Use the <code class="language-plaintext highlighter-rouge">getCurrentStepIndex</code> method in <code class="language-plaintext highlighter-rouge">checkoutStepService</code> instead.</li>
  <li>The <code class="language-plaintext highlighter-rouge">CheckoutConfigService</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingConfigService</code>.</li>
</ul>

<h3 id="the-placeorder-method-for-checkoutadapter-occcheckoutadapter-and-checkoutconnector">The placeOrder method for CheckoutAdapter, OccCheckoutAdapter and CheckoutConnector</h3>

<p>The <code class="language-plaintext highlighter-rouge">placeOrder</code> method for <code class="language-plaintext highlighter-rouge">CheckoutAdapter</code>, <code class="language-plaintext highlighter-rouge">OccCheckoutAdapter</code> and <code class="language-plaintext highlighter-rouge">CheckoutConnector</code> now has a new, third, required argument: <code class="language-plaintext highlighter-rouge">termsChecked: boolean</code>.</p>

<h3 id="breakpointservice">BreakpointService</h3>

<ul>
  <li>The public <code class="language-plaintext highlighter-rouge">window()</code> getter method was removed. Instead, you can directly reference the <code class="language-plaintext highlighter-rouge">windowRef</code>.</li>
  <li>The protected <code class="language-plaintext highlighter-rouge">getClosest</code> method was removed. Instead, use the <code class="language-plaintext highlighter-rouge">getBreakpoint</code> method.</li>
  <li>The <code class="language-plaintext highlighter-rouge">_breakpoints</code> property was removed.</li>
  <li>The public <code class="language-plaintext highlighter-rouge">breakpoint$</code> getter was removed. Instead, use the <code class="language-plaintext highlighter-rouge">breakpoint$</code> property.</li>
  <li>The <code class="language-plaintext highlighter-rouge">BreakpointService</code> has a new, required <code class="language-plaintext highlighter-rouge">platform</code> dependency.</li>
</ul>

<h3 id="protectedroutesguard">ProtectedRoutesGuard</h3>

<p>The return type of the <code class="language-plaintext highlighter-rouge">ProtectedRoutesGuard.canActivate</code> method changed from <code class="language-plaintext highlighter-rouge">Observable&lt;boolean&gt;</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;boolean | UrlTree&gt;</code>.</p>

<h3 id="itemcountercomponent">ItemCounterComponent</h3>

<p>The <code class="language-plaintext highlighter-rouge">ItemCounterComponent</code> component now implements <code class="language-plaintext highlighter-rouge">OnInit</code> and <code class="language-plaintext highlighter-rouge">OnDestroy</code>.</p>

<h3 id="viewcomponent">ViewComponent</h3>

<p>The protected <code class="language-plaintext highlighter-rouge">splitViewCount</code> getter method was removed.</p>

<h3 id="updateemailcomponent">UpdateEmailComponent</h3>

<p>The return type of the <code class="language-plaintext highlighter-rouge">onSuccess</code> method was changed from <code class="language-plaintext highlighter-rouge">void</code> to <code class="language-plaintext highlighter-rouge">Promise&lt;void&gt;</code> in order to wait for the logout to complete before updating the email.</p>

<h3 id="storefrontcomponent">StorefrontComponent</h3>

<p>The param type of the <code class="language-plaintext highlighter-rouge">collapseMenuIfClickOutside</code> method was changed from <code class="language-plaintext highlighter-rouge">MouseEvent</code> to <code class="language-plaintext highlighter-rouge">any</code>. The behavior has also been modified to only trigger when the header element is passed to the function.</p>

<h3 id="starratingcomponent">StarRatingComponent</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">StarRatingComponent</code> uses <code class="language-plaintext highlighter-rouge">HostBinding</code> to bind to CSS custom properties (available since angular 9), which is why we no longer need the <code class="language-plaintext highlighter-rouge">ElementRef</code> and <code class="language-plaintext highlighter-rouge">Renderer2</code> in the constructor. There is an automated constructor migration added for the 3.0 release.</li>
  <li><code class="language-plaintext highlighter-rouge">ngOnInit</code> is no longer used.</li>
  <li>The <code class="language-plaintext highlighter-rouge">setRate</code> no longer requires a second argument (<code class="language-plaintext highlighter-rouge">force</code>).</li>
  <li>The <code class="language-plaintext highlighter-rouge">setRateOnEvent()</code> method is replaced by reusing the <code class="language-plaintext highlighter-rouge">setRate()</code> (which also fixes a bug). We now bind <code class="language-plaintext highlighter-rouge">keydown.space</code> directly from the view. The more generic <code class="language-plaintext highlighter-rouge">keydown</code> output binding was removed.</li>
</ul>

<h3 id="cartnotemptyguard">CartNotEmptyGuard</h3>

<ul>
  <li>The return type of the <code class="language-plaintext highlighter-rouge">canActivate</code> method was changed from <code class="language-plaintext highlighter-rouge">Observable&lt;boolean&gt;</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;boolean | UrlTree&gt;</code> to support OAuth flows.</li>
  <li><code class="language-plaintext highlighter-rouge">SemanticPathService</code> is a new, required constructor dependency.</li>
  <li><code class="language-plaintext highlighter-rouge">Router</code> is new, required constructor dependency.</li>
  <li><code class="language-plaintext highlighter-rouge">CartNotEmptyGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">Router</code> and <code class="language-plaintext highlighter-rouge">SemanticPathService</code>.</li>
</ul>

<h3 id="notcheckoutauthguard">NotCheckoutAuthGuard</h3>

<p>The return type of the <code class="language-plaintext highlighter-rouge">canActivate</code> method was changed from <code class="language-plaintext highlighter-rouge">Observable&lt;boolean&gt;</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;boolean | UrlTree&gt;</code> to support OAuth flows.</p>

<h3 id="productvariantguard">ProductVariantGuard</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">canActivate</code> method now requires a parameter of type <code class="language-plaintext highlighter-rouge">ActivatedRouteSnapshot</code>.</li>
</ul>

<h3 id="logoutguard">LogoutGuard</h3>

<ul>
  <li>The return type of the <code class="language-plaintext highlighter-rouge">canActivate</code> method was changed from <code class="language-plaintext highlighter-rouge">Observable&lt;boolean&gt;</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;boolean | UrlTree&gt;</code> to support OAuth flows.</li>
  <li>The return type of the <code class="language-plaintext highlighter-rouge">logout</code> method was changed from <code class="language-plaintext highlighter-rouge">void</code> to <code class="language-plaintext highlighter-rouge">Promise&lt;any&gt;</code> to support OAuth flows.</li>
  <li>The <code class="language-plaintext highlighter-rouge">redirect</code> method was removed. Use <code class="language-plaintext highlighter-rouge">getRedirectUrl</code> instead.</li>
</ul>

<h3 id="currentproductservice">CurrentProductService</h3>

<p>The <code class="language-plaintext highlighter-rouge">getProduct</code> method now only emits distinct products.</p>

<h3 id="multicartstatepersistenceservice">MultiCartStatePersistenceService</h3>

<p>The <code class="language-plaintext highlighter-rouge">sync</code> method was renamed to <code class="language-plaintext highlighter-rouge">initSync</code>.</p>

<h3 id="productreferenceservice">ProductReferenceService</h3>

<p>The <code class="language-plaintext highlighter-rouge">get</code> method was removed. Use the <code class="language-plaintext highlighter-rouge">getProductReferences</code> and <code class="language-plaintext highlighter-rouge">loadProductReferences</code> methods instead.</p>

<h3 id="languageservice">LanguageService</h3>

<p>The return type of the <code class="language-plaintext highlighter-rouge">setActive</code> method was changed from <code class="language-plaintext highlighter-rouge">Subscription</code> to <code class="language-plaintext highlighter-rouge">void</code>.</p>

<h3 id="currencyservice">CurrencyService</h3>

<p>The return type of the <code class="language-plaintext highlighter-rouge">setActive</code> method was changed from <code class="language-plaintext highlighter-rouge">Subscription</code> to <code class="language-plaintext highlighter-rouge">void</code>.</p>

<h3 id="occcmscomponentadapter">OccCmsComponentAdapter</h3>

<p>The OCC CMS component API in SAP Commerce Cloud before version 1905 was using a POST method. This was changed in 1905 to use a GET method instead. Spartacus has supported both version from version 1.0 by using a <code class="language-plaintext highlighter-rouge">legacy</code> flag to distinguish this back end API behavior. With the release of Spartacus 3.0, we maintain the support for the pre-1905 CMS component API, but the implementation was moved to a separate adapter (<code class="language-plaintext highlighter-rouge">LegacyOccCmsComponentAdapter</code>). With that change, we are also dropping the <code class="language-plaintext highlighter-rouge">legacy</code> flag in the OCC configuration.</p>

<h3 id="userstate">UserState</h3>

<p>The interface for the <code class="language-plaintext highlighter-rouge">UserState</code> NgRx state now has the following new, required properties: <code class="language-plaintext highlighter-rouge">replenishmentOrders</code>, <code class="language-plaintext highlighter-rouge">replenishmentOrder</code> and <code class="language-plaintext highlighter-rouge">costCenters</code>.</p>

<h3 id="closeaccountmodalcomponent">CloseAccountModalComponent</h3>

<p>The <code class="language-plaintext highlighter-rouge">userToken$</code> property of the <code class="language-plaintext highlighter-rouge">CloseAccountModalComponent</code> was replaced with <code class="language-plaintext highlighter-rouge">isLoggedIn$</code> of type <code class="language-plaintext highlighter-rouge">Observable&lt;boolean&gt;</code>.</p>

<h3 id="basesitestate">BaseSiteState</h3>

<p>The <code class="language-plaintext highlighter-rouge">BaseSiteState</code> interface has now a new, required <code class="language-plaintext highlighter-rouge">entities: BaseSiteEntities</code> property.</p>

<h3 id="userservice">UserService</h3>

<p>The <code class="language-plaintext highlighter-rouge">loadOrderList</code> method of the <code class="language-plaintext highlighter-rouge">UserService</code> also loads replenishment orders when the URL contains a replenishment code.</p>

<h3 id="userorderservice">UserOrderService</h3>

<p>The <code class="language-plaintext highlighter-rouge">getTitles</code> method of the <code class="language-plaintext highlighter-rouge">UserOrderService</code> will load titles when it is empty.</p>

<h3 id="checkout-selectors">Checkout selectors</h3>

<p>The <code class="language-plaintext highlighter-rouge">MemoizedSelector</code> return type of the <code class="language-plaintext highlighter-rouge">getCheckoutOrderDetails</code> selector was changed from <code class="language-plaintext highlighter-rouge">Order</code> to <code class="language-plaintext highlighter-rouge">Order | ReplenishmentOrder</code>.</p>

<h3 id="productlistcomponentservice">ProductListComponentService</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">sub</code> property was removed from <code class="language-plaintext highlighter-rouge">ProductListComponentService</code>. It is no longer used.</li>
  <li>The <code class="language-plaintext highlighter-rouge">setQuery</code> method was removed from <code class="language-plaintext highlighter-rouge">ProductListComponentService</code>. It is no longer used.</li>
  <li>The <code class="language-plaintext highlighter-rouge">viewPage</code> method was removed from <code class="language-plaintext highlighter-rouge">ProductListComponentService</code>. It is no longer used.</li>
</ul>

<h3 id="productcarouselservice">ProductCarouselService</h3>

<p>The <code class="language-plaintext highlighter-rouge">getProductReferences()</code> function was removed.</p>

<h3 id="checkoutservice">CheckoutService</h3>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">placeOrder</code> method of the <code class="language-plaintext highlighter-rouge">CheckoutService</code> now requires a <code class="language-plaintext highlighter-rouge">termsChecked</code> parameter.</li>
  <li>The return type of the <code class="language-plaintext highlighter-rouge">getOrderDetails</code> method was changed from <code class="language-plaintext highlighter-rouge">Observable&lt;Order&gt;</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;Order | ReplenishmentOrder&gt;</code>.</li>
</ul>

<h3 id="anonymousconsenttemplatesadapter">AnonymousConsentTemplatesAdapter</h3>

<p>The <code class="language-plaintext highlighter-rouge">loadAnonymousConsents</code> method of <code class="language-plaintext highlighter-rouge">AnonymousConsentTemplatesAdapter</code> is no longer optional.</p>

<h3 id="anonymousconsenttemplatesconnector">AnonymousConsentTemplatesConnector</h3>

<p>The return type of the <code class="language-plaintext highlighter-rouge">loadAnonymousConsents</code> method of the <code class="language-plaintext highlighter-rouge">AnonymousConsentTemplatesConnector</code> was changed from <code class="language-plaintext highlighter-rouge">Observable&lt;AnonymousConsent[] | null&gt;</code> to <code class="language-plaintext highlighter-rouge">Observable&lt;AnonymousConsent[]&gt;</code>.</p>

<h3 id="splitviewcomponent">SplitViewComponent</h3>

<p>The <code class="language-plaintext highlighter-rouge">subscription</code> property of the <code class="language-plaintext highlighter-rouge">SplitViewComponent</code> is no longer protected. It is private now.</p>

<h3 id="error-payload-of-load-fail-actions-has-changed-in-spartacuscore">Error payload of LOAD FAIL actions has changed in <code class="language-plaintext highlighter-rouge">@spartacus/core</code></h3>

<p>It now has a consistent shape of <code class="language-plaintext highlighter-rouge">HttpErrorModel</code> or is <code class="language-plaintext highlighter-rouge">undefined</code>.</p>

<h2 id="automated-migrations-for-version-30">Automated Migrations for Version 3.0</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">CheckoutProgressMobileBottomComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfig</code>, <code class="language-plaintext highlighter-rouge">RoutingService</code> and <code class="language-plaintext highlighter-rouge">RoutingConfigService</code>. The use of these services was replaced with the corresponding methods from the <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to the <code class="language-plaintext highlighter-rouge">CheckoutProgressMobileBottomComponent</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CheckoutAuthGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">Router</code> and <code class="language-plaintext highlighter-rouge">SemanticPathService</code>. The additional <code class="language-plaintext highlighter-rouge">UserService</code> and <code class="language-plaintext highlighter-rouge">GlobalMessageService</code> services also need to be provided to <code class="language-plaintext highlighter-rouge">CheckoutAuthGuard</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CheckoutProgressMobileTopComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfig</code>, <code class="language-plaintext highlighter-rouge">RoutingService</code> and <code class="language-plaintext highlighter-rouge">RoutingConfigService</code>. The use of these services was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to <code class="language-plaintext highlighter-rouge">CheckoutProgressMobileTopComponent</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CheckoutProgressComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfig</code>, <code class="language-plaintext highlighter-rouge">RoutingService</code> and <code class="language-plaintext highlighter-rouge">RoutingConfigService</code>. The use of these services was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to <code class="language-plaintext highlighter-rouge">CheckoutProgressComponent</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">DeliveryModeSetGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfigService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to <code class="language-plaintext highlighter-rouge">DeliveryModeSetGuard</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">DeliveryModeComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to <code class="language-plaintext highlighter-rouge">DeliveryModeComponent</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">LoginFormComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">ActivatedRoute</code>, <code class="language-plaintext highlighter-rouge">CheckoutConfigService</code> and <code class="language-plaintext highlighter-rouge">AuthRedirectService</code>. The logic that used these services was moved to a different component.</li>
  <li><code class="language-plaintext highlighter-rouge">OrderDetailShippingComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">TranslationService</code>. The logic that used this service was moved to <code class="language-plaintext highlighter-rouge">OrderDetailShippingComponent</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">PaymentDetailsSetGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfigService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to <code class="language-plaintext highlighter-rouge">PaymentDetailsSetGuard</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">PaymentMethodComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfigService</code> and <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of these services was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to <code class="language-plaintext highlighter-rouge">PaymentMethodComponent</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">ReviewSubmitComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfigService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. In addition, <code class="language-plaintext highlighter-rouge">PaymentTypeService</code>, <code class="language-plaintext highlighter-rouge">CheckoutCostCenterService</code> and <code class="language-plaintext highlighter-rouge">UserCostCenterService</code> need to be provided to <code class="language-plaintext highlighter-rouge">ReviewSubmitComponent</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">ShippingAddressSetGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfigService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to <code class="language-plaintext highlighter-rouge">ShippingAddressSetGuard</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">ShippingAddressComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">CheckoutConfigService</code> and <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of these services was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>. This service needs to be provided to <code class="language-plaintext highlighter-rouge">ShippingAddressComponent</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">MultiCartService</code> now requires the additional provider <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">PageSlotComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">CmsComponentsService</code>. The use of this service was replaced with the <code class="language-plaintext highlighter-rouge">PageSlotService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">ForbiddenHandler</code> now uses <code class="language-plaintext highlighter-rouge">GlobalMessageService</code>, <code class="language-plaintext highlighter-rouge">AuthService</code>, and <code class="language-plaintext highlighter-rouge">OccEndpointsService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CheckoutPaymentService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CheckoutService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CustomerCouponService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">OrderReturnRequestService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UserAddressService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UserConsentService</code> now also requires <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UserInterestsService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UserNotificationPreferenceService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UserOrderService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>. It now also requires <code class="language-plaintext highlighter-rouge">RoutingService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UserPaymentService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UserService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">ActiveCartService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CartVoucherService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">SelectiveCartService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">WishListService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CheckoutDeliveryService</code> no longer uses <code class="language-plaintext highlighter-rouge">AuthService</code>. The use of this service was replaced with the <code class="language-plaintext highlighter-rouge">UserIdService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">UnauthorizedErrorHandler</code> was removed.</li>
  <li><code class="language-plaintext highlighter-rouge">StarRatingComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">ElementRef</code> and <code class="language-plaintext highlighter-rouge">Renderer2</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">ProductCarouselService</code> no longer uses <code class="language-plaintext highlighter-rouge">ProductReferenceService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">NotCheckoutAuthGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">SemanticPathService</code> and <code class="language-plaintext highlighter-rouge">Router</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">StoreFinderSearchConfig</code> was removed. <code class="language-plaintext highlighter-rouge">SearchConfig</code> should be used instead.</li>
  <li><code class="language-plaintext highlighter-rouge">ForgotPasswordComponent</code> now also requires <code class="language-plaintext highlighter-rouge">AuthConfigService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">OrderHistoryComponent</code> now also requires <code class="language-plaintext highlighter-rouge">UserReplenishmentOrderService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">OrderReturnGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">Router</code> and <code class="language-plaintext highlighter-rouge">SemanticPathService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">OrderCancellationGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">Router</code> and <code class="language-plaintext highlighter-rouge">SemanticPathService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">OutletRefDirective</code> no longer uses <code class="language-plaintext highlighter-rouge">FeatureConfigService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">OutletService</code> no longer uses <code class="language-plaintext highlighter-rouge">FeatureConfigService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">RoutingService</code> now also requires <code class="language-plaintext highlighter-rouge">RoutingParamsService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">TOKEN_REVOCATION_HEADER</code> was removed.</li>
  <li><code class="language-plaintext highlighter-rouge">JsonLdScriptFactory</code> now also requires <code class="language-plaintext highlighter-rouge">SeoConfig</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">LogoutGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">Router</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">ProductVariantGuard</code> no longer uses <code class="language-plaintext highlighter-rouge">RoutingService</code>. The use of this service was replaced with the corresponding methods from <code class="language-plaintext highlighter-rouge">Router</code> and <code class="language-plaintext highlighter-rouge">SemanticPathService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">FeatureModulesService</code> no longer has the <code class="language-plaintext highlighter-rouge">getInjectors</code> method.</li>
  <li><code class="language-plaintext highlighter-rouge">CmsComponentsService</code> no longer has the <code class="language-plaintext highlighter-rouge">getInjectors</code> method.</li>
  <li><code class="language-plaintext highlighter-rouge">ViewComponent</code> now also requires <code class="language-plaintext highlighter-rouge">ChangeDetectorRef</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">SplitViewDeactivateGuard</code> was removed.</li>
  <li><code class="language-plaintext highlighter-rouge">FeatureModulesService</code> no longer uses <code class="language-plaintext highlighter-rouge">Compiler</code>. The newly-added <code class="language-plaintext highlighter-rouge">getModule</code> method does not need it anymore.</li>
  <li><code class="language-plaintext highlighter-rouge">FeatureModulesService</code> no longer uses <code class="language-plaintext highlighter-rouge">Injector</code>. The newly-added <code class="language-plaintext highlighter-rouge">getModule</code> method does not need it anymore.</li>
  <li><code class="language-plaintext highlighter-rouge">FeatureModulesService</code> now uses <code class="language-plaintext highlighter-rouge">LazyModulesService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">JsonLdProductReviewBuilder</code> now uses <code class="language-plaintext highlighter-rouge">SeoConfig</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">RegisterComponent</code> now uses <code class="language-plaintext highlighter-rouge">AuthConfigService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">SplitViewComponent</code> now also requires <code class="language-plaintext highlighter-rouge">BreakpointService</code> and <code class="language-plaintext highlighter-rouge">ElementRef</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">CheckoutGuard</code> now also requires <code class="language-plaintext highlighter-rouge">CheckoutStepService</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">OrderConfirmationOverviewComponent</code> no longer uses <code class="language-plaintext highlighter-rouge">TranslationService</code>. The logic using this service was moved to the <code class="language-plaintext highlighter-rouge">OrderOverviewComponent</code>.</li>
</ul>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/3.x/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/3.x/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    appId: 'BNZEXRISC6',
    apiKey: '54a795a072ff713045038ee4ad33c990', 
    indexName: 'sap_spartacus', 
    inputSelector: '#docsearch', 
    algoliaOptions: {
      'facetFilters': ["tags:3.x"]
      },
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 


    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
