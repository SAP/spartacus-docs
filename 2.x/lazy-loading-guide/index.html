<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Lazy Loading Guide - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="Lazy Loading Guide">
<meta property="og:url" content="/spartacus-docs/2.x/lazy-loading-guide/">












  

  


<link rel="canonical" href="/spartacus-docs/2.x/lazy-loading-guide/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/2.x/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/2.x/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/2.x/"><img src="/spartacus-docs/2.x/assets/images/logo-blue_64x64.png" alt=""></a>
        
        <a class="site-title" href="/spartacus-docs/2.x/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/2.x/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/zt-jekftqo0-HP6xt6IF~ffVB2cGG66fcQ" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="https://stackoverflow.com/questions/tagged/spartacus-storefront" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/2.x/release-information/" >Version 2.1</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

         <a href="/spartacus-docs/2.x/"><span class="nav__sub-title">Home</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/2.x/getting-started/"><span class="nav__sub-title">Getting Started with Spartacus Libraries</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/2.x/dev-guide/"><span class="nav__sub-title">Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/storefront-development-faq/" class="">Storefront Development FAQ</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/spartacus-api/" class="">Spartacus API</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/global-configuration-in-spartacus/" class="">Global Configuration in Spartacus</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/spartacus-features/" class="">Spartacus Features ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/security-best-practices/" class="">Security Best Practices</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/performance/" class="">Performance Optimizations ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/outlets/" class="">Outlets</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/styling-and-page-layout/" class="">Styling and Page Layout ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/customizing-and-extending/" class="">Customizing and Extending Spartacus Features ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/lazy-loading-guide/" class="active">Lazy Loading Guide</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/extending-checkout/" class="">Extending Checkout</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/express-checkout/" class="">Express Checkout</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/guest-checkout/" class="">Guest Checkout</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/configurable-routing/" class="">Configurable Routing ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/configuring-base-url/" class="">Configuring the Base URL</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/context-configuration/" class="">Multi-Site Configuration ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/event-service/" class="">Event Service</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/pwa-home/" class="">PWA ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/seo/" class="">SEO ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/i18n/" class="">Internationalization (i18n)</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/a11y/" class="">Accessibility ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/state-management/" class="">State Management ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/smartedit-contract/" class="">SmartEdit Contract in Spartacus</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/customizing-backend-communication/" class="">Customizing Back End Communication ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/global-messages/" class="">Global Messages</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/http-error-handling/" class="">HTTP Error Handling</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/configurable-state-persistence-and-rehydration/" class="">Configurable State Persistence and Rehydration</a>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/server-side-rendering-in-spartacus/" class="">Server-Side Rendering ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/view-configuration/" class="">View Configuration ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        

                          
                          

                            
                            

                            <li><a href="/spartacus-docs/2.x/user-experience-guidelines/" class="">Customer Experience Guidelines ➢</a>
                                
                                    <ul>
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        

                                          
                                          

                                              
                                        
                                    </ul>
                                
                            </li>     
                        
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/2.x/about-tua-spartacus/"><span class="nav__sub-title">Telco & Utilities Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/2.x/about-fsa-spartacus/"><span class="nav__sub-title">Financial Services Accelerator Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/2.x/contributors-guide/"><span class="nav__sub-title">Contributing to Spartacus</span></a>
         
        
            <ul>
                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
  </ul>
</nav>      

    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">Lazy Loading Guide</h1>
    
    <p>Lazy loading, also known as code splitting, lets you divide your JavaScript code into multiple chunks. The result is that you do not have to load all the JavaScript of the full application when a user accesses the first page. Instead, only the chunks that are required for the given page are loaded. While navigating the storefront, additional chunks might be loaded when needed.</p>

<p>Such an approach can substantially improve “Time To Interactive”, especially in the case of complex web applications being accessed by low-end mobile devices.</p>

<h2 id="spartacus-approach-to-lazy-loading">Spartacus Approach to Lazy Loading</h2>

<p>Code splitting is a technique that has to be done at application build time. Code splitting provided by Angular is typically route-based, which means there is a chunk for the landing page, another chunk for the product page, and so on. Since Spartacus is mostly CMS driven, the actual application logic for each route cannot be decided at build time. Business users will eventually alter the page structure by introducing or removing components. This is why an alternative approach to lazy-loading is required, which Spartacus provides in the following ways:</p>

<ul>
  <li>Lazy loading of CMS components</li>
  <li>CMS-driven lazy loading of feature modules</li>
</ul>

<h2 id="general-concepts">General Concepts</h2>

<p>The following sections offer some important information about how lazing loading works in Spartacus.</p>

<h3 id="define-dynamic-imports-only-in-the-main-application">Define Dynamic Imports Only in the Main Application</h3>

<p>Dynamic imports, a technique that is used to facilitate lazy loading and that also allows code splitting, can only be used in the main application. It is not possible to define dynamic imports in the prebuilt libraries.</p>

<p>This is an unfortunate limitation, which results in some application code that must be added by customers. Although the amount of custom code is limited to the bare minimum, we’ll add a feature in a future version of the schematics library to automatically add lazy loaded modules.</p>

<h3 id="avoiding-static-imports-for-lazy-loaded-code">Avoiding Static Imports for Lazy Loaded Code</h3>

<p>To make code spitting possible, your static JavaScript code (the main app bundle) should not have any static imports to code that you want to lazy load. The builder will notice that the code is already included, and as a result, will not generate a separate chunk for it. This is especially important in the case of importing symbols from libraries.</p>

<p>At the time of writing (Angular 9 and Angular 10), mixing static imports with dynamic imports for the same library entry point, even for distinct symbols, will break lazy loading and tree shaking for this library entry point. This includes the whole entry point statically into the build. For this reason, it is highly recommended you create separate entry points for the code that has to be loaded statically, and for the code that can be loaded lazily.</p>

<h3 id="configuration-in-lazy-loaded-modules">Configuration in Lazy Loaded Modules</h3>

<p>If additional configuration is provided inside the lazy-loaded module, this configuration is not merged in the global application configuration. As a result, the configuration will not affect any component other than the lazy-loaded components.</p>

<p>This limitation will be addressed in Spartacus 3.x with the concept of unified configuration. For Spartacus 2.x, you should import modules with configuration statically.</p>

<h3 id="providers-in-lazy-loaded-modules">Providers in Lazy Loaded Modules</h3>

<p>Injection tokens provided in lazy-loaded modules are not visible to services provided in the app root. This applies especially to multi-provided tokens, such as <code class="language-plaintext highlighter-rouge">PageMetaResolvers</code>, various Handlers, and so on. This problem will be partially addressed in Spartacus 3.0 with the Unified Injector mechanism. For Spartacus 2.x, you should always provide these tokens in modules statically imported to your app root module.</p>

<h3 id="avoiding-importing-the-httpclientmodule-in-your-lazy-loaded-modules">Avoiding Importing the HttpClientModule in Your Lazy Loaded Modules</h3>

<p>In general, the <code class="language-plaintext highlighter-rouge">HttpClientModule</code> should be imported in the root application, not in the library. For example, if you import it inside a lazy-loaded library, all injectors from the root library will be invisible to HTTP calls originating from the lazy-loaded module.</p>

<p>Although technically it is possible to import the <code class="language-plaintext highlighter-rouge">HttpClientModule</code> in the library, in most cases it is not something that is expected, and it might cause errors that are difficult to explain, so please keep this in mind.</p>

<h2 id="lazy-loading-of-cms-components">Lazy Loading of CMS components</h2>

<p><b>Note: </b> 
This feature is introduced with version 2.0 of the Spartacus libraries.
 </p>

<h3 id="configuration-of-lazy-loading-cms-components">Configuration of Lazy Loading CMS Components</h3>

<p>Lazy loading of CMS code is achieved by specifying a dynamic import in place of a statically-referenced components class in the CMS Mapping configuration. The following is an example:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">cmsComponents</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">SimpleResponsiveBannerComponent</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">component</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">./lazy/lazy.component</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">m</span> <span class="o">=&gt;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">LazyComponent</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>For more information on CMS mapping, see <a href="/spartacus-docs/2.x/customizing-cms-components/">Customizing CMS Components</a>.</p>

<h3 id="technical-details">Technical Details</h3>

<p>Support for dynamic imports in CMS component mapping is implemented using customizable component handlers (specifically, the <code class="language-plaintext highlighter-rouge">LazyComponentHandler</code>).</p>

<p>It is possible to extend this handler to customize its behavior, to add special hooks, or different triggers, or to implement a completely new handler that can optionally reuse existing ones.</p>

<h2 id="lazy-loading-of-modules">Lazy Loading of Modules</h2>

<p><b>Note: </b> 
This feature is introduced with version 2.1 of the Spartacus libraries.
 </p>

<p>CMS-driven lazy loading of feature modules allows the following:</p>

<ul>
  <li>Lazy loading not only component code, but also the core part (including NgRx state)</li>
  <li>Loading a feature only once, when first needed</li>
  <li>Providing shared, lazy-loaded dependency modules</li>
</ul>

<p>Lazy loading of the feature module is triggered by the CMS requesting a component when the implementation is covered by the relevant feature configuration.</p>

<h3 id="configuration-of-lazy-loaded-modules">Configuration of Lazy Loaded Modules</h3>

<p>Configuration of the feature involves the following aspects:</p>

<ul>
  <li>The dynamic import of the feature module (which has to be defined in main application)</li>
  <li>
    <p>The information about what CMS components are covered by a specific feature (which can become part of the library and imported statically). This information is provided as an array of strings under the <code class="language-plaintext highlighter-rouge">cmsComponents</code> key. The following is an example:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">featureModules</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">organization</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">module</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span>
        <span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">@spartacus/my-account/organization</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
          <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">OrganizationModule</span>
        <span class="p">),</span>
      <span class="na">cmsComponents</span><span class="p">:</span> <span class="p">[</span>
        <span class="dl">'</span><span class="s1">OrderApprovalListComponent</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">ManageBudgetsListComponent</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">ManageCostCentersListComponent</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">ManagePermissionsListComponent</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">ManageUnitsListComponent</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">ManageUserGroupsListComponent</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">ManageUsersListComponent</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">],</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="component-mapping-configuration-in-lazy-loaded-modules">Component Mapping Configuration in Lazy-Loaded Modules</h3>

<p>Default CMS mapping configuration in lazy-loaded modules should be defined in exactly the same fashion as in statically-imported ones.</p>

<p>Spartacus is able to extract a CMS component mapping configuration from a lazy-loaded feature and use it to resolve component classes and factories covered by the feature. That is why it is possible and recommended to use the standard way of providing the default CMS mapping configuration inside a lazy loaded module. As a result, the exact same module and library entry point can be imported dynamically or statically, depending on the needs, and it is still possible to overwrite a lazy-loaded CMS configuration from the application level by providing configuration overrides in the application.</p>

<h3 id="defining-shared-dependency-modules">Defining Shared-Dependency Modules</h3>

<p>It is possible to extract some logic to a shared, lazy-loaded module that can be defined as a lazy-loaded dependency for a feature module by providing an array of dynamic imports in the <code class="language-plaintext highlighter-rouge">dependencies</code> property of the feature configuration. The following is an example:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">featureModules</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">organization</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">module</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span>
        <span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">@spartacus/my-account/organization</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
          <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">OrganizationModule</span>
        <span class="p">),</span>
      <span class="na">dependencies</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">()</span> <span class="o">=&gt;</span>
          <span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">@spartacus/storefinder/core</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">OrganizationModule</span>
          <span class="p">),</span>
        <span class="c1">// ,,</span>
      <span class="p">],</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Such unnamed dependency modules are instantiated only once, when lazy loading the first feature that depends on it. Its providers contribute to the combined injector that is passed to the CMS component that is covered by the feature.</p>

<h3 id="combined-injector">Combined Injector</h3>

<p>When a CMS component that is covered by a lazy-loaded module is instantiated, it can inject (have access to) services from the following:</p>

<ul>
  <li>the app root injector, taking into account the hierarchical injector component tree (that is, providers defined in the parent components)</li>
  <li>the feature module injector</li>
  <li>the dependency modules injectors</li>
</ul>

<p>This is achieved thanks to the <code class="language-plaintext highlighter-rouge">CombinedInjector</code> that is created on the fly by the CMS rendering logic. As a rule of thumb, local hierarchical providers take precedence over feature module providers, which in turn takes precedence over dependency module injectors, which take precedence over the root application injector.</p>

<h2 id="preparing-libraries-to-work-with-lazy-loading">Preparing Libraries to Work with Lazy Loading</h2>

<h3 id="providing-fine-grained-entry-points-in-your-library">Providing Fine-Grained Entry Points in Your Library</h3>

<p>Mixing static and dynamic imports from the same entry points breaks lazy loading and affects tree shaking, so any library that will be used directly in dynamic imports should expose fine-grained secondary entry points to optimize code splitting.</p>

<p>For more information, see <a href="https://github.com/ng-packagr/ng-packagr/blob/master/docs/secondary-entrypoints.md">Secondary Entry Points</a> in the ng-packagr documentation on GitHub.</p>

<h3 id="separating-static-code-from-lazy-loaded-code">Separating Static Code from Lazy Loaded Code</h3>

<p>When you work with Angular Dependency Injection, the list of providers in the injector should not change after the injector is initialized. This paradigm specifically affects the following:</p>

<ul>
  <li>
    <p>The Spartacus configuration, which is defined by providing configuration chunks that are merged in the global Configuration Factory Provider.</p>
  </li>
  <li>
    <p>Any multi-provided tokens, handlers such as <code class="language-plaintext highlighter-rouge">PageMetaResolver</code>, <code class="language-plaintext highlighter-rouge">ErrorHandler</code>, and so on.</p>
  </li>
  <li>
    <p>Any Angular native multi-provided tokens, such as <code class="language-plaintext highlighter-rouge">HTTP_INTERCEPTOR</code>, <code class="language-plaintext highlighter-rouge">APP_INITIALIZER</code>, and so on.</p>
  </li>
</ul>

<p>The result is that any configuration or multi-provided token in a lazy-loaded module will not be visible to modules and services provided in the root, or in other lazy-loaded chunks.</p>

<p>The easiest way to fix this is to always include this kind of code in a statically-linked module that is available upfront. It is recommended to create a separate entry point in your library (by convention, named <em>root</em>, such as <code class="language-plaintext highlighter-rouge">my-library/root</code>) that contains minimal code, and that will be included in the main bundle and will be available from the beginning.</p>

<h3 id="wrapping-library-code-in-a-lazy-loaded-module">Wrapping Library Code in a Lazy-Loaded Module</h3>

<p>To address some specific customizations on top of a lazy loaded library, it is possible to wrap static imports from one or more libraries into a single module that will be imported dynamically instead. This technique can also be an effective optimization strategy, because the builder will be able to use tree shaking for all of the static imports inside the module.</p>

<h2 id="additional-mechanisms-planned-for-spartacus-30">Additional Mechanisms (Planned for Spartacus 3.0)</h2>

<h3 id="unified-configuration">Unified Configuration</h3>

<p><strong>Note:</strong> A preview will be available in the <em>3.0-next</em> releases.</p>

<p>Unified configuration provides a way to get a global configuration that includes both the root configuration and the configuration from already-loaded lazy-loaded modules.</p>

<h3 id="unified-injector">Unified Injector</h3>

<p><strong>Note:</strong> A preview will be available in the <em>3.0-next</em> releases.</p>

<p>The unified injector provides a way to inject a token, or multi-provided tokens, taking into account the root injector and the injectors from lazy-loaded modules. The injector exposes an Observable that emits a new set of injectables for a specified token each time the status of the Unified Injector changes. This status changes whenever Spartacus instantiates a new lazy-loaded module, because the module contains an injector that can be added to the Unified Injector.</p>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/2.x/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/2.x/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    apiKey: 'b6583768751462c6ee53d5a5720cda44', 
    indexName: 'sap_spartacus', 
    inputSelector: '#docsearch', 
    algoliaOptions: {
      'facetFilters': ["tags:latest"]
      },
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 

    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
