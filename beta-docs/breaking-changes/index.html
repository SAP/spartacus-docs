<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Maintaining Public APIs - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="Maintaining Public APIs">
<meta property="og:url" content="/spartacus-docs/beta-docs/breaking-changes/">












  

  


<link rel="canonical" href="/spartacus-docs/beta-docs/breaking-changes/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/beta-docs/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/beta-docs/assets/css/main.css">
<link rel="stylesheet" href="/spartacus-docs/beta-docs/assets/css/keys.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/beta-docs/"><img src="/spartacus-docs/beta-docs/assets/images/logo-blue_64x64.png" alt="Spartacus logo"></a>
        
        <a class="site-title" href="/spartacus-docs/beta-docs/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/beta-docs/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/zt-jekftqo0-HP6xt6IF~ffVB2cGG66fcQ" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/beta-docs/#how-to-obtain-support" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/beta-docs/release-information/" >Version 5.0</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

         <a href="/spartacus-docs/beta-docs/"><span class="nav__sub-title">Home</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/beta-docs/getting-started/"><span class="nav__sub-title">Getting Started with Spartacus Libraries</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/beta-docs/dev-guide/"><span class="nav__sub-title">Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/beta-docs/using-spartacus/"><span class="nav__sub-title">Using the Spartacus Storefront</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/beta-docs/about-tua-spartacus/"><span class="nav__sub-title">Telco & Utilities Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/beta-docs/about-fsa-spartacus/"><span class="nav__sub-title">Financial Services Accelerator Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/beta-docs/contributors-guide/"><span class="nav__sub-title">Contributing to Spartacus</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/beta-docs/contributing-to-the-spartacus-storefront/">Contributing to the Spartacus </br>Storefront ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/beta-docs/contributor-setup/">Contributor Setup ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/beta-docs/coding-guidelines/">Coding Guidelines ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/beta-docs/definition-of-done/">Definition of Done ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                        
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/beta-docs/a11y-e2e-tests/" class="">Accessibility E2E Tests</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/beta-docs/e2e-guidelines/" class="">End-to-End Test Guidelines</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/beta-docs/breaking-changes/" class="active">Maintaining Public APIs</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/beta-docs/unit-testing-guidelines/" class="">Unit Testing Guidelines</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/beta-docs/updating-schematics/" class="">Updating Schematics</a>


                                                                        
                                                                </li>
                                                            
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/beta-docs/continuous-integration/">Continuous Integration</a>
                                              
                                        </li>
                                      
                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
  </ul>
</nav>      

    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">Maintaining Public APIs</h1>
    
    <p>The Spartacus public APIs are developed and maintained according to a set of best practices and procedures that are described in the following sections.</p>

<hr />

<p><strong>Table of Contents</strong></p>

<ul id="markdown-toc">
  <li><a href="#keeping-public-apis-minimal" id="markdown-toc-keeping-public-apis-minimal">Keeping Public APIs Minimal</a></li>
  <li><a href="#avoiding-breaking-changes" id="markdown-toc-avoiding-breaking-changes">Avoiding Breaking Changes</a></li>
  <li><a href="#adding-new-constructor-dependencies-in-minor-versions" id="markdown-toc-adding-new-constructor-dependencies-in-minor-versions">Adding New Constructor Dependencies in Minor Versions</a>    <ul>
      <li><a href="#using-the-inject-decorator-for-dependencies" id="markdown-toc-using-the-inject-decorator-for-dependencies">Using the Inject Decorator for Dependencies</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="keeping-public-apis-minimal">Keeping Public APIs Minimal</h2>

<p>It is a challenge to maintain stability in large APIs. If you are making changes to the API library, consider the broad consequences of your changes, and try to anticipate any issues that might arise. It is also a good idea to check the generated public API report with previous <code class="language-plaintext highlighter-rouge">develop</code> reports, and to make sure that only the things you explicitly want to export are publicly visible.</p>

<h2 id="avoiding-breaking-changes">Avoiding Breaking Changes</h2>

<p>Spartacus releases follow semantic versioning, which means breaking changes are only included in major releases. Breaking changes will not be included in minor or patch releases. A breaking change may be introduced by any of the following actions:</p>

<ul>
  <li>Changing the selector of a <code class="language-plaintext highlighter-rouge">component</code>, <code class="language-plaintext highlighter-rouge">directive</code>, or <code class="language-plaintext highlighter-rouge">pipe</code>.</li>
  <li>Removing or changing the name of exported classes, functions, constants, interfaces or types in <code class="language-plaintext highlighter-rouge">public_api.ts</code>. Note that <code class="language-plaintext highlighter-rouge">index.ts</code> barrels can also bubble up exports to <code class="language-plaintext highlighter-rouge">public_api.ts</code>.</li>
  <li>Changing or removing interface properties.</li>
  <li>Adding new, required properties to interfaces and types. However, you can add optional properties with <code class="language-plaintext highlighter-rouge">?</code>.</li>
  <li>Changing or removing <code class="language-plaintext highlighter-rouge">public</code> or <code class="language-plaintext highlighter-rouge">protected</code> class members.</li>
  <li>Changing or removing existing <code class="language-plaintext highlighter-rouge">public</code> or <code class="language-plaintext highlighter-rouge">protected</code> function parameters. Note that changing the order also introduces a breaking change.</li>
  <li>Adding new, required parameters to <code class="language-plaintext highlighter-rouge">public</code> functions. However, you can add optional parameters to <code class="language-plaintext highlighter-rouge">public</code> functions.</li>
  <li>Changing access levels on classes, functions or interfaces to a more restrictive access level. In other words, changing <code class="language-plaintext highlighter-rouge">public</code> to <code class="language-plaintext highlighter-rouge">protected</code> or <code class="language-plaintext highlighter-rouge">private</code>, or changing <code class="language-plaintext highlighter-rouge">protected</code> to <code class="language-plaintext highlighter-rouge">private</code> introduces a breaking change.</li>
  <li>Changing function’s return type form <code class="language-plaintext highlighter-rouge">T</code> to <code class="language-plaintext highlighter-rouge">T | S</code></li>
  <li>Changing function behavior where the function returns different results. In other words, when changing function behavior, the function should return the same results for the same provided input as it did before the change.</li>
  <li>Changing assertions in unit tests or end-to-end tests.</li>
  <li>Removing anything from Angular modules, such as imports, providers, declarations, entryComponents, or exports.</li>
  <li>Removing or updating existing values, or changing the order for exported enums. However, you can add new values.</li>
  <li>Changing the default value for function parameters. The default value should match the function behavior from before the change.</li>
  <li>Making any changes to the class constructor signature. Note that <code class="language-plaintext highlighter-rouge">super</code> calls need to be updated in classes extending ours.</li>
  <li>Changing the initial values of an exported class’s <code class="language-plaintext highlighter-rouge">public</code> or <code class="language-plaintext highlighter-rouge">protected</code> fields, or changing them to read-only.</li>
  <li>
    <p>Changing or removing translation keys or values.</p>

    <p><strong>Note:</strong> Adding new translation keys and values is not considered a breaking change.</p>
  </li>
  <li>Changing default configurations.</li>
  <li>Changing any CSS or SCSS attributes, classes or selectors.</li>
  <li>
    <p>Changing anything that affects the rendering of the existing DOM.</p>

    <p><strong>Note:</strong> Additions, changes, or deletions of <code class="language-plaintext highlighter-rouge">aria</code> attributes (for screen readers) are not considered breaking changes.</p>
  </li>
</ul>

<h2 id="adding-new-constructor-dependencies-in-minor-versions">Adding New Constructor Dependencies in Minor Versions</h2>

<p>The following describes what to do, and what not do do, when adding a new constructor dependency in a minor version.</p>

<p>The following is an example of some code before a new constructor dependency is added:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">promotionService</span><span class="p">:</span> <span class="nx">PromotionService</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>

<p>A new <code class="language-plaintext highlighter-rouge">cartItemContextSource</code> constructor dependency is then added, as follows:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">promotionService</span><span class="p">:</span> <span class="nx">PromotionService</span><span class="p">,</span>
    <span class="k">protected</span> <span class="nx">cartItemContextSource</span><span class="p">:</span> <span class="nx">CartItemContextSource</span>
  <span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/* ... */</span>

  <span class="nx">method</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cartItemContextSource</span><span class="p">.</span><span class="nx">item$</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>This would cause a breaking change (specifically, a compilation error) for any customer who upgrades to the new minor version and who has previously extended our service in their codebase by calling the <code class="language-plaintext highlighter-rouge">super()</code> constructor with less parameters, such as in the following example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomService</span> <span class="kd">extends</span> <span class="nx">SpartacusService</span> <span class="p">{</span>
     <span class="kd">constructor</span><span class="p">(</span><span class="nx">promotionService</span><span class="p">:</span> <span class="nx">PromotionService</span><span class="p">){</span>
       <span class="k">super</span><span class="p">(</span><span class="nx">promotionService</span><span class="p">);</span> <span class="c1">// &lt;--------- wrong constructor signature</span>
       <span class="cm">/* customer's constructor logic here */</span>
     <span class="p">}</span>
   <span class="p">}</span>
</code></pre></div></div>

<p>Instead, the new constructor dependency should be added as follows:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// TODO(#10946): make CartItemContextSource a required dependency</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="nx">promotionService</span><span class="p">:</span> <span class="nx">PromotionService</span><span class="p">,</span>
    <span class="c1">// eslint-disable-next-line @typescript-eslint/unified-signatures</span>
    <span class="nx">cartItemContextSource</span><span class="p">:</span> <span class="nx">CartItemContextSource</span>
  <span class="p">);</span>
  <span class="cm">/**
   * @deprecated since 3.1
   */</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">promotionService</span><span class="p">:</span> <span class="nx">PromotionService</span><span class="p">);</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">promotionService</span><span class="p">:</span> <span class="nx">PromotionService</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">Optional</span><span class="p">()</span> <span class="k">protected</span> <span class="nx">cartItemContextSource</span><span class="p">?:</span> <span class="nx">CartItemContextSource</span>
  <span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/* ... */</span>

  <span class="nx">method</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cartItemContextSource</span><span class="p">?.</span><span class="nx">item$</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>When adding a new constructor dependency, you <strong>must</strong> do the following:</p>

<ul>
  <li>Add <code class="language-plaintext highlighter-rouge">?</code> to make the new constructor parameter optional. Otherwise, customers who pass less arguments will get a compilation error.</li>
  <li>In the logic of your class, allow for the new constructor parameter to be null or undefined. You can do this by accessing any properties of the new dependency with optional chaining (<code class="language-plaintext highlighter-rouge">?.</code>), such as <code class="language-plaintext highlighter-rouge">this.cartItemContextSource?.item$</code>. If this is not done, a customer who extends our class and passes less parameters to the <code class="language-plaintext highlighter-rouge">super()</code> constructor will get a runtime error in our logic because the <code class="language-plaintext highlighter-rouge">this.cartItemContextSource</code> object would be undefined.</li>
  <li>If your new constructor dependency might not be provided for your class (for example, the dependency service is not <code class="language-plaintext highlighter-rouge">providedIn: 'root'</code>, or is provided conditionally in the DOM), then precede the constructor dependency with <code class="language-plaintext highlighter-rouge">@Optional()</code>. Otherwise, when the dependency is not conditionally provided, customers will get an Angular runtime error that the dependency cannot be resolved. Preceding the constructor dependency with <code class="language-plaintext highlighter-rouge">@Optional()</code> tells Angular to fall back gracefully to <code class="language-plaintext highlighter-rouge">null</code> when the value cannot be injected.</li>
</ul>

<p>Aside from the above requirements, we also encourage you to do the following:</p>

<ul>
  <li>Add an inline comment, such as <code class="language-plaintext highlighter-rouge">// TODO(#ticket-number): make X a required dependency</code>, to reference planned work for the next major version.</li>
  <li>Add two alternative declarations of the constructor above the implementation. <strong>The top declaration must be the newest one</strong>. This is because, in a production build using SSR, only the first declaration is used to resolve dependencies. It is also helpful to add <code class="language-plaintext highlighter-rouge">@deprecated since X.Y</code> to your JSDoc comment. When this is included, customers can be warned by their IDE that the old constructor signature they are using (with less parameters) is deprecated, and this can motivate them to migrate early to the new signature.</li>
</ul>

<h3 id="using-the-inject-decorator-for-dependencies">Using the Inject Decorator for Dependencies</h3>

<p>You should not include any constructor declarations when using <code class="language-plaintext highlighter-rouge">@Inject</code> for dependencies. Instead, you should only include the constructor definition.</p>

<p>When you build libraries (for example, when you run <code class="language-plaintext highlighter-rouge">ng build --prod core</code>), the <code class="language-plaintext highlighter-rouge">ng-packagr</code> tool only uses the first constructor declaration to resolve injected dependencies, and the construction definition is ignored. However, the <code class="language-plaintext highlighter-rouge">Inject</code> decorator is not supported in constructor declarations, so it cannot be used to resolve dependencies there. If you include a constructor declaration with a dependency, the <code class="language-plaintext highlighter-rouge">ng-packagr</code> tool will fail to resolve the dependency and you will get an error, as follows:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> ERROR: Internal error: unknown identifier <span class="o">[]</span>
</code></pre></div></div>

<p>The following is an example that will give you this error:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">PLATFORM_ID</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span class="p">;</span>
<span class="cm">/*...*/</span>

  <span class="c1">// Do not add any constructor declarations when using @Inject to resolve a dependency</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="nx">platformId</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="c1">// this dependency will not be resolved, nor can it be fixed with @Inject, because the Inject decorator is not supported here!</span>
    <span class="nx">newService</span><span class="p">?:</span> <span class="nx">NewService</span>
  <span class="p">)</span> <span class="p">{}</span>
   <span class="kd">constructor</span><span class="p">(</span>
    <span class="k">protected</span> <span class="nx">platformId</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>

  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">PLATFORM_ID</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">platformId</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span>
    <span class="k">protected</span> <span class="nx">newService</span><span class="p">?:</span> <span class="nx">NewService</span>
  <span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>

<p>The following is a modification of the previous example that illustrates how you can use the <code class="language-plaintext highlighter-rouge">Inject</code> decorator to handle a dependency:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">PLATFORM_ID</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span class="p">;</span>
<span class="cm">/*...*/</span>

  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">PLATFORM_ID</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">platformId</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span>
    <span class="k">protected</span> <span class="nx">newService</span><span class="p">?:</span> <span class="nx">NewService</span>
  <span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<table BORDER="0"><tr><td class="tdfooter"><a href="https://www.sap.com/copyright" target="_blank">Copyright</a></td>

<td class="tdfooter"><a href="https://sap.github.io/spartacus-docs/privacy-statement/">Privacy Statement</a></td>

<td class="tdfooter"><a href="https://www.sap.com/impressum" target="_blank">Legal Disclosure</a></td>

<td class="tdfooter"><a href="https://www.sap.com/trademark" target="_blank">Trademark</a></td>

<td class="tdfooter"><a href="https://www.sap.com/terms-of-use" target="_blank">Terms of Use</a></td></tr></table>
<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/beta-docs/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/beta-docs/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    appId: 'BNZEXRISC6',
    apiKey: '54a795a072ff713045038ee4ad33c990', 
    indexName: 'sap_spartacus', 
    inputSelector: '#docsearch', 
    algoliaOptions: {
      'facetFilters': ["tags:latest"]
      },
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 

    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
