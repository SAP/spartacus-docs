<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Unit Testing Guidelines - Spartacus Documentation</title>
<meta name="description" content="SAP Spartacus JavaScript Storefront Documentation.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Spartacus Documentation">
<meta property="og:title" content="Unit Testing Guidelines">
<meta property="og:url" content="/spartacus-docs/4.x/unit-testing-guidelines/">












  

  


<link rel="canonical" href="/spartacus-docs/4.x/unit-testing-guidelines/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": null,
      "url": null,
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/spartacus-docs/4.x/feed.xml" type="application/atom+xml" rel="alternate" title="Spartacus Documentation Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/spartacus-docs/4.x/assets/css/main.css">
<link rel="stylesheet" href="/spartacus-docs/4.x/assets/css/keys.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert scripts for adding anchor links to headers -->

<script src="https://kit.fontawesome.com/82d5a2bf2f.js" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  </head>

  <body class="layout--home">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/spartacus-docs/4.x/"><img src="/spartacus-docs/4.x/assets/images/logo-blue_64x64.png" alt="Spartacus logo"></a>
        
        <a class="site-title" href="/spartacus-docs/4.x/">Spartacus Documentation</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/spartacus-docs/4.x/docs-archive/" >Doc Archive</a>
            </li><li class="masthead__menu-item">
              <a href="https://join.slack.com/t/spartacus-storefront/shared_invite/zt-jekftqo0-HP6xt6IF~ffVB2cGG66fcQ" >Feedback</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/4.x/#how-to-obtain-support" >Support</a>
            </li><li class="masthead__menu-item">
              <a href="/spartacus-docs/4.x/release-information/" >Version 4.2</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

         <a href="/spartacus-docs/4.x/"><span class="nav__sub-title">Home</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/4.x/getting-started/"><span class="nav__sub-title">Getting Started with Spartacus Libraries</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/4.x/dev-guide/"><span class="nav__sub-title">Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/4.x/using-spartacus/"><span class="nav__sub-title">Using the Spartacus Storefront</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/4.x/about-tua-spartacus/"><span class="nav__sub-title">Telco & Utilities Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/4.x/about-fsa-spartacus/"><span class="nav__sub-title">Financial Services Accelerator Storefront Development Guide</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    
                                            
                                    
                                            
                                    
                                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
      <li>
        
          
          

         <a href="/spartacus-docs/4.x/contributors-guide/"><span class="nav__sub-title">Contributing to Spartacus</span></a>
         
        
            <ul>
                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                  
                            
                                    

                                
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/4.x/contributing-to-the-spartacus-storefront/">Contributing to the Spartacus </br>Storefront ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/4.x/contributor-setup/">Contributor Setup ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/4.x/coding-guidelines/">Coding Guidelines ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/4.x/definition-of-done/">Definition of Done ➢</a>
                                            
                                                <ul>
                                                    
                                                          
                                                    
                                                          
                                                    
                                                          
                                                    
                                                        
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/4.x/a11y-e2e-tests/" class="">Accessibility E2E Tests</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/4.x/e2e-guidelines/" class="">End-to-End Test Guidelines</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/4.x/breaking-changes/" class="">Maintaining Public APIs</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/4.x/unit-testing-guidelines/" class="active">Unit Testing Guidelines</a>


                                                                        
                                                                </li>
                                                            

                                                              
                                                              
                                                            
                                                              
                                                              

                                                                
                                                                <li><a href="/spartacus-docs/4.x/updating-schematics/" class="">Updating Schematics</a>


                                                                        
                                                                </li>
                                                            
                                                          
                                                    
                                                          
                                                    
                                                </ul>
                                              
                                        </li>
                                    

                                      
                                      

                                        <li><a href="/spartacus-docs/4.x/continuous-integration/">Continuous Integration</a>
                                              
                                        </li>
                                      
                                  
                            
                                    

                                  
                            
                        </ul>
   
                    

                    

                
                        <ul>
                            
                        </ul>
   
                    

                    

                
            </ul>  
      </li>          
    
  </ul>
</nav>      

    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">Unit Testing Guidelines</h1>
    
    <p>The following are some best practices for writing Spartacus unit tests.</p>

<hr />

<p><strong>Table of Contents</strong></p>

<ul id="markdown-toc">
  <li><a href="#general-guidelines" id="markdown-toc-general-guidelines">General Guidelines</a></li>
  <li><a href="#ui-components" id="markdown-toc-ui-components">UI Components</a>    <ul>
      <li><a href="#mock-everything" id="markdown-toc-mock-everything">Mock Everything</a></li>
      <li><a href="#covering-the-ui" id="markdown-toc-covering-the-ui">Covering the UI</a></li>
    </ul>
  </li>
  <li><a href="#ngrx-and-tests-that-use-the-store" id="markdown-toc-ngrx-and-tests-that-use-the-store">NGRX and Tests That Use the Store</a></li>
  <li><a href="#using-test-grouping-for-improved-readability" id="markdown-toc-using-test-grouping-for-improved-readability">Using Test Grouping for Improved Readability</a></li>
  <li><a href="#avoiding-silently-failing-tests" id="markdown-toc-avoiding-silently-failing-tests">Avoiding Silently Failing Tests</a>    <ul>
      <li><a href="#assert-outside-a-subscription" id="markdown-toc-assert-outside-a-subscription">Assert Outside a Subscription</a></li>
      <li><a href="#initializing-the-result-with-a-value-that-fails-the-assertion" id="markdown-toc-initializing-the-result-with-a-value-that-fails-the-assertion">Initializing the Result with a Value That Fails the Assertion</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="general-guidelines">General Guidelines</h2>

<ul>
  <li>All code must be covered by unit tests.</li>
  <li>Test one thing per test (it).</li>
  <li>Unit tests isolate the tested code from it’s dependencies: mock all the dependencies you can.</li>
  <li>Unit tests need to be independent from one another: we should be able to run the tests from a file in any order and it would not change the outcome.</li>
  <li>Cover happy path, errors, edge cases and UI when applicable.</li>
</ul>

<h2 id="ui-components">UI Components</h2>

<h3 id="mock-everything">Mock Everything</h3>

<p>Mock everything. As with any other piece of code, we want to test the UI component in isolation. We don’t want the test results to be influenced by code that is outside of the class we are testing.</p>

<p>While mocking dependencies like services is more obvious, it’s easy to forget to mock subcomponents that are called from within the tested component’s template.</p>

<p>To mock a subcomponent, you create a fake copy of it in your spec file. The fake component must have the same selector as the subcomponents you want to fake:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">template</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
  <span class="na">selector</span><span class="p">:</span> <span class="dl">'</span><span class="s1">cx-some-component</span><span class="dl">'</span>
<span class="p">})</span>
<span class="kd">class</span> <span class="nx">MockSomeComponent</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">Input</span><span class="p">()</span> <span class="nx">someparam</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Then, you declare it in the TestBed:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">TestBed</span><span class="p">.</span><span class="nx">configureTestingModule</span><span class="p">({</span>
    <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">...</span>
    <span class="p">],</span>
    <span class="na">declarations</span><span class="p">:</span> <span class="p">[</span><span class="nx">MockSomeComponent</span><span class="p">],</span>
    <span class="na">providers</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">...</span>
    <span class="p">],</span>
<span class="p">}).</span><span class="nx">compileComponents</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="covering-the-ui">Covering the UI</h3>

<p>For UI components, create tests that read and interact with the UI, not just the component class functions. Writing UI tests in the component unit tests is inexpensive compared to e2e tests. Again, cover the main scenarios and also error scenarios and edge cases that have an impact on the UI.</p>

<h2 id="ngrx-and-tests-that-use-the-store">NGRX and Tests That Use the Store</h2>

<p>Mocking the NGRX store has proven to be quite a challenge. The NGRX store is the exception to the rule of mocking dependencies in our unit tests.</p>

<p>To perform a unit test on a piece of code that reads from the store, populate the store by calling explicitly the relevant success actions with the data to set up the test.</p>

<p>Here is an example where we dispatch <em>LoadUserAddressesSuccess</em> to set up the test data:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should be able to get user addresses</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="na">mockUserAddresses</span><span class="p">:</span> <span class="nx">Address</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address1</span><span class="dl">'</span> <span class="p">},</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address2</span><span class="dl">'</span> <span class="p">}];</span>
  <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="k">new</span> <span class="nx">UserActions</span><span class="p">.</span><span class="nx">LoadUserAddressesSuccess</span><span class="p">(</span><span class="nx">mockUserAddresses</span><span class="p">));</span>

  <span class="kd">let</span> <span class="na">addresses</span><span class="p">:</span> <span class="nx">Address</span><span class="p">[];</span>
  <span class="nx">service</span>
    <span class="p">.</span><span class="nx">getAddresses</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">addresses</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address1</span><span class="dl">'</span> <span class="p">},</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address2</span><span class="dl">'</span> <span class="p">}]);</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="using-test-grouping-for-improved-readability">Using Test Grouping for Improved Readability</h2>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Use</span> <span class="nx">the</span> <span class="o">*</span><span class="nx">describe</span><span class="o">*</span> <span class="nx">block</span> <span class="nx">to</span> <span class="nx">logically</span> <span class="nx">group</span> <span class="nx">related</span> <span class="nx">tests</span><span class="p">:</span>

  <span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">addNumbers function</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should properly add 2 and 2</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">});</span>
    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should support negative numbers</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">});</span>
    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should not accept decimal numbers</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">});</span>
  <span class="p">});</span>
</code></pre></div></div>

<h2 id="avoiding-silently-failing-tests">Avoiding Silently Failing Tests</h2>

<h3 id="assert-outside-a-subscription">Assert Outside a Subscription</h3>

<p>It is a best practice to remove assertions outside of subscriptions. This way, we make sure that the assertion is executed before the test finishes. To assert the result of an observable, we assign the result in the subscription, but the assertion is done after, outside the subscription with the value. For example:</p>

<p>Instead of this:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nx">service</span>
      <span class="p">.</span><span class="nx">getAddresses</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">addresses</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address1</span><span class="dl">'</span> <span class="p">},</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address2</span><span class="dl">'</span> <span class="p">}]);</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>

  <span class="p">});</span>
</code></pre></div></div>

<p>Do this instead:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">let</span> <span class="nx">addresses</span><span class="p">:</span> <span class="nx">Address</span><span class="p">[];</span>
    <span class="nx">service</span>
      <span class="p">.</span><span class="nx">getAddresses</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">addresses</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address1</span><span class="dl">'</span> <span class="p">},</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address2</span><span class="dl">'</span> <span class="p">}]);</span>
  <span class="p">});</span>
</code></pre></div></div>

<h3 id="initializing-the-result-with-a-value-that-fails-the-assertion">Initializing the Result with a Value That Fails the Assertion</h3>

<p>Avoid initializing a result variable to a value that would pass with success if nothing were to happen between the declaration and the assertion. For example:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">result</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
<span class="nx">service</span>
  <span class="p">.</span><span class="nx">hasPage</span><span class="p">(</span><span class="dl">'</span><span class="s1">home</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">value</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">value</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>

<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toBeFalsy</span><span class="p">();</span>
</code></pre></div></div>

<p>In the above example, the assertion will be true even if the <code class="language-plaintext highlighter-rouge">hasPage</code> function is never called (or does nothing). Instead, initialize the result variable to a value that will fail the assertions. This way, we can be sure the action we are testing performed some processing.</p>

<p>In the example below, the value <em>true</em> will fail the assertion unless the process is called and provides the expected falsy result.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">service</span>
  <span class="p">.</span><span class="nx">hasPage</span><span class="p">(</span><span class="nx">home</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">value</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">value</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>

<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toBeFalsy</span><span class="p">();</span>
</code></pre></div></div>


<!-- <h3 class="archive__subtitle">Recent posts</h3>




 -->

  </div>
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="docsearch-container"><input type="search" id="docsearch" aria-placeholder="Enter your search term..." class="search-input" tabindex="-1" placeholder="Enter your search term..." /></div>
    <!-- <div id="results" class="results"></div> --></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<table BORDER="0"><tr><td class="tdfooter"><a href="https://www.sap.com/copyright" target="_blank">Copyright</a></td>

<td class="tdfooter"><a href="https://sap.github.io/spartacus-docs/privacy-statement/">Privacy Statement</a></td>

<td class="tdfooter"><a href="https://www.sap.com/impressum" target="_blank">Legal Disclosure</a></td>

<td class="tdfooter"><a href="https://www.sap.com/trademark" target="_blank">Trademark</a></td>

<td class="tdfooter"><a href="https://www.sap.com/terms-of-use" target="_blank">Terms of Use</a></td></tr></table>
<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/spartacus-docs/4.x/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Spartacus Documentation. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> -->

      </footer>
    </div>

    
  <script src="/spartacus-docs/4.x/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> 
    <script type="text/javascript"> docsearch({ 
    apiKey: 'b6583768751462c6ee53d5a5720cda44', 
    indexName: 'sap_spartacus', 
    inputSelector: '#docsearch', 
    algoliaOptions: {
      'facetFilters': ["tags:4.x"]
      },
    debug: false // Set debug to true if you want to inspect the dropdown 
    }); 
    </script> 

    <script>
      anchors.options = {
      visible: 'hover',
      icon: "\uf0c1"
      };
    anchors.add();
    </script>

    </body>
</html>
